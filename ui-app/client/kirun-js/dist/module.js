import{DateTime as e}from"luxon";function t(e,t,r,s){Object.defineProperty(e,t,{get:r,set:s,enumerable:!0,configurable:!0})}function r(e,t){return Object.keys(t).forEach(function(r){"default"===r||"__esModule"===r||Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[r]}})}),e}t({},"KIRunSchemaRepository",()=>C);var s,n,a,i,o,E,u={};t(u,"AdditionalType",()=>w),t(u,"Schema",()=>I),t(u,"SchemaDetails",()=>P),t({},"Namespaces",()=>A);class A{static{this.SYSTEM="System"}static{this.SYSTEM_CTX="System.Context"}static{this.SYSTEM_LOOP="System.Loop"}static{this.SYSTEM_ARRAY="System.Array"}static{this.SYSTEM_OBJECT="System.Object"}static{this.SYSTEM_JSON="System.JSON"}static{this.MATH="System.Math"}static{this.STRING="System.String"}static{this.DATE="System.Date"}constructor(){}}function l(e){return null==e}t({},"ArraySchemaType",()=>T),t({},"isNullValue",()=>l);class T{constructor(e){if(!e)return;this.singleSchema=e.singleSchema?new I(e.singleSchema):void 0,this.tupleSchema=e.tupleSchema?e.tupleSchema.map(e=>new I(e)):void 0}setSingleSchema(e){return this.singleSchema=e,this}setTupleSchema(e){return this.tupleSchema=e,this}getSingleSchema(){return this.singleSchema}getTupleSchema(){return this.tupleSchema}isSingleType(){return!l(this.singleSchema)}static of(...e){return 1==e.length?new T().setSingleSchema(e[0]):new T().setTupleSchema(e)}static from(e){if(!e)return;if(Array.isArray(e))return new T().setTupleSchema(I.fromListOfSchemas(e));let t=Object.keys(e);if(-1!=t.indexOf("singleSchema"))return new T().setSingleSchema(I.from(e.singleSchema));if(-1!=t.indexOf("tupleSchema"))return new T().setTupleSchema(I.fromListOfSchemas(e.tupleSchema));let r=I.from(e);if(r)return new T().setSingleSchema(r)}}t({},"SchemaType",()=>c);var c=((s={}).INTEGER="Integer",s.LONG="Long",s.FLOAT="Float",s.DOUBLE="Double",s.STRING="String",s.OBJECT="Object",s.ARRAY="Array",s.BOOLEAN="Boolean",s.NULL="Null",s);t({},"TypeUtil",()=>p),t({},"MultipleType",()=>g),t({},"Type",()=>h);class h{}class g extends h{constructor(e){super(),e instanceof g?this.type=new Set(Array.from(e.type)):this.type=new Set(Array.from(e))}getType(){return this.type}setType(e){return this.type=e,this}getAllowedSchemaTypes(){return this.type}contains(e){return this.type?.has(e)}}t({},"SingleType",()=>R);class R extends h{constructor(e){super(),e instanceof R?this.type=e.type:this.type=e}getType(){return this.type}getAllowedSchemaTypes(){return new Set([this.type])}contains(e){return this.type==e}}class p{static of(...e){return 1==e.length?new R(e[0]):new g(new Set(e))}static from(e){return"string"==typeof e?new R(c[p.fromJSONType(e)]):Array.isArray(e)?new g(new Set(e.map(p.fromJSONType).map(e=>e).map(e=>c[e]))):void 0}static fromJSONType(e){let t=e.toUpperCase();return"NUMBER"===t?"DOUBLE":t}}let m="additionalProperty",f="additionalItems",N="enums",_="items",M="System.Schema",S="required",O="version",d="namespace";class w{constructor(e){if(!e||(this.booleanValue=e.booleanValue,!e.schemaValue))return;this.schemaValue=new I(e.schemaValue)}getBooleanValue(){return this.booleanValue}getSchemaValue(){return this.schemaValue}setBooleanValue(e){return this.booleanValue=e,this}setSchemaValue(e){return this.schemaValue=e,this}static from(e){if(l(e))return;let t=new w;if("boolean"==typeof e)t.booleanValue=e;else{let r=Object.keys(e);-1!=r.indexOf("booleanValue")?t.booleanValue=e.booleanValue:-1!=r.indexOf("schemaValue")?t.schemaValue=I.from(e.schemaValue):t.schemaValue=I.from(e)}return t}}class P{constructor(e){if(!e)return;this.preferredComponent=e.preferredComponent,e.validationMessages&&(this.validationMessages=new Map(Array.from(e.validationMessages.entries()))),e.properties&&(this.properties=new Map(Array.from(e.properties.entries()))),e.styleProperties&&(this.styleProperties=new Map(Array.from(e.styleProperties.entries()))),this.order=e.order,this.label=e.label}getPreferredComponent(){return this.preferredComponent}setPreferredComponent(e){return this.preferredComponent=e,this}getValidationMessages(){return this.validationMessages}setValidationMessages(e){return this.validationMessages=e,this}getValidationMessage(e){return this.validationMessages?.get(e)}setProperties(e){return this.properties=e,this}getProperties(){return this.properties}setStyleProperties(e){return this.styleProperties=e,this}getStyleProperties(){return this.styleProperties}getOrder(){return this.order}setOrder(e){return this.order=e,this}getLabel(){return this.label}setLabel(e){return this.label=e,this}static from(e){if(e)return new P().setPreferredComponent(e.preferredComponent).setValidationMessages(e.validationMessages?new Map(Object.entries(e.validationMessages)):void 0).setProperties(e.properties?new Map(Object.entries(e.properties)):void 0).setStyleProperties(e.styleProperties?new Map(Object.entries(e.styleProperties)):void 0).setOrder(e.order).setLabel(e.label)}}class I{static{this.NULL=new I().setNamespace(A.SYSTEM).setName("Null").setType(p.of(c.NULL)).setConstant(void 0)}static{this.TYPE_SCHEMA=new I().setType(p.of(c.STRING)).setEnums(["INTEGER","LONG","FLOAT","DOUBLE","STRING","OBJECT","ARRAY","BOOLEAN","NULL"])}static{this.SCHEMA=new I().setNamespace(A.SYSTEM).setName("Schema").setType(p.of(c.OBJECT)).setProperties(new Map([[d,I.of(d,c.STRING).setDefaultValue("_")],["name",I.ofString("name")],[O,I.of(O,c.INTEGER).setDefaultValue(1)],["ref",I.ofString("ref")],["type",new I().setAnyOf([I.TYPE_SCHEMA,I.ofArray("type",I.TYPE_SCHEMA)])],["anyOf",I.ofArray("anyOf",I.ofRef(M))],["allOf",I.ofArray("allOf",I.ofRef(M))],["oneOf",I.ofArray("oneOf",I.ofRef(M))],["not",I.ofRef(M)],["title",I.ofString("title")],["description",I.ofString("description")],["id",I.ofString("id")],["examples",I.ofAny("examples")],["defaultValue",I.ofAny("defaultValue")],["comment",I.ofString("comment")],[N,I.ofArray(N,I.ofString(N))],["constant",I.ofAny("constant")],["pattern",I.ofString("pattern")],["format",I.of("format",c.STRING).setEnums(["DATETIME","TIME","DATE","EMAIL","REGEX"])],["minLength",I.ofInteger("minLength")],["maxLength",I.ofInteger("maxLength")],["multipleOf",I.ofLong("multipleOf")],["minimum",I.ofNumber("minimum")],["maximum",I.ofNumber("maximum")],["exclusiveMinimum",I.ofNumber("exclusiveMinimum")],["exclusiveMaximum",I.ofNumber("exclusiveMaximum")],["properties",I.of("properties",c.OBJECT).setAdditionalProperties(new w().setSchemaValue(I.ofRef(M)))],["additionalProperties",new I().setName(m).setNamespace(A.SYSTEM).setAnyOf([I.ofBoolean(m),I.ofObject(m).setRef(M)]).setDefaultValue(!0)],[S,I.ofArray(S,I.ofString(S)).setDefaultValue([])],["propertyNames",I.ofRef(M)],["minProperties",I.ofInteger("minProperties")],["maxProperties",I.ofInteger("maxProperties")],["patternProperties",I.of("patternProperties",c.OBJECT).setAdditionalProperties(new w().setSchemaValue(I.ofRef(M)))],[_,new I().setName(_).setAnyOf([I.ofRef(M).setName("item"),I.ofArray("tuple",I.ofRef(M))])],["contains",I.ofRef(M)],["minContains",I.ofInteger("minContains")],["maxContains",I.ofInteger("maxContains")],["minItems",I.ofInteger("minItems")],["maxItems",I.ofInteger("maxItems")],["uniqueItems",I.ofBoolean("uniqueItems")],["additionalItems",new I().setName(f).setNamespace(A.SYSTEM).setAnyOf([I.ofBoolean(f),I.ofObject(f).setRef(M)])],["$defs",I.of("$defs",c.OBJECT).setAdditionalProperties(new w().setSchemaValue(I.ofRef(M)))],["permission",I.ofString("permission")],["details",I.ofObject("details")],["viewDetails",I.ofObject("viewDetails")]])).setRequired([])}static ofString(e){return new I().setType(p.of(c.STRING)).setName(e)}static ofInteger(e){return new I().setType(p.of(c.INTEGER)).setName(e)}static ofFloat(e){return new I().setType(p.of(c.FLOAT)).setName(e)}static ofLong(e){return new I().setType(p.of(c.LONG)).setName(e)}static ofDouble(e){return new I().setType(p.of(c.DOUBLE)).setName(e)}static ofAny(e){return new I().setType(p.of(c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE,c.STRING,c.BOOLEAN,c.ARRAY,c.NULL,c.OBJECT)).setName(e)}static ofAnyNotNull(e){return new I().setType(p.of(c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE,c.STRING,c.BOOLEAN,c.ARRAY,c.OBJECT)).setName(e)}static ofNumber(e){return new I().setType(p.of(c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE)).setName(e)}static ofBoolean(e){return new I().setType(p.of(c.BOOLEAN)).setName(e)}static of(e,...t){return new I().setType(p.of(...t)).setName(e)}static ofObject(e){return new I().setType(p.of(c.OBJECT)).setName(e)}static ofRef(e){return new I().setRef(e)}static ofArray(e,...t){return new I().setType(p.of(c.ARRAY)).setName(e).setItems(T.of(...t))}static fromListOfSchemas(e){if(l(e)&&!Array.isArray(e))return;let t=[];for(let r of Array.from(e)){let e=I.from(r);e&&t.push(e)}return t}static fromMapOfSchemas(e){if(l(e))return;let t=new Map;return Object.entries(e).forEach(([e,r])=>{let s=I.from(r);s&&t.set(e,s)}),t}static from(e,t=!1){if(l(e))return;let r=new I;return r.namespace=e.namespace??"_",r.name=e.name,r.version=e.version??1,r.ref=e.ref,t?r.type=new R(c.STRING):r.type=p.from(e.type),r.anyOf=I.fromListOfSchemas(e.anyOf),r.allOf=I.fromListOfSchemas(e.allOf),r.oneOf=I.fromListOfSchemas(e.oneOf),r.not=I.from(e.not),r.description=e.description,r.examples=e.examples?[...e.examples]:void 0,r.defaultValue=e.defaultValue,r.comment=e.comment,r.enums=e.enums?[...e.enums]:void 0,r.constant=e.constant,r.pattern=e.pattern,r.format=e.format,r.minLength=e.minLength,r.maxLength=e.maxLength,r.multipleOf=e.multipleOf,r.minimum=e.minimum,r.maximum=e.maximum,r.exclusiveMinimum=e.exclusiveMinimum,r.exclusiveMaximum=e.exclusiveMaximum,r.properties=I.fromMapOfSchemas(e.properties),r.additionalProperties=w.from(e.additionalProperties),r.required=e.required,r.propertyNames=I.from(e.propertyNames,!0),r.minProperties=e.minProperties,r.maxProperties=e.maxProperties,r.patternProperties=I.fromMapOfSchemas(e.patternProperties),r.items=T.from(e.items),r.additionalItems=w.from(e.additionalItems),r.contains=I.from(e.contains),r.minContains=e.minContains,r.maxContains=e.maxContains,r.minItems=e.minItems,r.maxItems=e.maxItems,r.uniqueItems=e.uniqueItems,r.$defs=I.fromMapOfSchemas(e.$defs),r.permission=e.permission,r.details=e.details?P.from(e.details):void 0,r.viewDetails=e.viewDetails?P.from(e.viewDetails):void 0,r}constructor(e){if(this.namespace="_",this.version=1,!e)return;this.namespace=e.namespace,this.name=e.name,this.version=e.version,this.ref=e.ref,l(e.type)||(this.type=e.type instanceof R?new R(e.type):new g(e.type)),this.anyOf=e.anyOf?.map(e=>new I(e)),this.allOf=e.allOf?.map(e=>new I(e)),this.oneOf=e.oneOf?.map(e=>new I(e)),this.not=this.not?new I(this.not):void 0,this.description=e.description,this.examples=e.examples?JSON.parse(JSON.stringify(e.examples)):void 0,this.defaultValue=e.defaultValue?JSON.parse(JSON.stringify(e.defaultValue)):void 0,this.comment=e.comment,this.enums=e.enums?[...e.enums]:void 0,this.constant=e.constant?JSON.parse(JSON.stringify(e.constant)):void 0,this.pattern=e.pattern,this.format=e.format,this.minLength=e.minLength,this.maxLength=e.maxLength,this.multipleOf=e.multipleOf,this.minimum=e.minimum,this.maximum=e.maximum,this.exclusiveMinimum=e.exclusiveMinimum,this.exclusiveMaximum=e.exclusiveMaximum,this.properties=e.properties?new Map(Array.from(e.properties.entries()).map(e=>[e[0],new I(e[1])])):void 0,this.additionalProperties=e.additionalProperties?new w(e.additionalProperties):void 0,this.required=e.required?[...e.required]:void 0,this.propertyNames=e.propertyNames?new I(e.propertyNames):void 0,this.minProperties=e.minProperties,this.maxProperties=e.maxProperties,this.patternProperties=e.patternProperties?new Map(Array.from(e.patternProperties.entries()).map(e=>[e[0],new I(e[1])])):void 0,this.items=e.items?new T(e.items):void 0,this.contains=e.contains?new I(this.contains):void 0,this.minContains=e.minContains,this.maxContains=e.maxContains,this.minItems=e.minItems,this.maxItems=e.maxItems,this.uniqueItems=e.uniqueItems,this.additionalItems=e.additionalItems?new w(e.additionalItems):void 0,this.$defs=e.$defs?new Map(Array.from(e.$defs.entries()).map(e=>[e[0],new I(e[1])])):void 0,this.permission=e.permission,this.details=e.details,this.viewDetails=e.viewDetails}getTitle(){return this.namespace&&"_"!=this.namespace?this.namespace+"."+this.name:this.name}getFullName(){return this.namespace+"."+this.name}get$defs(){return this.$defs}set$defs(e){return this.$defs=e,this}getNamespace(){return this.namespace}setNamespace(e){return this.namespace=e,this}getName(){return this.name}setName(e){return this.name=e,this}getVersion(){return this.version}setVersion(e){return this.version=e,this}getRef(){return this.ref}setRef(e){return this.ref=e,this}getType(){return this.type}setType(e){return this.type=e,this}getAnyOf(){return this.anyOf}setAnyOf(e){return this.anyOf=e,this}getAllOf(){return this.allOf}setAllOf(e){return this.allOf=e,this}getOneOf(){return this.oneOf}setOneOf(e){return this.oneOf=e,this}getNot(){return this.not}setNot(e){return this.not=e,this}getDescription(){return this.description}setDescription(e){return this.description=e,this}getExamples(){return this.examples}setExamples(e){return this.examples=e,this}getDefaultValue(){return this.defaultValue}setDefaultValue(e){return this.defaultValue=e,this}getComment(){return this.comment}setComment(e){return this.comment=e,this}getEnums(){return this.enums}setEnums(e){return this.enums=e,this}getConstant(){return this.constant}setConstant(e){return this.constant=e,this}getPattern(){return this.pattern}setPattern(e){return this.pattern=e,this}getFormat(){return this.format}setFormat(e){return this.format=e,this}getMinLength(){return this.minLength}setMinLength(e){return this.minLength=e,this}getMaxLength(){return this.maxLength}setMaxLength(e){return this.maxLength=e,this}getMultipleOf(){return this.multipleOf}setMultipleOf(e){return this.multipleOf=e,this}getMinimum(){return this.minimum}setMinimum(e){return this.minimum=e,this}getMaximum(){return this.maximum}setMaximum(e){return this.maximum=e,this}getExclusiveMinimum(){return this.exclusiveMinimum}setExclusiveMinimum(e){return this.exclusiveMinimum=e,this}getExclusiveMaximum(){return this.exclusiveMaximum}setExclusiveMaximum(e){return this.exclusiveMaximum=e,this}getProperties(){return this.properties}setProperties(e){return this.properties=e,this}getAdditionalProperties(){return this.additionalProperties}setAdditionalProperties(e){return this.additionalProperties=e,this}getAdditionalItems(){return this.additionalItems}setAdditionalItems(e){return this.additionalItems=e,this}getRequired(){return this.required}setRequired(e){return this.required=e,this}getPropertyNames(){return this.propertyNames}setPropertyNames(e){return this.propertyNames=e,this.propertyNames.type=new R(c.STRING),this}getMinProperties(){return this.minProperties}setMinProperties(e){return this.minProperties=e,this}getMaxProperties(){return this.maxProperties}setMaxProperties(e){return this.maxProperties=e,this}getPatternProperties(){return this.patternProperties}setPatternProperties(e){return this.patternProperties=e,this}getItems(){return this.items}setItems(e){return this.items=e,this}getContains(){return this.contains}setContains(e){return this.contains=e,this}getMinContains(){return this.minContains}setMinContains(e){return this.minContains=e,this}getMaxContains(){return this.maxContains}setMaxContains(e){return this.maxContains=e,this}getMinItems(){return this.minItems}setMinItems(e){return this.minItems=e,this}getMaxItems(){return this.maxItems}setMaxItems(e){return this.maxItems=e,this}getUniqueItems(){return this.uniqueItems}setUniqueItems(e){return this.uniqueItems=e,this}getPermission(){return this.permission}setPermission(e){return this.permission=e,this}getDetails(){return this.details}setDetails(e){return this.details=e,this}getViewDetails(){return this.viewDetails}setViewDetails(e){return this.viewDetails=e,this}}t({},"Parameter",()=>U),t({},"SchemaReferenceException",()=>y);class y extends Error{constructor(e,t,r){super(e.trim()?e+"-"+t:t),this.schemaPath=e,this.cause=r}getSchemaPath(){return this.schemaPath}getCause(){return this.cause}}t({},"ParameterType",()=>x);var x=((n={}).CONSTANT="CONSTANT",n.EXPRESSION="EXPRESSION",n);let L="value";class U{static{this.SCHEMA_NAME="Parameter"}static{this.SCHEMA=new I().setNamespace(A.SYSTEM).setName(U.SCHEMA_NAME).setProperties(new Map([["schema",I.SCHEMA],["parameterName",I.ofString("parameterName")],["variableArgument",I.of("variableArgument",c.BOOLEAN).setDefaultValue(!1)],["type",I.ofString("type").setEnums(["EXPRESSION","CONSTANT"])]]))}static{this.EXPRESSION=new I().setNamespace(A.SYSTEM).setName("ParameterExpression").setType(p.of(c.OBJECT)).setProperties(new Map([["isExpression",I.ofBoolean("isExpression").setDefaultValue(!0)],[L,I.ofAny(L)]]))}constructor(e,t){if(this.variableArgument=!1,this.type=x.EXPRESSION,e instanceof U)this.schema=new I(e.schema),this.parameterName=e.parameterName,this.variableArgument=e.variableArgument,this.type=e.type;else{if(!t)throw Error("Unknown constructor signature");this.schema=t,this.parameterName=e}}getSchema(){return this.schema}setSchema(e){return this.schema=e,this}getParameterName(){return this.parameterName}setParameterName(e){return this.parameterName=e,this}isVariableArgument(){return this.variableArgument}setVariableArgument(e){return this.variableArgument=e,this}getType(){return this.type}setType(e){return this.type=e,this}static ofEntry(e,t,r=!1,s=x.EXPRESSION){return[e,new U(e,t).setType(s).setVariableArgument(r)]}static of(e,t,r=!1,s=x.EXPRESSION){return new U(e,t).setType(s).setVariableArgument(r)}static from(e){let t=I.from(e.schema);if(!t)throw new y("","Parameter requires Schema");return new U(e.parameterName,t).setVariableArgument(!!e.variableArgument).setType(e.type??x.EXPRESSION)}}var b={};t(b,"MapUtil",()=>v),t(b,"MapEntry",()=>V);class v{static of(e,t,r,s,n,a,i,o,E,u,A,T,c,h,g,R,p,m,f,N){let _=new Map;return l(e)||l(t)||_.set(e,t),l(r)||l(s)||_.set(r,s),l(n)||l(a)||_.set(n,a),l(i)||l(o)||_.set(i,o),l(E)||l(u)||_.set(E,u),l(A)||l(T)||_.set(A,T),l(c)||l(h)||_.set(c,h),l(g)||l(R)||_.set(g,R),l(p)||l(m)||_.set(p,m),l(f)||l(N)||_.set(f,N),_}static ofArrayEntries(...e){let t=new Map;for(let[r,s]of e)t.set(r,s);return t}static entry(e,t){return new V(e,t)}static ofEntries(...e){let t=new Map;for(let r of e)t.set(r.k,r.v);return t}static ofEntriesArray(...e){let t=new Map;for(let r=0;r<e.length;r++)t.set(e[r][0],e[r][1]);return t}constructor(){}}class V{constructor(e,t){this.k=e,this.v=t}}class C{constructor(){this.map=new Map([["any",I.ofAny("any").setNamespace(A.SYSTEM)],["boolean",I.ofBoolean("boolean").setNamespace(A.SYSTEM)],["double",I.ofDouble("double").setNamespace(A.SYSTEM)],["float",I.ofFloat("float").setNamespace(A.SYSTEM)],["integer",I.ofInteger("integer").setNamespace(A.SYSTEM)],["long",I.ofLong("long").setNamespace(A.SYSTEM)],["number",I.ofNumber("number").setNamespace(A.SYSTEM)],["string",I.ofString("string").setNamespace(A.SYSTEM)],["Timestamp",I.ofString("Timestamp").setNamespace(A.DATE)],["Timeunit",I.ofString("Timeunit").setNamespace(A.DATE).setEnums(["YEARS","QUARTERS","MONTHS","WEEKS","DAYS","HOURS","MINUTES","SECONDS","MILLISECONDS"])],["Duration",I.ofObject("Duration").setNamespace(A.DATE).setProperties(v.ofArrayEntries(["years",I.ofNumber("years")],["quarters",I.ofNumber("quarters")],["months",I.ofNumber("months")],["weeks",I.ofNumber("weeks")],["days",I.ofNumber("days")],["hours",I.ofNumber("hours")],["minutes",I.ofNumber("minutes")],["seconds",I.ofNumber("seconds")],["milliseconds",I.ofNumber("milliseconds")])).setAdditionalItems(w.from(!1))],["TimeObject",I.ofObject("TimeObject").setNamespace(A.DATE).setProperties(v.ofArrayEntries(["year",I.ofNumber("year")],["month",I.ofNumber("month")],["day",I.ofNumber("day")],["hour",I.ofNumber("hour")],["minute",I.ofNumber("minute")],["second",I.ofNumber("second")],["millisecond",I.ofNumber("millisecond")])).setAdditionalItems(w.from(!1))],[U.EXPRESSION.getName(),U.EXPRESSION],[I.NULL.getName(),I.NULL],[I.SCHEMA.getName(),I.SCHEMA]]),this.filterableNames=Array.from(this.map.values()).map(e=>e.getFullName())}async find(e,t){return A.SYSTEM!=e&&A.DATE!=e?Promise.resolve(void 0):Promise.resolve(this.map.get(t))}async filter(e){return Promise.resolve(this.filterableNames.filter(t=>-1!==t.toLowerCase().indexOf(e.toLowerCase())))}}function D(e){return[e.getSignature().getName(),e]}t({},"KIRunFunctionRepository",()=>s3),t({},"EventResult",()=>$),t({},"Event",()=>G);class G{static{this.OUTPUT="output"}static{this.ERROR="error"}static{this.ITERATION="iteration"}static{this.TRUE="true"}static{this.FALSE="false"}static{this.SCHEMA_NAME="Event"}static{this.SCHEMA=new I().setNamespace(A.SYSTEM).setName(G.SCHEMA_NAME).setType(p.of(c.OBJECT)).setProperties(new Map([["name",I.ofString("name")],["parameters",I.ofObject("parameter").setAdditionalProperties(new w().setSchemaValue(I.SCHEMA))]]))}constructor(e,t){if(e instanceof G)this.name=e.name,this.parameters=new Map(Array.from(e.parameters.entries()).map(e=>[e[0],new I(e[1])]));else{if(this.name=e,!t)throw Error("Unknown constructor format");this.parameters=t}}getName(){return this.name}setName(e){return this.name=e,this}getParameters(){return this.parameters}setParameters(e){return this.parameters=e,this}static outputEventMapEntry(e){return G.eventMapEntry(G.OUTPUT,e)}static eventMapEntry(e,t){return[e,new G(e,t)]}static from(e){return new G(e.name,new Map(Object.entries(e.parameters??{}).map(e=>{let t=I.from(e[1]);if(!t)throw new y("","Event expects a schema");return[e[0],t]})))}}class ${constructor(e,t){this.name=e,this.result=t}getName(){return this.name}setName(e){return this.name=e,this}getResult(){return this.result}setResult(e){return this.result=e,this}static outputOf(e){return $.of(G.OUTPUT,e)}static of(e,t){return new $(e,t)}}t({},"FunctionOutput",()=>B),t({},"KIRuntimeException",()=>F);class F extends Error{constructor(e,t){super(e),this.cause=t}getCause(){return this.cause}}class B{constructor(e){if(this.index=0,l(e))throw new F("Function output is generating null");Array.isArray(e)&&e.length&&e[0]instanceof $?this.fo=e:(this.fo=[],Array.isArray(e)||(this.generator=e))}next(){if(!this.generator)return this.index<this.fo.length?this.fo[this.index++]:void 0;let e=this.generator.next();return e&&this.fo.push(e),e}allResults(){return this.fo}}t({},"FunctionSignature",()=>Y);class Y{static{this.SCHEMA_NAME="FunctionSignature"}static{this.SCHEMA=new I().setNamespace(A.SYSTEM).setName(Y.SCHEMA_NAME).setProperties(new Map([["name",I.ofString("name")],["namespace",I.ofString("namespace")],["parameters",I.ofObject("parameters").setAdditionalProperties(new w().setSchemaValue(U.SCHEMA))],["events",I.ofObject("events").setAdditionalProperties(new w().setSchemaValue(G.SCHEMA))]]))}constructor(e){this.namespace="_",this.parameters=new Map,this.events=new Map,e instanceof Y?(this.name=e.name,this.namespace=e.namespace,this.parameters=new Map(Array.from(e.parameters.entries()).map(e=>[e[0],new U(e[1])])),this.events=new Map(Array.from(e.events.entries()).map(e=>[e[0],new G(e[1])]))):this.name=e}getNamespace(){return this.namespace}setNamespace(e){return this.namespace=e,this}getName(){return this.name}setName(e){return this.name=e,this}getParameters(){return this.parameters}setParameters(e){return this.parameters=e,this}getEvents(){return this.events}setEvents(e){return this.events=e,this}getFullName(){return this.namespace+"."+this.name}}t({},"AbstractFunction",()=>eN),t({},"SchemaValidator",()=>ef),t({},"deepEqual",()=>W),t({},"LinkedList",()=>H),t({},"StringFormatter",()=>k);class k{static format(e,...t){if(!t||0==t.length)return e;let r="",s=0,n="",a=n,i=e.length;for(let o=0;o<i;o++)"$"==(n=e.charAt(o))&&"\\"==a?r=r.substring(0,o-1)+n:"$"==n&&s<t.length?r+=t[s++]:r+=n,a=n;return r.toString()}constructor(){}}class H{constructor(e){if(this.head=void 0,this.tail=void 0,this.length=0,e?.length){for(let t of e)if(this.head){let e=new j(t,this.tail);this.tail.next=e,this.tail=e}else this.tail=this.head=new j(t);this.length=e.length}}push(e){let t=new j(e,void 0,this.head);this.head?(this.head.previous=t,this.head=t):this.tail=this.head=t,this.length++}pop(){if(!this.head)throw Error("List is empty and cannot pop further.");let e=this.head.value;if(this.length--,this.head==this.tail)return this.head=this.tail=void 0,e;let t=this.head;return this.head=t.next,t.next=void 0,t.previous=void 0,this.head.previous=void 0,e}isEmpty(){return!this.length}size(){return this.length}get(e){if(e<0||e>=this.length)throw Error(`${e} is out of bounds [0,${this.length}]`);let t=this.head;for(;e>0;)t=this.head.next,--e;return t.value}set(e,t){if(e<0||e>=this.length)throw new F(k.format("Index $ out of bound to set the value in linked list.",e));let r=this.head;for(;e>0;)r=this.head.next,--e;return r.value=t,this}toString(){let e=this.head,t="";for(;e;)t+=e.value,(e=e.next)&&(t+=", ");return`[${t}]`}toArray(){let e=[],t=this.head;for(;t;)e.push(t.value),t=t.next;return e}peek(){if(!this.head)throw Error("List is empty so cannot peak");return this.head.value}peekLast(){if(!this.tail)throw Error("List is empty so cannot peak");return this.tail.value}getFirst(){if(!this.head)throw Error("List is empty so cannot get first");return this.head.value}removeFirst(){return this.pop()}removeLast(){if(!this.tail)throw Error("List is empty so cannot remove");--this.length;let e=this.tail.value;if(0==this.length)this.head=this.tail=void 0;else{let e=this.tail.previous;e.next=void 0,this.tail.previous=void 0,this.tail=e}return e}addAll(e){return e&&e.length&&e.forEach(this.add.bind(this)),this}add(e){return++this.length,this.tail||this.head?this.head===this.tail?(this.tail=new j(e,this.head),this.head.next=this.tail):(this.tail=new j(e,this.tail),this.tail.previous.next=this.tail):this.head=this.tail=new j(e),this}map(e,t){let r=new H,s=this.head,n=0;for(;s;)r.add(e(s.value,n)),s=s.next,++n;return r}indexOf(e){let t=this.head,r=0;for(;t;){if(W(t.value,e))return r;t=t.next,++r}return -1}forEach(e,t){let r=this.head,s=0;for(;r;)e(r.value,s),r=r.next,++s}}class j{constructor(e,t,r){this.value=e,this.next=r,this.previous=t}toString(){return""+this.value}}function W(e,t){let r=new H;r.push(e);let s=new H;for(s.push(t);!r.isEmpty()&&!s.isEmpty();){let e=r.pop(),t=s.pop();if(e===t)continue;let n=typeof e,a=typeof t;if("undefined"===n||"undefined"===a){if(!e&&!t)continue;return!1}if(n!==a)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!=t.length)return!1;for(let n=0;n<e.length;n++)r.push(e[n]),s.push(t[n]);continue}if("object"===n){if("object"!==a||null===e||null===t)return!1;let n=Object.entries(e),i=Object.entries(t);if(n.length!==i.length)return!1;for(let[e,a]of n)r.push(a),s.push(t[e]);continue}return!1}return!0}t({},"StringUtil",()=>X);class X{constructor(){}static nthIndex(e,t,r=0,s){if(!e)throw new F("String cannot be null");if(r<0||r>=e.length)throw new F(k.format("Cannot search from index : $",r));if(s<=0||s>e.length)throw new F(k.format("Cannot search for occurance : $",s));for(;r<e.length;){if(e.charAt(r)==t&&0==--s)return r;++r}return -1}static splitAtFirstOccurance(e,t){if(!e)return[void 0,void 0];let r=e.indexOf(t);return -1==r?[e,void 0]:[e.substring(0,r),e.substring(r+1)]}static splitAtLastOccurance(e,t){if(!e)return[void 0,void 0];let r=e.lastIndexOf(t);return -1==r?[e,void 0]:[e.substring(0,r),e.substring(r+1)]}static isNullOrBlank(e){return!e||""==e.trim()}}t({},"SchemaUtil",()=>Z);var J={};t(J,"Tuple2",()=>q),t(J,"Tuple3",()=>K),t(J,"Tuple4",()=>z);class q{constructor(e,t){this.f=e,this.s=t}getT1(){return this.f}getT2(){return this.s}setT1(e){return this.f=e,this}setT2(e){return this.s=e,this}}class K extends q{constructor(e,t,r){super(e,t),this.t=r}getT3(){return this.t}setT1(e){return this.f=e,this}setT2(e){return this.s=e,this}setT3(e){return this.t=e,this}}class z extends K{constructor(e,t,r,s){super(e,t,r),this.fr=s}getT4(){return this.fr}setT1(e){return this.f=e,this}setT2(e){return this.s=e,this}setT3(e){return this.t=e,this}setT4(e){return this.fr=e,this}}t({},"SchemaValidationException",()=>Q);class Q extends Error{constructor(e,t,r=[],s){super(t+(r?r.map(e=>e.message).reduce((e,t)=>e+"\n"+t,""):"")),this.schemaPath=e,this.cause=s}getSchemaPath(){return this.schemaPath}getCause(){return this.cause}}class Z{static{this.UNABLE_TO_RETRIVE_SCHEMA_FROM_REFERENCED_PATH="Unable to retrive schema from referenced path"}static{this.CYCLIC_REFERENCE_LIMIT_COUNTER=20}static async getDefaultValue(e,t){if(e)return e.getConstant()?e.getConstant():l(e.getDefaultValue())?Z.getDefaultValue(await Z.getSchemaFromRef(e,t,e.getRef()),t):e.getDefaultValue()}static async hasDefaultValueOrNullSchemaType(e,t){return e?e.getConstant()||!l(e.getDefaultValue())?Promise.resolve(!0):l(e.getRef())?e.getType()?.getAllowedSchemaTypes().has(c.NULL)?Promise.resolve(!0):Promise.resolve(!1):this.hasDefaultValueOrNullSchemaType(await Z.getSchemaFromRef(e,t,e.getRef()),t):Promise.resolve(!1)}static async getSchemaFromRef(e,t,r,s=0){if(++s==Z.CYCLIC_REFERENCE_LIMIT_COUNTER)throw new Q(r??"","Schema has a cyclic reference");if(!e||!r||X.isNullOrBlank(r))return Promise.resolve(void 0);if(!r.startsWith("#")){var n=await Z.resolveExternalSchema(e,t,r);n&&(e=n.getT1(),r=n.getT2())}let a=r.split("/");return 1===a.length?Promise.resolve(e):Promise.resolve(Z.resolveInternalSchema(e,t,r,s,a,1))}static async resolveInternalSchema(e,t,r,s,n,a){let i=e;if(a!==n.length){for(;a<n.length;){if("$defs"===n[a]){if(++a>=n.length||!i.get$defs())throw new y(r,Z.UNABLE_TO_RETRIVE_SCHEMA_FROM_REFERENCED_PATH);i=i.get$defs()?.get(n[a])}else{if(i&&(!i.getType()?.contains(c.OBJECT)||!i.getProperties()))throw new y(r,"Cannot retrievie schema from non Object type schemas");i=i.getProperties()?.get(n[a])}if(a++,!i||!X.isNullOrBlank(i.getRef())&&!(i=await Z.getSchemaFromRef(i,t,i.getRef(),s)))throw new y(r,Z.UNABLE_TO_RETRIVE_SCHEMA_FROM_REFERENCED_PATH)}return Promise.resolve(i)}}static async resolveExternalSchema(e,t,r){if(!t)return Promise.resolve(void 0);let s=X.splitAtFirstOccurance(r??"","/");if(!s[0])return Promise.resolve(void 0);let n=X.splitAtLastOccurance(s[0],".");if(!n[0]||!n[1])return Promise.resolve(void 0);let a=await t.find(n[0],n[1]);if(!a)return Promise.resolve(void 0);if(!s[1]||""===s[1])return Promise.resolve(new q(a,r));if(r="#/"+s[1],!a)throw new y(r,Z.UNABLE_TO_RETRIVE_SCHEMA_FROM_REFERENCED_PATH);return Promise.resolve(new q(a,r))}constructor(){}}t({},"AnyOfAllOfOneOfValidator",()=>ee);class ee{static async validate(e,t,r,s,n,a){let i=[];return t.getOneOf()&&!t.getOneOf()?await ee.oneOf(e,t,r,s,i,n,a):t.getAllOf()&&!t.getAllOf()?await ee.allOf(e,t,r,s,i,n,a):t.getAnyOf()&&!t.getAnyOf()?await ee.anyOf(e,t,r,s,i,n,a):s}static async anyOf(e,t,r,s,n,a,i){let o=!1;for(let E of t.getAnyOf()??[])try{await ee.validate(e,E,r,s,a,i),o=!0;break}catch(e){o=!1,n.push(e)}if(o)return s;throw new Q(ef.path(e),"The value don't satisfy any of the schemas.",n)}static async allOf(e,t,r,s,n,a,i){let o=0;for(let E of t.getAllOf()??[])try{await ee.validate(e,E,r,s,a,i),o++}catch(e){n.push(e)}if(o===t.getAllOf()?.length)return s;throw new Q(ef.path(e),"The value doesn't satisfy some of the schemas.",n)}static async oneOf(e,t,r,s,n,a,i){let o=0;for(let E of t.getOneOf()??[])try{await ee.validate(e,E,r,s,a,i),o++}catch(e){n.push(e)}if(1===o)return s;throw new Q(ef.path(e),0==o?"The value does not satisfy any schema":"The value satisfy more than one schema",n)}constructor(){}}t({},"TypeValidator",()=>em),t({},"ArrayValidator",()=>et);class et{static async validate(e,t,r,s,n,a){if(l(s))throw new Q(ef.path(e),"Expected an array but found null");if(!Array.isArray(s))throw new Q(ef.path(e),s.toString()+" is not an Array");return et.checkMinMaxItems(e,t,s),await et.checkItems(e,t,r,s,n,a),et.checkUniqueItems(e,t,s),await et.checkContains(t,e,r,s),s}static async checkContains(e,t,r,s){if(l(e.getContains()))return;let n=await et.countContains(t,e,r,s,l(e.getMinContains())&&l(e.getMaxContains()));if(0===n)throw new Q(ef.path(t),"None of the items are of type contains schema");if(!l(e.getMinContains())&&e.getMinContains()>n)throw new Q(ef.path(t),"The minimum number of the items of type contains schema should be "+e.getMinContains()+" but found "+n);if(!l(e.getMaxContains())&&e.getMaxContains()<n)throw new Q(ef.path(t),"The maximum number of the items of type contains schema should be "+e.getMaxContains()+" but found "+n)}static async countContains(e,t,r,s,n){let a=0;for(let i=0;i<s.length;i++){let o=e?[...e]:[];try{if(await ef.validate(o,t.getContains(),r,s[i]),a++,n)break}catch(e){}}return a}static checkUniqueItems(e,t,r){if(t.getUniqueItems()&&t.getUniqueItems()&&new Set(r).size!==r.length)throw new Q(ef.path(e),"Items on the array are not unique")}static checkMinMaxItems(e,t,r){if(t.getMinItems()&&t.getMinItems()>r.length)throw new Q(ef.path(e),"Array should have minimum of "+t.getMinItems()+" elements");if(t.getMaxItems()&&t.getMaxItems()<r.length)throw new Q(ef.path(e),"Array can have  maximum of "+t.getMaxItems()+" elements")}static async checkItems(e,t,r,s,n,a){if(!t.getItems())return;let i=t.getItems();if(i.getSingleSchema())for(let t=0;t<s.length;t++){let o=e?[...e]:[];s[t]=await ef.validate(o,i.getSingleSchema(),r,s[t],n,a)}if(i.getTupleSchema()){if(i.getTupleSchema().length!==s.length&&l(t?.getAdditionalItems()))throw new Q(ef.path(e),"Expected an array with only "+i.getTupleSchema().length+" but found "+s.length);await this.checkItemsInTupleSchema(e,r,s,i),await this.checkAdditionalItems(e,t,r,s,i)}}static async checkItemsInTupleSchema(e,t,r,s,n,a){for(let i=0;i<s.getTupleSchema()?.length;i++){let o=e?[...e]:[];r[i]=await ef.validate(o,s.getTupleSchema()[i],t,r[i],n,a)}}static async checkAdditionalItems(e,t,r,s,n){if(!l(t.getAdditionalItems())){let a=t.getAdditionalItems();if(a?.getBooleanValue()){let i=I.ofAny("item");if(a?.getBooleanValue()===!1&&s.length>n.getTupleSchema()?.length)throw new Q(ef.path(e),"No Additional Items are defined");await this.checkEachItemInAdditionalItems(e,t,r,s,n,i)}else if(a?.getSchemaValue()){let i=a.getSchemaValue();await this.checkEachItemInAdditionalItems(e,t,r,s,n,i)}}}static async checkEachItemInAdditionalItems(e,t,r,s,n,a){for(let t=n.getTupleSchema()?.length;t<s.length;t++){let n=e?[...e]:[];s[t]=await ef.validate(n,a,r,s[t])}}constructor(){}}t({},"BooleanValidator",()=>er);class er{static validate(e,t,r){if(l(r))throw new Q(ef.path(e),"Expected a boolean but found null");if("boolean"!=typeof r)throw new Q(ef.path(e),r.toString()+" is not a boolean");return r}constructor(){}}t({},"NullValidator",()=>es);class es{static validate(e,t,r){if(l(r))return r;throw new Q(ef.path(e),"Expected a null but found "+r)}constructor(){}}t({},"NumberValidator",()=>en);class en{static validate(e,t,r,s){if(l(s))throw new Q(ef.path(t),"Expected a number but found null");if("number"!=typeof s)throw new Q(ef.path(t),s.toString()+" is not a "+e);let n=en.extractNumber(e,t,r,s);return en.checkRange(t,r,s,n),en.checkMultipleOf(t,r,s,n),s}static extractNumber(e,t,r,s){let n=s;try{(e==c.LONG||e==c.INTEGER)&&(n=Math.round(n))}catch(r){throw new Q(ef.path(t),s+" is not a number of type "+e,r)}if(l(n)||(e==c.LONG||e==c.INTEGER)&&n!=s)throw new Q(ef.path(t),s.toString()+" is not a number of type "+e);return n}static checkMultipleOf(e,t,r,s){if(t.getMultipleOf()&&s%t.getMultipleOf()!=0)throw new Q(ef.path(e),t.getDetails()?.getValidationMessage("multipleOf")??r.toString()+" is not multiple of "+t.getMultipleOf())}static checkRange(e,t,r,s){if(!l(t.getMinimum())&&0>en.numberCompare(s,t.getMinimum()))throw new Q(ef.path(e),t.getDetails()?.getValidationMessage("minimum")??r.toString()+" should be greater than or equal to "+t.getMinimum());if(!l(t.getMaximum())&&en.numberCompare(s,t.getMaximum())>0)throw new Q(ef.path(e),t.getDetails()?.getValidationMessage("maximum")??r.toString()+" should be less than or equal to "+t.getMaximum());if(!l(t.getExclusiveMinimum())&&0>=en.numberCompare(s,t.getExclusiveMinimum()))throw new Q(ef.path(e),t.getDetails()?.getValidationMessage("exclusiveMinimum")??r.toString()+" should be greater than "+t.getExclusiveMinimum());if(!l(t.getExclusiveMaximum())&&en.numberCompare(s,t.getExclusiveMaximum())>0)throw new Q(ef.path(e),t.getDetails()?.getValidationMessage("exclusiveMaximum")??r.toString()+" should be less than "+t.getExclusiveMaximum())}static numberCompare(e,t){return e-t}constructor(){}}t({},"ObjectValidator",()=>ea);class ea{static async validate(e,t,r,s,n,a){if(l(s))throw new Q(ef.path(e),"Expected an object but found null");if("object"!=typeof s||Array.isArray(s))throw new Q(ef.path(e),s.toString()+" is not an Object");let i=new Set(Object.keys(s));return ea.checkMinMaxProperties(e,t,i),t.getPropertyNames()&&await ea.checkPropertyNameSchema(e,t,r,i),t.getRequired()&&ea.checkRequired(e,t,s),t.getProperties()&&await ea.checkProperties(e,t,r,s,i,n,a),t.getPatternProperties()&&await ea.checkPatternProperties(e,t,r,s,i),t.getAdditionalProperties()&&await ea.checkAdditionalProperties(e,t,r,s,i),s}static async checkPropertyNameSchema(e,t,r,s){for(let n of Array.from(s.values()))try{await ef.validate(e,t.getPropertyNames(),r,n)}catch(t){throw new Q(ef.path(e),"Property name '"+n+"' does not fit the property schema")}}static checkRequired(e,t,r){for(let s of t.getRequired()??[])if(l(r[s]))throw new Q(ef.path(e),t.getProperties()?.get(s)?.getDetails()?.getValidationMessage("mandatory")??s+" is mandatory")}static async checkAdditionalProperties(e,t,r,s,n){let a=t.getAdditionalProperties();if(a.getSchemaValue())for(let t of Array.from(n.values())){let n=e?[...e]:[];s[t]=await ef.validate(n,a.getSchemaValue(),r,s[t])}else if(!1===a.getBooleanValue()&&n.size)throw new Q(ef.path(e),Array.from(n)+" is/are additional properties which are not allowed.")}static async checkPatternProperties(e,t,r,s,n){let a=new Map;for(let e of Array.from(t.getPatternProperties().keys()))a.set(e,new RegExp(e));for(let i of Array.from(n.values())){let o=e?[...e]:[];for(let e of Array.from(a.entries()))if(e[1].test(i)){s[i]=await ef.validate(o,t.getPatternProperties().get(e[0]),r,s[i]),n.delete(i);break}}}static async checkProperties(e,t,r,s,n,a,i){for(let o of Array.from(t.getProperties())){let t=s[o[0]];if(!s.hasOwnProperty(o[0])&&l(t)&&l(await Z.getDefaultValue(o[1],r)))continue;let E=e?[...e]:[];s[o[0]]=await ef.validate(E,o[1],r,t,a,i),n.delete(o[0])}}static checkMinMaxProperties(e,t,r){if(t.getMinProperties()&&r.size<t.getMinProperties())throw new Q(ef.path(e),"Object should have minimum of "+t.getMinProperties()+" properties");if(t.getMaxProperties()&&r.size>t.getMaxProperties())throw new Q(ef.path(e),"Object can have maximum of "+t.getMaxProperties()+" properties")}}t({},"StringValidator",()=>eo),t({},"StringFormat",()=>ei);var ei=((a={}).DATETIME="DATETIME",a.TIME="TIME",a.DATE="DATE",a.EMAIL="EMAIL",a.REGEX="REGEX",a);class eo{static{this.TIME=/^([01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?([+-][01][0-9]:[0-5][0-9])?$/}static{this.DATE=/^[0-9]{4,4}-([0][0-9]|[1][0-2])-(0[1-9]|[1-2][1-9]|3[01])$/}static{this.DATETIME=/^[0-9]{4,4}-([0][0-9]|[1][0-2])-(0[1-9]|[1-2][1-9]|3[01])T([01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?([+-][01][0-9]:[0-5][0-9])?$/}static{this.EMAIL=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/}static validate(e,t,r){if(l(r))throw new Q(ef.path(e),"Expected a string but found "+r);if("string"!=typeof r)throw new Q(ef.path(e),r.toString()+" is not String");t.getFormat()==ei.TIME?eo.patternMatcher(e,t,r,eo.TIME,"time pattern"):t.getFormat()==ei.DATE?eo.patternMatcher(e,t,r,eo.DATE,"date pattern"):t.getFormat()==ei.DATETIME?eo.patternMatcher(e,t,r,eo.DATETIME,"date time pattern"):t.getFormat()==ei.EMAIL?eo.patternMatcher(e,t,r,eo.EMAIL,"email pattern"):t.getPattern()&&eo.patternMatcher(e,t,r,new RegExp(t.getPattern()),"pattern "+t.getPattern());let s=r.length;if(t.getMinLength()&&s<t.getMinLength())throw new Q(ef.path(e),t.getDetails()?.getValidationMessage("minLength")??"Expected a minimum of "+t.getMinLength()+" characters");if(t.getMaxLength()&&s>t.getMaxLength())throw new Q(ef.path(e),t.getDetails()?.getValidationMessage("maxLength")??"Expected a maximum of "+t.getMaxLength()+" characters");return r}static patternMatcher(e,t,r,s,n){if(!s.test(r))throw new Q(ef.path(e),t.getDetails()?.getValidationMessage("pattern")??r.toString()+" is not matched with the "+n)}constructor(){}}var eE=((i={}).STRICT="STRICT",i.LENIENT="LENIENT",i.USE_DEFAULT="USE_DEFAULT",i.SKIP="SKIP",i);let eu=e=>eE[e.toUpperCase()],eA=()=>Object.values(eE);class el extends Error{constructor(e,t,r,s,n=[],a){super(r+(n?n.map(e=>e.message).reduce((e,t)=>e+"\n"+t,""):"")),this.schemaPath=e,this.source=t??null,this.mode=s??null,this.cause=a}getSchemaPath(){return this.schemaPath}getSource(){return this.source??null}getMode(){return this.mode??null}getCause(){return this.cause}}class eT{static handleUnConvertibleValue(e,t,r,s){return this.handleUnConvertibleValueWithDefault(e,t,r,null,s)}static handleUnConvertibleValueWithDefault(e,t,r,s,n){switch(null===t&&(t=eE.STRICT),t){case eE.STRICT:throw new el(ef.path(e),r,n,t);case eE.LENIENT:return null;case eE.USE_DEFAULT:return s;case eE.SKIP:return r;default:throw new el(ef.path(e),r,"Invalid conversion mode")}}constructor(){}}class ec{static convert(e,t,r,s){if(l(s))return eT.handleUnConvertibleValueWithDefault(e,r,s,this.getDefault(t),"Expected a string but found null");let n=s??("object"==typeof s?JSON.stringify(s):String(s));return this.getConvertedString(n,r)}static getConvertedString(e,t){return t===eE.STRICT?e.toString():e.trim()}static getDefault(e){return e.getDefaultValue()??null}constructor(){}}class eh{static convert(e,t,r,s,n){if(l(n))return eT.handleUnConvertibleValueWithDefault(e,s,n,this.getDefault(r),"Expected a number but found null");if("object"==typeof n||"boolean"==typeof n||Array.isArray(n)||"string"==typeof n&&isNaN(n=Number(n)))return eT.handleUnConvertibleValueWithDefault(e,s,n,this.getDefault(r),n+" is not a "+t);let a=this.extractNumber(t,n,s);return null===a?eT.handleUnConvertibleValueWithDefault(e,s,n,this.getDefault(r),n+" is not a "+t):a}static extractNumber(e,t,r){if("number"!=typeof t)return null;switch(e){case c.INTEGER:return this.isInteger(t,r)?Math.floor(t):null;case c.LONG:return this.isLong(t,r)?Math.floor(t):null;case c.DOUBLE:return t;case c.FLOAT:return this.isFloat(t,r)?t:null;default:return null}}static isInteger(e,t){return t!==eE.STRICT?"number"==typeof e:Number.isInteger(e)}static isLong(e,t){return t!==eE.STRICT?"number"==typeof e:Number.isInteger(e)&&e>=Number.MIN_SAFE_INTEGER&&e<=Number.MAX_SAFE_INTEGER}static isFloat(e,t){return t!==eE.STRICT?"number"==typeof e:e>=-Number.MAX_VALUE&&e<=Number.MAX_VALUE}static getDefault(e){return"number"==typeof e.getDefaultValue()?Number(e.getDefaultValue):null}}class eg{static{this.BOOLEAN_MAP={true:!0,t:!0,yes:!0,y:!0,1:!0,false:!1,f:!1,no:!1,n:!1,0:!1}}static convert(e,t,r,s){return null==s?eT.handleUnConvertibleValueWithDefault(e,r,s,this.getDefault(t),"Expected a boolean but found null"):this.getBooleanPrimitive(s)??eT.handleUnConvertibleValueWithDefault(e,r,s,this.getDefault(t),"Unable to convert to boolean")}static getBooleanPrimitive(e){return"boolean"==typeof e?e:"string"==typeof e?this.handleStringValue(e):"number"==typeof e?this.handleNumberValue(e):null}static handleStringValue(e){let t=e.toLowerCase().trim();return eg.BOOLEAN_MAP[t]??null}static handleNumberValue(e){return 0===e||1===e?1===e:null}static getDefault(e){return e.getDefaultValue()??!1}constructor(){}}class eR{static convert(e,t,r,s){return l(s)?s:"string"==typeof s&&"null"===s.toLowerCase()?null:eT.handleUnConvertibleValueWithDefault(e,r,s,null,"Unable to convert to null")}constructor(){}}class ep{static handleValidationError(e,t,r,s,n){switch(t=t??eE.STRICT){case eE.STRICT:throw new Q(ef.path(e),n);case eE.LENIENT:return null;case eE.USE_DEFAULT:return s;case eE.SKIP:return r}}constructor(){}}class em{static async validate(e,t,r,s,n,a,i){return t==c.OBJECT?await ea.validate(e,r,s,n,a,i):t==c.ARRAY?await et.validate(e,r,s,n,a,i):this.handleTypeValidationAndConversion(e,t,r,n,a,i)}static async handleTypeValidationAndConversion(e,t,r,s,n,a){let i=n?this.convertElement(e,t,r,s,a??eE.STRICT):s;return await this.validateElement(e,t,r,i,a??eE.STRICT)}static convertElement(e,t,r,s,n){if(l(t))return eT.handleUnConvertibleValueWithDefault(e,n,s,r.getDefaultValue()??null,k.format("$ is not a valid type for conversion.",t));switch(t){case c.STRING:return ec.convert(e,r,n,s);case c.INTEGER:case c.LONG:case c.DOUBLE:case c.FLOAT:return eh.convert(e,t,r,n,s);case c.BOOLEAN:return eg.convert(e,r,n,s);case c.NULL:return eR.convert(e,r,n,s);default:return eT.handleUnConvertibleValueWithDefault(e,n,s,r.getDefaultValue()??null,k.format("$ is not a valid type for conversion.",t))}}static validateElement(e,t,r,s,n){if(l(t))return ep.handleValidationError(e,n,s,r.getDefaultValue()??null,k.format("$ is not a valid type.",t));switch(t){case c.STRING:return eo.validate(e,r,s);case c.INTEGER:case c.LONG:case c.DOUBLE:case c.FLOAT:return en.validate(t,e,r,s);case c.BOOLEAN:return er.validate(e,r,s);case c.NULL:return es.validate(e,r,s);default:return ep.handleValidationError(e,n,s,r.getDefaultValue()??null,k.format("$ is not a valid type.",t))}}constructor(){}}class ef{static{this.ORDER={[c.OBJECT]:0,[c.ARRAY]:1,[c.DOUBLE]:2,[c.FLOAT]:3,[c.LONG]:4,[c.INTEGER]:5,[c.STRING]:6,[c.BOOLEAN]:7,[c.NULL]:8}}static path(e){return e?e.map(e=>e.getTitle()??"").filter(e=>!!e).reduce((e,t,r)=>e+(0===r?"":".")+t,""):""}static async validate(e,t,r,s,n,a){if(!t)throw new Q(ef.path(e),"No schema found to validate");if(e||(e=[]),e.push(t),l(s)&&!l(t.getDefaultValue()))return JSON.parse(JSON.stringify(t.getDefaultValue()));if(!l(t.getConstant()))return ef.constantValidation(e,t,s);if(t.getEnums()?.length)return ef.enumCheck(e,t,s);if(t.getFormat()&&l(t.getType()))throw new Q(this.path(e),"Type is missing in schema for declared "+t.getFormat()?.toString()+" format.");if(!0===n&&l(t.getType()))throw new Q(this.path(e),"Type is missing in schema for declared "+a);if(t.getType()&&(s=await ef.typeValidation(e,t,r,s,n,a)),!X.isNullOrBlank(t.getRef()))return await ef.validate(e,await Z.getSchemaFromRef(e[0],r,t.getRef()),r,s,n,a);if((t.getOneOf()||t.getAllOf()||t.getAnyOf())&&(s=await ee.validate(e,t,r,s,n,a)),t.getNot()){let i;try{await ef.validate(e,t.getNot(),r,s,n,a),i=!0}catch(e){i=!1}if(i)throw new Q(ef.path(e),"Schema validated value in not condition.")}return s}static constantValidation(e,t,r){if(!W(t.getConstant(),r))throw new Q(ef.path(e),"Expecting a constant value : "+r);return r}static enumCheck(e,t,r){let s=!1;for(let e of t.getEnums()??[])if(e===r){s=!0;break}if(s)return r;throw new Q(ef.path(e),"Value is not one of "+t.getEnums())}static async typeValidation(e,t,r,s,n,a){let i=Array.from(t.getType()?.getAllowedSchemaTypes()?.values()??[]).sort((e,t)=>(this.ORDER[e]??1/0)-(this.ORDER[t]??1/0)),o=[];for(let E of i)try{return await em.validate(e,E,t,r,s,n,a)}catch(e){o.push(e)}if(1==o.length)throw new Q(ef.path(e),o[0].message);throw new Q(ef.path(e),"Value "+JSON.stringify(s)+" is not of valid type(s)",o)}}class eN{async validateArguments(e,t,r){let s=new Map;for(let n of Array.from(this.getSignature().getParameters().entries())){let a=n[1];try{let r=await this.validateArgument(e,t,n,a);s.set(r.getT1(),r.getT2())}catch(t){let e=this.getSignature();throw new F(`Error while executing the function ${e.getNamespace()}.${e.getName()}'s parameter ${a.getParameterName()} with step name '${r?.getStatement().getStatementName()??"Unknown Step"}' with error : ${t?.message}`)}}return s}async validateArgument(e,t,r,s){let n,a=r[0],i=e.get(r[0]);if(l(i)&&!s.isVariableArgument())return new q(a,await ef.validate(void 0,s.getSchema(),t,void 0));if(!s?.isVariableArgument())return new q(a,await ef.validate(void 0,s.getSchema(),t,i));Array.isArray(i)?n=i:(n=[],l(i)?l(s.getSchema().getDefaultValue())||n.push(s.getSchema().getDefaultValue()):n.push(i));for(let e=0;e<n.length;e++)n[e]=await ef.validate(void 0,s.getSchema(),t,n[e]);return new q(a,n)}async execute(e){let t=await this.validateArguments(e.getArguments()??new Map,e.getSchemaRepository(),e.getStatementExecution());e.setArguments(t);try{return await this.internalExecute(e)}catch(r){let t=this.getSignature();throw new F(`Error while executing the function ${t.getNamespace()}.${t.getName()} with step name '${e.getStatementExecution()?.getStatement().getStatementName()??"Unknown Step"}' with error : ${r?.message}`)}}getProbableEventSignature(e){return this.getSignature().getEvents()}}class e_ extends eN{static{this.EVENT_INDEX_NAME="index"}static{this.EVENT_RESULT_NAME="result"}static{this.EVENT_INDEX=new G(G.OUTPUT,v.of(e_.EVENT_INDEX_NAME,I.ofInteger(e_.EVENT_INDEX_NAME)))}static{this.EVENT_RESULT_INTEGER=new G(G.OUTPUT,v.of(e_.EVENT_RESULT_NAME,I.ofInteger(e_.EVENT_RESULT_NAME)))}static{this.EVENT_RESULT_BOOLEAN=new G(G.OUTPUT,v.of(e_.EVENT_RESULT_NAME,I.ofBoolean(e_.EVENT_RESULT_NAME)))}static{this.EVENT_RESULT_ARRAY=new G(G.OUTPUT,v.of(e_.EVENT_RESULT_NAME,I.ofArray(e_.EVENT_RESULT_NAME,I.ofAny(e_.EVENT_RESULT_NAME))))}static{this.EVENT_RESULT_EMPTY=new G(G.OUTPUT,v.of())}static{this.EVENT_RESULT_ANY=new G(G.OUTPUT,v.of(this.EVENT_RESULT_NAME,I.ofAny(this.EVENT_RESULT_NAME)))}static{this.EVENT_RESULT_OBJECT=new G(G.OUTPUT,v.of(this.EVENT_RESULT_NAME,I.ofObject(this.EVENT_RESULT_NAME)))}static{this.PARAMETER_INT_LENGTH=U.of("length",I.ofInteger("length").setDefaultValue(-1))}static{this.PARAMETER_ARRAY_FIND=U.of("find",I.ofArray("eachFind",I.ofAny("eachFind")))}static{this.PARAMETER_INT_SOURCE_FROM=U.of("srcFrom",I.ofInteger("srcFrom").setDefaultValue(0).setMinimum(0))}static{this.PARAMETER_INT_SECOND_SOURCE_FROM=U.of("secondSrcFrom",I.ofInteger("secondSrcFrom").setDefaultValue(0))}static{this.PARAMETER_INT_FIND_FROM=U.of("findFrom",I.ofInteger("findFrom").setDefaultValue(0))}static{this.PARAMETER_INT_OFFSET=U.of("offset",I.ofInteger("offset").setDefaultValue(0))}static{this.PARAMETER_ROTATE_LENGTH=U.of("rotateLength",I.ofInteger("rotateLength").setDefaultValue(1).setMinimum(1))}static{this.PARAMETER_BOOLEAN_ASCENDING=U.of("ascending",I.ofBoolean("ascending").setDefaultValue(!0))}static{this.PARAMETER_KEY_PATH=U.of("keyPath",I.ofString("keyPath").setDefaultValue(""))}static{this.PARAMETER_FIND_PRIMITIVE=U.of("findPrimitive",I.of("findPrimitive",c.STRING,c.DOUBLE,c.FLOAT,c.INTEGER,c.LONG))}static{this.PARAMETER_ARRAY_SOURCE=U.of("source",I.ofArray("eachSource",I.ofAny("eachSource")))}static{this.PARAMETER_ARRAY_SECOND_SOURCE=U.of("secondSource",I.ofArray("eachSecondSource",I.ofAny("eachSecondSource")))}static{this.PARAMETER_ARRAY_SOURCE_PRIMITIVE=U.of("source",I.ofArray("eachSource",new I().setName("eachSource").setType(p.of(c.STRING,c.NULL,c.INTEGER,c.FLOAT,c.DOUBLE,c.LONG))))}static{this.PARAMETER_BOOLEAN_DEEP_COPY=U.of("deepCopy",I.ofBoolean("deepCopy").setDefaultValue(!0))}static{this.PARAMETER_ANY=U.of("element",I.ofAny("element"))}static{this.PARAMETER_ANY_ELEMENT_OBJECT=U.of("elementObject",I.ofAny("elementObject"))}static{this.PARAMETER_ANY_VAR_ARGS=U.of("element",I.ofAny("element")).setVariableArgument(!0)}static{this.PARAMETER_ARRAY_RESULT=U.of(e_.EVENT_RESULT_NAME,I.ofArray("eachResult",I.ofAny("eachResult")))}constructor(e,t,r){super();let s=new Map;for(let e of t)s.set(e.getParameterName(),e);this.signature=new Y(e).setNamespace(A.SYSTEM_ARRAY).setParameters(s).setEvents(v.of(r.getName(),r))}getSignature(){return this.signature}}class eM extends e_{constructor(){super("Concatenate",[e_.PARAMETER_ARRAY_SOURCE,e_.PARAMETER_ARRAY_SECOND_SOURCE],e_.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(e_.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(e_.PARAMETER_ARRAY_SECOND_SOURCE.getParameterName());return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,[...t,...r]]]))])}}class eS extends e_{constructor(){super("AddFirst",[e_.PARAMETER_ARRAY_SOURCE,e_.PARAMETER_ANY],e_.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(e_.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(e_.PARAMETER_ANY.getParameterName());if(0==(t=[...t]).length)return t.push(r),new B([$.outputOf(new Map([]))]);t.push(r);let s=t.length-1;for(;s>0;){let e=t[s-1];t[s-1]=t[s],t[s--]=e}return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}}let eO="keyName";class ed extends e_{constructor(){super("ArrayToArrayOfObjects",[e_.PARAMETER_ARRAY_SOURCE,U.of(eO,I.ofString(eO),!0)],e_.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(ed.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eO);if(!t?.length)return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,[]]]))]);let s=t.map(e=>{let t={};if(Array.isArray(e))if(r.length)r.forEach((r,s)=>{t[r]=e[s]});else for(let r=0;r<e.length;r++)t[`value${r+1}`]=e[r];else t[r.length?r[0]:"value"]=e;return t});return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,s]]))])}}t({},"PrimitiveUtil",()=>eP),t({},"ExecutionException",()=>ew);class ew extends Error{constructor(e,t){super(e),this.cause=t}getCause(){return this.cause}}class eP{static findPrimitiveNullAsBoolean(e){if(l(e))return new q(c.BOOLEAN,!1);let t=typeof e;if("object"===t)throw new ew(k.format("$ is not a primitive type",e));return"boolean"===t?new q(c.BOOLEAN,e):"string"===t?new q(c.STRING,e):eP.findPrimitiveNumberType(e)}static findPrimitive(e){if(l(e))return new q(c.NULL,void 0);let t=typeof e;if("object"===t)throw new ew(k.format("$ is not a primitive type",e));return"boolean"===t?new q(c.BOOLEAN,e):"string"===t?new q(c.STRING,e):eP.findPrimitiveNumberType(e)}static findPrimitiveNumberType(e){if(l(e)||Array.isArray(e)||"object"==typeof e)throw new ew(k.format("Unable to convert $ to a number.",e));try{if(Number.isInteger(e))return new q(c.LONG,e);return new q(c.DOUBLE,e)}catch(t){throw new ew(k.format("Unable to convert $ to a number.",e),t)}}static compare(e,t){if(e==t)return 0;if(l(e)||l(t))return l(e)?-1:1;if(Array.isArray(e)||Array.isArray(t)){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!=t.length)return e.length-t.length;for(let r=0;r<e.length;r++){let s=this.compare(e[r],t[r]);if(0!=s)return s}return 0}return Array.isArray(e)?-1:1}let r=typeof e,s=typeof t;return"object"===r||"object"===s?("object"===r&&"object"===s&&Object.keys(e).forEach(r=>{let s=this.compare(e[r],t[r]);if(0!=s)return s}),"object"===r?-1:1):this.comparePrimitive(e,t)}static comparePrimitive(e,t){return l(e)||l(t)?l(e)&&l(t)?0:l(e)?-1:1:e==t?0:"boolean"==typeof e||"boolean"==typeof t?e?-1:1:"string"==typeof e||"string"==typeof t?e+""<t+""?-1:1:"number"==typeof e||"number"==typeof t?e-t:0}static baseNumberType(e){return Number.isInteger(e)?c.LONG:c.DOUBLE}static toPrimitiveType(e){return e}constructor(){}}class eI extends e_{constructor(){super("BinarySearch",[eI.PARAMETER_ARRAY_SOURCE_PRIMITIVE,eI.PARAMETER_INT_SOURCE_FROM,eI.PARAMETER_FIND_PRIMITIVE,eI.PARAMETER_INT_LENGTH],eI.EVENT_INDEX)}async internalExecute(e){let t=e?.getArguments()?.get(eI.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eI.PARAMETER_INT_SOURCE_FROM.getParameterName()),s=e?.getArguments()?.get(eI.PARAMETER_FIND_PRIMITIVE.getParameterName()),n=e?.getArguments()?.get(eI.PARAMETER_INT_LENGTH.getParameterName());if(0==t.length||r<0||r>t.length)throw new F("Search source array cannot be empty");if(-1==n&&(n=t.length-r),(n=r+n)>t.length)throw new F("End point for array cannot be more than the size of the source array");let a=-1;for(;r<=n;){let e=Math.floor((r+n)/2);if(0==eP.compare(t[e],s)){a=e;break}eP.compare(t[e],s)>0?n=e-1:r=e+1}return new B([$.outputOf(new Map([[eI.EVENT_INDEX_NAME,a]]))])}}t({},"ArrayUtil",()=>ey);class ey{static removeAListFrom(e,t){if(!t||!e||!e.length||!t.length)return;let r=new Set(t);for(let t=0;t<e.length;t++)r.has(e[t])&&(e.splice(t,1),t--)}static of(...e){let t=Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r];return t}constructor(){}}class ex extends e_{constructor(){super("Compare",ey.of(ex.PARAMETER_ARRAY_SOURCE,ex.PARAMETER_INT_SOURCE_FROM,ex.PARAMETER_ARRAY_FIND,ex.PARAMETER_INT_FIND_FROM,ex.PARAMETER_INT_LENGTH),ex.EVENT_RESULT_INTEGER)}async internalExecute(e){var t=e?.getArguments()?.get(ex.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(ex.PARAMETER_INT_SOURCE_FROM.getParameterName()),s=e?.getArguments()?.get(ex.PARAMETER_ARRAY_FIND.getParameterName()),n=e?.getArguments()?.get(ex.PARAMETER_INT_FIND_FROM.getParameterName()),a=e?.getArguments()?.get(ex.PARAMETER_INT_LENGTH.getParameterName());if(0==t.length)throw new F("Compare source array cannot be empty");if(0==s.length)throw new F("Compare find array cannot be empty");if(-1==a&&(a=t.length-r),r+a>t.length)throw new F(k.format("Source array size $ is less than comparing size $",t.length,r+a));if(n+a>s.length)throw new F(k.format("Find array size $ is less than comparing size $",s.length,n+a));return new B(ey.of($.outputOf(v.of(ex.EVENT_RESULT_NAME,this.compare(t,r,r+a,s,n,n+a)))))}compare(e,t,r,s,n,a){if(r<t){let e=t;t=r,r=e}if(a<n){let e=n;n=a,a=e}if(r-t!=a-n)throw new F(k.format("Cannot compare uneven arrays from $ to $ in source array with $ to $ in find array",r,t,a,n));for(let a=t,i=n;a<r;a++,i++){let t=1;if(l(e[a])||l(s[i])){let r=l(e[a]);r==l(s[i])?t=0:r&&(t=-1)}else{let r=typeof e[a],n=typeof s[i];if("object"===r||"object"===n)t=1;else if("string"===r||"string"===n){let r=""+e[a],n=""+s[i];r===n?t=0:r<n&&(t=-1)}else"boolean"===r||"boolean"===n?t=+(r!=n):"number"===r&&"number"===n&&(t=e[a]-s[i])}if(0!=t)return t}return 0}}function eL(e){return e?"function"==typeof globalThis.structuredClone?globalThis.structuredClone(e):JSON.parse(JSON.stringify(e)):e}t({},"duplicate",()=>eL);class eU extends e_{constructor(){super("Copy",[eU.PARAMETER_ARRAY_SOURCE,eU.PARAMETER_INT_SOURCE_FROM,eU.PARAMETER_INT_LENGTH,eU.PARAMETER_BOOLEAN_DEEP_COPY],eU.EVENT_RESULT_ARRAY)}async internalExecute(e){var t=e?.getArguments()?.get(eU.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eU.PARAMETER_INT_SOURCE_FROM.getParameterName()),s=e?.getArguments()?.get(eU.PARAMETER_INT_LENGTH.getParameterName());if(-1==s&&(s=t.length-r),r+s>t.length)throw new F(k.format("Array has no elements from $ to $ as the array size is $",r,r+s,t.length));var n=e?.getArguments()?.get(eU.PARAMETER_BOOLEAN_DEEP_COPY.getParameterName());let a=Array(s);for(let e=r;e<r+s;e++)l(t[e])||(a[e-r]=n?eL(t[e]):t[e]);return new B([$.outputOf(v.of(eU.EVENT_RESULT_NAME,a))])}}class eb extends e_{constructor(){super("Delete",[e_.PARAMETER_ARRAY_SOURCE,e_.PARAMETER_ANY_VAR_ARGS],e_.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(eb.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eb.PARAMETER_ANY_VAR_ARGS.getParameterName());if(null==r)throw new F("The deletable var args are empty. So cannot be proceeded further.");if(0==t.length||0==r.length)throw new F("Expected a source or deletable for an array but not found any");let s=new Set;for(let e=t.length-1;e>=0;e--)for(let n=0;n<r.length;n++)s.has(e)||0!=eP.compare(t[e],r[n])||s.add(t[e]);return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t.filter(e=>!s.has(e))]]))])}}class ev extends e_{constructor(){super("DeleteFirst",[ev.PARAMETER_ARRAY_SOURCE],ev.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(ev.PARAMETER_ARRAY_SOURCE.getParameterName());if(0==t.length)throw new F("Given source array is empty");return(t=[...t]).shift(),new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}}class eV extends e_{constructor(){super("DeleteFrom",[eV.PARAMETER_ARRAY_SOURCE,eV.PARAMETER_INT_SOURCE_FROM,eV.PARAMETER_INT_LENGTH],eV.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(eV.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eV.PARAMETER_INT_SOURCE_FROM.getParameterName()),s=e?.getArguments()?.get(eV.PARAMETER_INT_LENGTH.getParameterName());if(0==t.length)throw new F("There are no elements to be deleted");if(r>=(t=[...t]).length||r<0)throw new F("The int source for the array should be in between 0 and length of the array ");if(-1==s&&(s=t.length-r),r+s>t.length)throw new F("Requested length to be deleted is more than the size of array ");return t.splice(r,s),new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}}class eC extends e_{constructor(){super("DeleteLast",[eC.PARAMETER_ARRAY_SOURCE],eC.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(eC.PARAMETER_ARRAY_SOURCE.getParameterName());if(0==t.length)throw new F("Given source array is empty");return(t=[...t]).pop(),new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}}class eD extends e_{constructor(){super("Disjoint",[eD.PARAMETER_ARRAY_SOURCE,eD.PARAMETER_INT_SOURCE_FROM,eD.PARAMETER_ARRAY_SECOND_SOURCE,eD.PARAMETER_INT_SECOND_SOURCE_FROM,eD.PARAMETER_INT_LENGTH],eD.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(eD.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eD.PARAMETER_INT_SOURCE_FROM.getParameterName()),s=e?.getArguments()?.get(eD.PARAMETER_ARRAY_SECOND_SOURCE.getParameterName()),n=e?.getArguments()?.get(eD.PARAMETER_INT_SECOND_SOURCE_FROM.getParameterName()),a=e?.getArguments()?.get(eD.PARAMETER_INT_LENGTH.getParameterName());if(-1==a&&(a=t.length<=s.length?t.length-r:s.length-n),a>t.length||a>s.length||r+a>t.length||n+a>s.length)throw new F("The length which was being requested is more than than the size either source array or second source array");let i=new Set,o=new Set;for(let e=0;e<a;e++)i.add(t[e+r]);for(let e=0;e<a;e++)o.add(s[e+n]);let E=new Set;return i.forEach(e=>{o.has(e)?o.delete(e):E.add(e)}),o.forEach(e=>{i.has(e)||E.add(e)}),new B([$.outputOf(new Map([[eD.EVENT_RESULT_NAME,[...E]]]))])}}class eG extends e_{constructor(){super("Equals",[eG.PARAMETER_ARRAY_SOURCE,eG.PARAMETER_INT_SOURCE_FROM,eG.PARAMETER_ARRAY_FIND,eG.PARAMETER_INT_FIND_FROM,eG.PARAMETER_INT_LENGTH],eG.EVENT_RESULT_BOOLEAN)}async internalExecute(e){let t=new ex,r=(await t.execute(e)).allResults()[0].getResult().get(eG.EVENT_RESULT_NAME);return new B([$.outputOf(v.of(eG.EVENT_RESULT_NAME,0==r))])}}class e$ extends e_{constructor(){super("Fill",[e$.PARAMETER_ARRAY_SOURCE,e$.PARAMETER_INT_SOURCE_FROM,e$.PARAMETER_INT_LENGTH,e$.PARAMETER_ANY],e$.EVENT_RESULT_ARRAY)}async internalExecute(e){var t=e?.getArguments()?.get(e$.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(e$.PARAMETER_INT_SOURCE_FROM.getParameterName()),s=e?.getArguments()?.get(e$.PARAMETER_INT_LENGTH.getParameterName()),n=e?.getArguments()?.get(e$.PARAMETER_ANY.getParameterName());if(r<0)throw new F(k.format("Arrays out of bound trying to access $ index",r));-1==s&&(s=t.length-r);let a=r+s-t.length;if(t=[...t],a>0)for(let e=0;e<a;e++)t.push();for(let e=r;e<r+s;e++)t[e]=l(n)?n:eL(n);return new B([$.outputOf(v.of(e_.EVENT_RESULT_NAME,t))])}}class eF extends e_{constructor(){super("Frequency",[eF.PARAMETER_ARRAY_SOURCE,eF.PARAMETER_ANY,eF.PARAMETER_INT_SOURCE_FROM,eF.PARAMETER_INT_LENGTH],eF.EVENT_RESULT_INTEGER)}async internalExecute(e){let t=e?.getArguments()?.get(eF.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eF.PARAMETER_ANY.getParameterName()),s=e?.getArguments()?.get(eF.PARAMETER_INT_SOURCE_FROM.getParameterName()),n=e?.getArguments()?.get(eF.PARAMETER_INT_LENGTH.getParameterName());if(0==t.length)return new B([$.outputOf(new Map([[eF.EVENT_RESULT_NAME,0]]))]);if(s>t.length)throw new F("Given start point is more than the size of source");let a=s+n;if(-1==n&&(a=t.length-s),a>t.length)throw new F("Given length is more than the size of source");let i=0;for(let e=s;e<a&&e<t.length;e++)0==eP.compare(t[e],r)&&i++;return new B([$.outputOf(new Map([[eF.EVENT_RESULT_NAME,i]]))])}}class eB extends e_{constructor(){super("IndexOf",[eB.PARAMETER_ARRAY_SOURCE,eB.PARAMETER_ANY_ELEMENT_OBJECT,eB.PARAMETER_INT_FIND_FROM],eB.EVENT_RESULT_INTEGER)}async internalExecute(e){let t=e?.getArguments()?.get(eB.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eB.PARAMETER_ANY_ELEMENT_OBJECT.getParameterName()),s=e?.getArguments()?.get(eB.PARAMETER_INT_FIND_FROM.getParameterName());if(0==t.length)return new B([$.outputOf(new Map([[eB.EVENT_RESULT_NAME,-1]]))]);if(s<0||s>t.length)throw new F("The size of the search index of the array is greater than the size of the array");let n=-1;for(let e=s;e<t.length;e++)if(0==eP.compare(t[e],r)){n=e;break}return new B([$.outputOf(new Map([[eB.EVENT_RESULT_NAME,n]]))])}}class eY extends e_{constructor(){super("IndexOfArray",[eY.PARAMETER_ARRAY_SOURCE,eY.PARAMETER_ARRAY_SECOND_SOURCE,eY.PARAMETER_INT_FIND_FROM],eY.EVENT_RESULT_INTEGER)}async internalExecute(e){let t=e?.getArguments()?.get(eY.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eY.PARAMETER_ARRAY_SECOND_SOURCE.getParameterName()),s=e?.getArguments()?.get(eY.PARAMETER_INT_FIND_FROM.getParameterName());if(0==t.length||0==r.length)return new B([$.outputOf(new Map([[eY.EVENT_RESULT_NAME,-1]]))]);if(s<0||s>t.length||t.length<r.length)throw new F("Given from second source is more than the size of the source array");let n=r.length,a=-1;for(let e=s;e<t.length;e++){let s=0;if(0==eP.compare(t[e],r[s])){for(;s<n&&0==eP.compare(t[e+s],r[s]);)s++;if(s==n){a=e;break}}}return new B([$.outputOf(new Map([[eY.EVENT_RESULT_NAME,a]]))])}}class ek extends e_{constructor(){super("LastIndexOf",[ek.PARAMETER_ARRAY_SOURCE,ek.PARAMETER_ANY_ELEMENT_OBJECT,ek.PARAMETER_INT_FIND_FROM],ek.EVENT_RESULT_INTEGER)}async internalExecute(e){let t=e?.getArguments()?.get(ek.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(ek.PARAMETER_ANY_ELEMENT_OBJECT.getParameterName()),s=e?.getArguments()?.get(ek.PARAMETER_INT_FIND_FROM.getParameterName());if(0==t.length)return new B([$.outputOf(new Map([[ek.EVENT_RESULT_NAME,-1]]))]);if(s<0||s>t.length)throw new F("The value of length shouldn't the exceed the size of the array or shouldn't be in terms");let n=-1;for(let e=t.length-1;e>=s;e--)if(0==eP.compare(t[e],r)){n=e;break}return new B([$.outputOf(new Map([[ek.EVENT_RESULT_NAME,n]]))])}}class eH extends e_{constructor(){super("LastIndexOfArray",[eH.PARAMETER_ARRAY_SOURCE,eH.PARAMETER_ARRAY_SECOND_SOURCE,eH.PARAMETER_INT_FIND_FROM],eH.EVENT_RESULT_INTEGER)}async internalExecute(e){let t=e?.getArguments()?.get(eH.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eH.PARAMETER_ARRAY_SECOND_SOURCE.getParameterName()),s=e?.getArguments()?.get(eH.PARAMETER_INT_FIND_FROM.getParameterName());if(0==t.length)return new B([$.outputOf(new Map([[eH.EVENT_RESULT_NAME,-1]]))]);if(s<0||s>t.length||r.length>t.length)throw new F("Given from index is more than the size of the source array");let n=r.length,a=-1;for(let e=s;e<t.length;e++){let s=0;if(0==eP.compare(t[e],r[s])){for(;s<n&&0==eP.compare(t[e+s],r[s]);)s++;s==n&&(a=e)}}return new B([$.outputOf(new Map([[eH.EVENT_RESULT_NAME,a]]))])}}class ej extends e_{constructor(){super("Max",[ej.PARAMETER_ARRAY_SOURCE_PRIMITIVE],ej.EVENT_RESULT_ANY)}async internalExecute(e){let t=e?.getArguments()?.get(ej.PARAMETER_ARRAY_SOURCE_PRIMITIVE.getParameterName());if(0==t.length)throw new F("Search source array cannot be empty");let r=t[0];for(let e=1;e<t.length;e++){let s=t[e];eP.comparePrimitive(r,s)>=0||(r=s)}return new B([$.outputOf(new Map([[ej.EVENT_RESULT_NAME,r]]))])}}class eW extends e_{constructor(){super("Min",[eW.PARAMETER_ARRAY_SOURCE_PRIMITIVE],eW.EVENT_RESULT_ANY)}async internalExecute(e){let t,r=e?.getArguments()?.get(eW.PARAMETER_ARRAY_SOURCE_PRIMITIVE.getParameterName());if(0==r.length)throw new F("Search source array cannot be empty");for(let e=0;e<r.length;e++)!l(r[e])&&(void 0===t||0>eP.comparePrimitive(r[e],t))&&(t=r[e]);return new B([$.outputOf(new Map([[eW.EVENT_RESULT_NAME,t]]))])}}class eX extends e_{constructor(){super("MisMatch",[eX.PARAMETER_ARRAY_SOURCE,eX.PARAMETER_INT_FIND_FROM,eX.PARAMETER_ARRAY_SECOND_SOURCE,eX.PARAMETER_INT_SECOND_SOURCE_FROM,eX.PARAMETER_INT_LENGTH],eX.EVENT_RESULT_INTEGER)}async internalExecute(e){let t=e?.getArguments()?.get(eX.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eX.PARAMETER_INT_FIND_FROM.getParameterName()),s=e?.getArguments()?.get(eX.PARAMETER_ARRAY_SECOND_SOURCE.getParameterName()),n=e?.getArguments()?.get(eX.PARAMETER_INT_SECOND_SOURCE_FROM.getParameterName()),a=e?.getArguments()?.get(eX.PARAMETER_INT_LENGTH.getParameterName()),i=r<t.length&&r>0?r:0,o=n<s.length&&n>0?n:0;if(i+a>=t.length||o+a>s.length)throw new F("The size of the array for first and second which was being requested is more than size of the given array");let E=-1;for(let e=0;e<a;e++)if(t[i+e]!=s[o+e]){E=e;break}return new B([$.outputOf(new Map([[eX.EVENT_RESULT_NAME,E]]))])}}class eJ extends e_{constructor(){super("Reverse",[eJ.PARAMETER_ARRAY_SOURCE,eJ.PARAMETER_INT_SOURCE_FROM,eJ.PARAMETER_INT_LENGTH],eJ.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(eJ.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eJ.PARAMETER_INT_SOURCE_FROM.getParameterName()),s=e?.getArguments()?.get(eJ.PARAMETER_INT_LENGTH.getParameterName());if(-1==s&&(s=t.length-r),s>=t.length||s<0||r<0)throw new F("Please provide start point between the start and end indexes or provide the length which was less than the source size ");t=[...t];let n=r+s-1;for(;r<=n;){let e=t[r],s=t[n];t[r++]=s,t[n--]=e}return new B([$.outputOf(new Map([[eJ.EVENT_RESULT_NAME,t]]))])}}class eq extends e_{constructor(){super("Rotate",[eq.PARAMETER_ARRAY_SOURCE,eq.PARAMETER_ROTATE_LENGTH],eq.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(eq.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(eq.PARAMETER_ROTATE_LENGTH.getParameterName());if(0==t.length)return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))]);let s=(t=[...t]).length;return r%=s,this.rotate(t,0,r-1),this.rotate(t,r,s-1),this.rotate(t,0,s-1),new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}rotate(e,t,r){for(;t<r;){let s=e[t];e[t++]=e[r],e[r--]=s}}}class eK extends e_{constructor(){super("Shuffle",[eK.PARAMETER_ARRAY_SOURCE],eK.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(eK.PARAMETER_ARRAY_SOURCE.getParameterName());if(t.length<=1)return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))]);let r=0,s=(t=[...t]).length;for(let e=0;e<s;e++){let e=Math.floor(Math.random()*s)%s,n=t[r];t[r]=t[e],t[e]=n,r=e}return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}}t({},"ObjectValueSetterExtractor",()=>e7),t({},"Expression",()=>e2),t({},"StringBuilder",()=>ez);class ez{constructor(e){this.str=e??""}append(e){return this.str+=e,this}toString(){return""+this.str}trim(){return this.str=this.str.trim(),this}setLength(e){return this.str=this.str.substring(0,e),this}length(){return this.str.length}charAt(e){return this.str.charAt(e)}deleteCharAt(e){return this.checkIndex(e),this.str=this.str.substring(0,e)+this.str.substring(e+1),this}insert(e,t){return this.str=this.str.substring(0,e)+t+this.str.substring(e),this}checkIndex(e){if(e>=this.str.length)throw new F(`Index ${e} is greater than or equal to ${this.str.length}`)}substring(e,t){return this.str.substring(e,t)}}t({},"ExpressionEvaluationException",()=>eQ);class eQ extends Error{constructor(e,t,r){super(k.format("$ : $",e,t)),this.cause=r}getCause(){return this.cause}}t({},"ExpressionToken",()=>eZ);class eZ{constructor(e){this.expression=e}getExpression(){return this.expression}toString(){return this.expression}}t({},"ExpressionTokenValue",()=>e0);class e0 extends eZ{constructor(e,t){super(e),this.element=t}getTokenValue(){return this.element}getElement(){return this.element}toString(){return k.format("$: $",this.expression,this.element)}}t({},"Operation",()=>e1);class e1{static{this.MULTIPLICATION=new e1("*")}static{this.DIVISION=new e1("/")}static{this.INTEGER_DIVISION=new e1("//")}static{this.MOD=new e1("%")}static{this.ADDITION=new e1("+")}static{this.SUBTRACTION=new e1("-")}static{this.NOT=new e1("not",void 0,!0)}static{this.AND=new e1("and",void 0,!0)}static{this.OR=new e1("or",void 0,!0)}static{this.LESS_THAN=new e1("<")}static{this.LESS_THAN_EQUAL=new e1("<=")}static{this.GREATER_THAN=new e1(">")}static{this.GREATER_THAN_EQUAL=new e1(">=")}static{this.EQUAL=new e1("=")}static{this.NOT_EQUAL=new e1("!=")}static{this.BITWISE_AND=new e1("&")}static{this.BITWISE_OR=new e1("|")}static{this.BITWISE_XOR=new e1("^")}static{this.BITWISE_COMPLEMENT=new e1("~")}static{this.BITWISE_LEFT_SHIFT=new e1("<<")}static{this.BITWISE_RIGHT_SHIFT=new e1(">>")}static{this.BITWISE_UNSIGNED_RIGHT_SHIFT=new e1(">>>")}static{this.UNARY_PLUS=new e1("UN: +","+")}static{this.UNARY_MINUS=new e1("UN: -","-")}static{this.UNARY_LOGICAL_NOT=new e1("UN: not","not")}static{this.UNARY_BITWISE_COMPLEMENT=new e1("UN: ~","~")}static{this.ARRAY_OPERATOR=new e1("[")}static{this.ARRAY_RANGE_INDEX_OPERATOR=new e1("..")}static{this.OBJECT_OPERATOR=new e1(".")}static{this.NULLISH_COALESCING_OPERATOR=new e1("??")}static{this.CONDITIONAL_TERNARY_OPERATOR=new e1("?")}static{this.VALUE_OF=new Map([["MULTIPLICATION",e1.MULTIPLICATION],["DIVISION",e1.DIVISION],["INTEGER_DIVISION",e1.INTEGER_DIVISION],["MOD",e1.MOD],["ADDITION",e1.ADDITION],["SUBTRACTION",e1.SUBTRACTION],["NOT",e1.NOT],["AND",e1.AND],["OR",e1.OR],["LESS_THAN",e1.LESS_THAN],["LESS_THAN_EQUAL",e1.LESS_THAN_EQUAL],["GREATER_THAN",e1.GREATER_THAN],["GREATER_THAN_EQUAL",e1.GREATER_THAN_EQUAL],["EQUAL",e1.EQUAL],["NOT_EQUAL",e1.NOT_EQUAL],["BITWISE_AND",e1.BITWISE_AND],["BITWISE_OR",e1.BITWISE_OR],["BITWISE_XOR",e1.BITWISE_XOR],["BITWISE_COMPLEMENT",e1.BITWISE_COMPLEMENT],["BITWISE_LEFT_SHIFT",e1.BITWISE_LEFT_SHIFT],["BITWISE_RIGHT_SHIFT",e1.BITWISE_RIGHT_SHIFT],["BITWISE_UNSIGNED_RIGHT_SHIFT",e1.BITWISE_UNSIGNED_RIGHT_SHIFT],["UNARY_PLUS",e1.UNARY_PLUS],["UNARY_MINUS",e1.UNARY_MINUS],["UNARY_LOGICAL_NOT",e1.UNARY_LOGICAL_NOT],["UNARY_BITWISE_COMPLEMENT",e1.UNARY_BITWISE_COMPLEMENT],["ARRAY_OPERATOR",e1.ARRAY_OPERATOR],["ARRAY_RANGE_INDEX_OPERATOR",e1.ARRAY_RANGE_INDEX_OPERATOR],["OBJECT_OPERATOR",e1.OBJECT_OPERATOR],["NULLISH_COALESCING_OPERATOR",e1.NULLISH_COALESCING_OPERATOR],["CONDITIONAL_TERNARY_OPERATOR",e1.CONDITIONAL_TERNARY_OPERATOR]])}static{this.UNARY_OPERATORS=new Set([e1.ADDITION,e1.SUBTRACTION,e1.NOT,e1.BITWISE_COMPLEMENT,e1.UNARY_PLUS,e1.UNARY_MINUS,e1.UNARY_LOGICAL_NOT,e1.UNARY_BITWISE_COMPLEMENT])}static{this.ARITHMETIC_OPERATORS=new Set([e1.MULTIPLICATION,e1.DIVISION,e1.INTEGER_DIVISION,e1.MOD,e1.ADDITION,e1.SUBTRACTION])}static{this.LOGICAL_OPERATORS=new Set([e1.NOT,e1.AND,e1.OR,e1.LESS_THAN,e1.LESS_THAN_EQUAL,e1.GREATER_THAN,e1.GREATER_THAN_EQUAL,e1.EQUAL,e1.NOT_EQUAL,e1.NULLISH_COALESCING_OPERATOR])}static{this.BITWISE_OPERATORS=new Set([e1.BITWISE_AND,e1.BITWISE_COMPLEMENT,e1.BITWISE_LEFT_SHIFT,e1.BITWISE_OR,e1.BITWISE_RIGHT_SHIFT,e1.BITWISE_UNSIGNED_RIGHT_SHIFT,e1.BITWISE_XOR])}static{this.CONDITIONAL_OPERATORS=new Set([e1.CONDITIONAL_TERNARY_OPERATOR])}static{this.OPERATOR_PRIORITY=new Map([[e1.UNARY_PLUS,1],[e1.UNARY_MINUS,1],[e1.UNARY_LOGICAL_NOT,1],[e1.UNARY_BITWISE_COMPLEMENT,1],[e1.ARRAY_OPERATOR,1],[e1.OBJECT_OPERATOR,1],[e1.ARRAY_RANGE_INDEX_OPERATOR,2],[e1.MULTIPLICATION,2],[e1.DIVISION,2],[e1.INTEGER_DIVISION,2],[e1.MOD,2],[e1.ADDITION,3],[e1.SUBTRACTION,3],[e1.BITWISE_LEFT_SHIFT,4],[e1.BITWISE_RIGHT_SHIFT,4],[e1.BITWISE_UNSIGNED_RIGHT_SHIFT,4],[e1.LESS_THAN,5],[e1.LESS_THAN_EQUAL,5],[e1.GREATER_THAN,5],[e1.GREATER_THAN_EQUAL,5],[e1.EQUAL,6],[e1.NOT_EQUAL,6],[e1.BITWISE_AND,7],[e1.BITWISE_XOR,8],[e1.BITWISE_OR,9],[e1.AND,10],[e1.OR,11],[e1.NULLISH_COALESCING_OPERATOR,11],[e1.CONDITIONAL_TERNARY_OPERATOR,12]])}static{this.OPERATORS=new Set([...Array.from(e1.ARITHMETIC_OPERATORS),...Array.from(e1.LOGICAL_OPERATORS),...Array.from(e1.BITWISE_OPERATORS),e1.ARRAY_OPERATOR,e1.ARRAY_RANGE_INDEX_OPERATOR,e1.OBJECT_OPERATOR,...Array.from(e1.CONDITIONAL_OPERATORS)].map(e=>e.getOperator()))}static{this.OPERATORS_WITHOUT_SPACE_WRAP=new Set([...Array.from(e1.ARITHMETIC_OPERATORS),...Array.from(e1.LOGICAL_OPERATORS),...Array.from(e1.BITWISE_OPERATORS),e1.ARRAY_OPERATOR,e1.ARRAY_RANGE_INDEX_OPERATOR,e1.OBJECT_OPERATOR,...Array.from(e1.CONDITIONAL_OPERATORS)].filter(e=>!e.shouldBeWrappedInSpace()).map(e=>e.getOperator()))}static{this.OPERATION_VALUE_OF=new Map(Array.from(e1.VALUE_OF.entries()).map(([e,t])=>[t.getOperator(),t]))}static{this.UNARY_MAP=new Map([[e1.ADDITION,e1.UNARY_PLUS],[e1.SUBTRACTION,e1.UNARY_MINUS],[e1.NOT,e1.UNARY_LOGICAL_NOT],[e1.BITWISE_COMPLEMENT,e1.UNARY_BITWISE_COMPLEMENT],[e1.UNARY_PLUS,e1.UNARY_PLUS],[e1.UNARY_MINUS,e1.UNARY_MINUS],[e1.UNARY_LOGICAL_NOT,e1.UNARY_LOGICAL_NOT],[e1.UNARY_BITWISE_COMPLEMENT,e1.UNARY_BITWISE_COMPLEMENT]])}static{this.BIGGEST_OPERATOR_SIZE=Array.from(e1.VALUE_OF.values()).map(e=>e.getOperator()).filter(e=>!e.startsWith("UN: ")).map(e=>e.length).reduce((e,t)=>e>t?e:t,0)}constructor(e,t,r=!1){this.operator=e,this.operatorName=t??e,this._shouldBeWrappedInSpace=r}getOperator(){return this.operator}getOperatorName(){return this.operatorName}shouldBeWrappedInSpace(){return this._shouldBeWrappedInSpace}valueOf(e){return e1.VALUE_OF.get(e)}toString(){return this.operator}}class e2 extends eZ{constructor(e,t,r,s){super(e||""),this.tokens=new H,this.ops=new H,s?.getOperator()==".."&&(t?r||(r=new e0("","")):t=new e0("","")),t&&this.tokens.push(t),r&&this.tokens.push(r),s&&this.ops.push(s),this.evaluate(),this.ops.isEmpty()||".."!=this.ops.peekLast().getOperator()||1!=this.tokens.length||this.tokens.push(new eZ(""))}getTokens(){return this.tokens}getOperations(){return this.ops}getTokensArray(){return this.cachedTokensArray||(this.cachedTokensArray=this.tokens.toArray()),this.cachedTokensArray}getOperationsArray(){return this.cachedOpsArray||(this.cachedOpsArray=this.ops.toArray()),this.cachedOpsArray}evaluate(){let e,t=this.expression.length,r="",s=new ez(""),n=0,a=!1;for(;n<t;){switch(r=this.expression[n],e=s.toString(),r){case" ":a=this.processTokenSepearator(s,e,a);break;case"(":n=this.processSubExpression(t,s,e,n,a),a=!1;break;case")":throw new eQ(this.expression,"Extra closing parenthesis found");case"]":throw new eQ(this.expression,"Extra closing square bracket found");case"'":case'"':{let e=this.processStringLiteral(t,r,n);n=e.getT1(),a=e.getT2();break}case"?":if(n+1<t&&"?"!=this.expression.charAt(n+1)&&0!=n&&"?"!=this.expression.charAt(n-1))n=this.processTernaryOperator(t,s,e,n,a);else{let i=this.processOthers(r,t,s,e,n,a);n=i.getT1(),(a=i.getT2())&&this.ops.peek()==e1.ARRAY_OPERATOR&&(n=(i=this.process(t,s,n)).getT1(),a=i.getT2())}break;default:let i=this.processOthers(r,t,s,e,n,a);n=i.getT1(),(a=i.getT2())&&this.ops.peek()==e1.ARRAY_OPERATOR&&(n=(i=this.process(t,s,n)).getT1(),a=i.getT2())}++n}if(e=s.toString(),!X.isNullOrBlank(e))if(e1.OPERATORS.has(e))throw new eQ(this.expression,"Expression is ending with an operator");else this.tokens.push(new eZ(e))}processStringLiteral(e,t,r){let s="",n=r+1;for(;n<e;n++){let e=this.expression.charAt(n);if(e==t&&"\\"!=this.expression.charAt(n-1))break;s+=e}if(n==e&&this.expression.charAt(n-1)!=t)throw new eQ(this.expression,"Missing string ending marker "+t);let a=new q(n,!1);return this.tokens.push(new e0(s,s)),a}process(e,t,r){let s=1;for(++r;r<e&&0!=s;){let e=this.expression.charAt(r);"]"==e?--s:"["==e&&++s,0!=s&&(t.append(e),r++)}return this.tokens.push(new e2(t.toString())),t.setLength(0),new q(r,!1)}processOthers(e,t,r,s,n,a){let i=t-n;i=i<e1.BIGGEST_OPERATOR_SIZE?i:e1.BIGGEST_OPERATOR_SIZE;for(let e=i;e>0;e--){let t=this.expression.substring(n,n+e);if(e1.OPERATORS_WITHOUT_SPACE_WRAP.has(t))return X.isNullOrBlank(s)?".."==t&&this.tokens.isEmpty()&&(this.tokens.push(new eZ("0")),a=!1):(this.tokens.push(new eZ(s)),a=!1),this.checkUnaryOperator(this.tokens,this.ops,e1.OPERATION_VALUE_OF.get(t),a),a=!0,r.setLength(0),new q(n+e-1,a)}return r.append(e),new q(n,!1)}processTernaryOperator(e,t,r,s,n){if(n)throw new eQ(this.expression,"Ternary operator is followed by an operator");""!=r.trim()&&(this.tokens.push(new e2(r)),t.setLength(0));let a=1,i="",o=++s;for(;s<e&&a>0;)"?"==(i=this.expression.charAt(s))?++a:":"==i&&--a,++s;if(":"!=i)throw new eQ(this.expression,"':' operater is missing");if(s>=e)throw new eQ(this.expression,"Third part of the ternary expression is missing");for(;!this.ops.isEmpty()&&this.hasPrecedence(e1.CONDITIONAL_TERNARY_OPERATOR,this.ops.peek());){let e=this.ops.pop();if(e1.UNARY_OPERATORS.has(e)){let t=this.tokens.pop();this.tokens.push(new e2("",t,void 0,e))}else{let t=this.tokens.pop(),r=this.tokens.pop();this.tokens.push(new e2("",r,t,e))}}this.ops.push(e1.CONDITIONAL_TERNARY_OPERATOR),this.tokens.push(new e2(this.expression.substring(o,s-1)));let E=this.expression.substring(s);if(""===E.trim())throw new eQ(this.expression,"Third part of the ternary expression is missing");return this.tokens.push(new e2(E)),e-1}processSubExpression(e,t,r,s,n){if(e1.OPERATORS.has(r))this.checkUnaryOperator(this.tokens,this.ops,e1.OPERATION_VALUE_OF.get(r),n),t.setLength(0);else if(!X.isNullOrBlank(r))throw new eQ(this.expression,k.format("Unkown token : $ found.",r));let a=1,i=new ez,o=this.expression.charAt(s);for(s++;s<e&&a>0;)"("==(o=this.expression.charAt(s))?a++:")"==o&&a--,0!=a&&(i.append(o),s++);if(")"!=o)throw new eQ(this.expression,"Missing a closed parenthesis");for(;i.length()>2&&this.hasMatchingOuterParentheses(i.toString());)i.deleteCharAt(0),i.setLength(i.length()-1);return this.tokens.push(new e2(i.toString().trim())),s}processTokenSepearator(e,t,r){return X.isNullOrBlank(t)||(e1.OPERATORS.has(t)?(this.checkUnaryOperator(this.tokens,this.ops,e1.OPERATION_VALUE_OF.get(t),r),r=!0):(this.tokens.push(new eZ(t)),r=!1)),e.setLength(0),r}checkUnaryOperator(e,t,r,s){if(r)if(s||e.isEmpty())if(e1.UNARY_OPERATORS.has(r)){let e=e1.UNARY_MAP.get(r);e&&t.push(e)}else throw new eQ(this.expression,k.format("Extra operator $ found.",r));else{for(;!t.isEmpty()&&this.hasPrecedence(r,t.peek());){let r=t.pop();if(e1.UNARY_OPERATORS.has(r)){let t=e.pop();e.push(new e2("",t,void 0,r))}else{let t=e.pop(),s=e.pop();e.push(new e2("",s,t,r))}}t.push(r)}}hasPrecedence(e,t){let r=e1.OPERATOR_PRIORITY.get(e),s=e1.OPERATOR_PRIORITY.get(t);if(!r||!s)throw Error("Unknown operators provided");return s<r}hasMatchingOuterParentheses(e){if(e.length<2||"("!==e.charAt(0)||")"!==e.charAt(e.length-1))return!1;let t=0;for(let r=0;r<e.length-1;r++){let s=e.charAt(r);if("("===s?t++:")"===s&&t--,0===t)return!1}return 1===t}toString(){if(this.ops.isEmpty())return 1==this.tokens.size()?this.tokens.get(0).toString():"Error: No tokens";let e=new ez,t=0,r=this.ops.toArray(),s=this.tokens.toArray();for(let n=0;n<r.length;n++)if(r[n].getOperator().startsWith("UN: "))e.append("(").append(r[n].getOperator().substring(4)).append(s[t]instanceof e2?s[t].toString():s[t]).append(")"),t++;else if(r[n]==e1.CONDITIONAL_TERNARY_OPERATOR){let r=s[t++];e.insert(0,(r instanceof e2,r.toString())),e.insert(0,":"),r=s[t++],e.insert(0,(r instanceof e2,r.toString())),e.insert(0,"?"),r=s[t++],e.insert(0,(r instanceof e2,r.toString())).append(")"),e.insert(0,"(")}else{if(0==t){let r=s[t++];e.insert(0,(r instanceof e2,r.toString()))}let a=s[t++];e.insert(0,r[n].getOperator()).insert(0,a instanceof e2?a.toString():a?.toString()).insert(0,"(").append(")")}return e.toString()}equals(e){return this.expression==e.expression}}t({},"TokenValueExtractor",()=>e5);class e5{static{this.REGEX_SQUARE_BRACKETS=/[\[\]]/}static{this.REGEX_DOT=/(?<!\.)\.(?!\.)/}static{this.pathCache=new Map}static{this.bracketCache=new Map}static splitPath(e){let t=e5.pathCache.get(e);return t||(t=e.split(e5.REGEX_DOT),e5.pathCache.set(e,t)),t}static parseBracketSegment(e){let t=e5.bracketCache.get(e);return t||(t=e.split(e5.REGEX_SQUARE_BRACKETS).map(e=>e.trim()).filter(e=>!X.isNullOrBlank(e)),e5.bracketCache.set(e,t)),t}getValue(e){let t=this.getPrefix();if(!e.startsWith(t))throw new F(k.format("Token $ doesn't start with $",e,t));if(e.endsWith(".__index")){let t=e.substring(0,e.length-8),r=this.getValueInternal(t);if(!l(r?.__index))return r.__index;if(!t.endsWith("]"))return t.substring(t.lastIndexOf(".")+1);{let e=t.substring(t.lastIndexOf("[")+1,t.length-1),r=Number.parseInt(e);return isNaN(r)?e:r}}return this.getValueInternal(e)}retrieveElementFrom(e,t,r,s){let n=s;for(let s=r;s<t.length;s++){if(l(n))return;for(let r of e5.parseBracketSegment(t[s]))if(void 0===(n=this.resolveSegmentFast(e,t,s,r,n)))return}return n}resolveSegmentFast(e,t,r,s,n){if(null!=n){if("object"==typeof n&&!Array.isArray(n))return s in n?n[s]:"length"===s?Object.keys(n).length:n[s];if(Array.isArray(n)){if("length"===s)return n.length;if(/^-?\d+$/.test(s)){let e=Number.parseInt(s,10),t=e<0?n.length+e:e;return t>=0&&t<n.length?n[t]:void 0}}if("string"==typeof n){if("length"===s)return n.length;if(/^-?\d+$/.test(s)){let e=Number.parseInt(s,10),t=e<0?n.length+e:e;return t>=0&&t<n.length?n[t]:void 0}}return this.resolveForEachPartOfTokenWithBrackets(e,t,r,s,n)}}resolveForEachPartOfTokenWithBrackets(e,t,r,s,n){if(!l(n))return"length"===s?this.getLength(e,n):"string"==typeof n||Array.isArray(n)?this.handleArrayAccess(e,s,n):this.handleObjectAccess(e,t,r,s,n)}getLength(e,t){let r=typeof t;if("string"===r||Array.isArray(t))return t.length;if("object"===r)if("length"in t)return t.length;else return Object.keys(t).length;throw new eQ(e,k.format("Length can't be found in token $",e))}handleArrayAccess(e,t,r){let s=t.indexOf("..");if(s>=0){let e=t.substring(0,s),n=t.substring(s+2),a=0==e.length?0:parseInt(e),i=0==n.length?r.length:parseInt(n);if(isNaN(a)||isNaN(i))return;for(;a<0;)a+=r.length;for(;i<0;)i+=r.length;let o=typeof r;return a>=i?"string"==o?"":[]:"string"==o?r.substring(a,i):r.slice(a,i)}let n=parseInt(t);if(isNaN(n))throw new eQ(e,k.format("$ is not a number",t));for(;n<0;)n=r.length+n;if(!(n>=r.length))return r[n]}handleObjectAccess(e,t,r,s,n){if(s.startsWith('"')){if(!s.endsWith('"')||1==s.length||2==s.length)throw new eQ(e,k.format("$ is missing a double quote or empty key found",e));s=s.substring(1,t.length-2)}return this.checkIfObject(e,t,r,n),n[s]}checkIfObject(e,t,r,s){let n=typeof s;if("object"!=n&&"string"!=n||Array.isArray(s))throw new eQ(e,k.format("Unable to retrieve $ from $ in the path $",t[r],s.toString(),e))}}class e7 extends e5{constructor(e,t){super(),this.store=e,this.prefix=t}getValueInternal(e){let t=e.split(e5.REGEX_DOT);return this.retrieveElementFrom(e,t,1,this.store)}getStore(){return this.store}setStore(e){return this.store=e,this}setValue(e,t,r=!0,s=!1){this.store=eL(this.store),this.modifyStore(e,t,r,s)}modifyStore(e,t,r,s){let n=new e2(e),a=n.getTokens();a.removeLast();let i=n.getOperations(),o=i.removeLast(),E=a.removeLast(),u=E instanceof e0?E.getElement():E.getExpression(),A=this.store;for(;!i.isEmpty();)A=o==e1.OBJECT_OPERATOR?this.getDataFromObject(A,u,i.peekLast()):this.getDataFromArray(A,u,i.peekLast()),o=i.removeLast(),u=(E=a.removeLast())instanceof e0?E.getElement():E.getExpression();o==e1.OBJECT_OPERATOR?this.putDataInObject(A,u,t,r,s):this.putDataInArray(A,u,t,r,s)}getDataFromArray(e,t,r){if(!Array.isArray(e))throw new F(k.format("Expected an array but found $",e));let s=parseInt(t);if(isNaN(s))throw new F(k.format("Expected an array index but found $",t));if(s<0)throw new F(k.format("Array index is out of bound - $",t));let n=e[s];return l(n)&&(n=r==e1.OBJECT_OPERATOR?{}:[],e[s]=n),n}getDataFromObject(e,t,r){if(Array.isArray(e)||"object"!=typeof e)throw new F(k.format("Expected an object but found $",e));let s=e[t];return l(s)&&(s=r==e1.OBJECT_OPERATOR?{}:[],e[t]=s),s}putDataInArray(e,t,r,s,n){if(!Array.isArray(e))throw new F(k.format("Expected an array but found $",e));let a=parseInt(t);if(isNaN(a))throw new F(k.format("Expected an array index but found $",t));if(a<0)throw new F(k.format("Array index is out of bound - $",t));(s||l(e[a]))&&(n&&l(r)?e.splice(a,1):e[a]=r)}putDataInObject(e,t,r,s,n){if(Array.isArray(e)||"object"!=typeof e)throw new F(k.format("Expected an object but found $",e));(s||l(e[t]))&&(n&&l(r)?delete e[t]:e[t]=r)}getPrefix(){return this.prefix}}class e4 extends e_{constructor(){super("Sort",[e4.PARAMETER_ARRAY_SOURCE,e4.PARAMETER_INT_FIND_FROM,e4.PARAMETER_INT_LENGTH,e4.PARAMETER_BOOLEAN_ASCENDING,e4.PARAMETER_KEY_PATH],e4.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(e4.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(e4.PARAMETER_INT_FIND_FROM.getParameterName()),s=e?.getArguments()?.get(e4.PARAMETER_INT_LENGTH.getParameterName()),n=e?.getArguments()?.get(e4.PARAMETER_BOOLEAN_ASCENDING.getParameterName()),a=e?.getArguments()?.get(e4.PARAMETER_KEY_PATH.getParameterName());if(0==t.length)return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))]);if(t=[...t],-1==s&&(s=t.length-r),r<0||r>=t.length||r+s>t.length)throw new F("Given start point is more than the size of the array or not available at that point");let i=t.slice(r,r+s+1),o=new e7({},"Data.");return i.sort((e,t)=>"object"==typeof e&&"object"==typeof t&&a.length?(o.setStore({a:e,b:t}),e9(o.getValue("Data.a."+a),o.getValue("Data.b."+a),n)):e9(e,t,n)),t.splice(r,s,...i),new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}}function e9(e,t,r){return e===t?0:null===e?1:null===t?-1:r?e<t?-1:1:e<t?1:-1}class e6 extends e_{constructor(){super("SubArray",[e6.PARAMETER_ARRAY_SOURCE,e6.PARAMETER_INT_FIND_FROM,e6.PARAMETER_INT_LENGTH],e6.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(e6.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(e6.PARAMETER_INT_FIND_FROM.getParameterName()),s=e?.getArguments()?.get(e6.PARAMETER_INT_LENGTH.getParameterName());if(-1==s&&(s=t.length-r),s<=0)return new B([$.outputOf(new Map([]))]);if(!(r>=0&&r<t.length)||r+s>t.length)throw new F("Given find from point is more than the source size array or the Requested length for the subarray was more than the source size");let n=t.slice(r,r+s);return new B([$.outputOf(new Map([[e6.EVENT_RESULT_NAME,n]]))])}}class e3 extends e_{constructor(){super("Insert",[e3.PARAMETER_ARRAY_SOURCE,e3.PARAMETER_INT_OFFSET,e3.PARAMETER_ANY],e3.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(e3.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(e3.PARAMETER_INT_OFFSET.getParameterName());var s=e?.getArguments()?.get(e3.PARAMETER_ANY.getParameterName());if(l(s)||l(r)||r>t.length)throw new F("Please valid resouces to insert at the correct location");if(0==(t=[...t]).length)return 0==r&&t.push(s),new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))]);t.push(s);let n=t.length-1;for(r++;n>=r;){let e=t[n-1];t[n-1]=t[n],t[n--]=e}return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}}class e8 extends e_{constructor(){super("InsertLast",[e8.PARAMETER_ARRAY_SOURCE,e8.PARAMETER_ANY],e8.EVENT_RESULT_ARRAY)}async internalExecute(e){let t=e?.getArguments()?.get(e8.PARAMETER_ARRAY_SOURCE.getParameterName());var r=e?.getArguments()?.get(e8.PARAMETER_ANY.getParameterName());return(t=[...t]).push(r),new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,t]]))])}}class te extends e_{constructor(){super("RemoveDuplicates",[te.PARAMETER_ARRAY_SOURCE,te.PARAMETER_INT_SOURCE_FROM,te.PARAMETER_INT_LENGTH],te.EVENT_RESULT_ARRAY)}async internalExecute(e){var t=e?.getArguments()?.get(te.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(te.PARAMETER_INT_SOURCE_FROM.getParameterName()),s=e?.getArguments()?.get(te.PARAMETER_INT_LENGTH.getParameterName());if(-1==s&&(s=t.length-r),r+s>t.length)throw new F(k.format("Array has no elements from $ to $ as the array size is $",r,r+s,t.length));let n=[...t],a=r+s;for(let e=a-1;e>=r;e--)for(let t=e-1;t>=r;t--)if(W(n[e],n[t])){n.splice(e,1);break}return new B([$.outputOf(v.of(te.EVENT_RESULT_NAME,n))])}}let tt="keyPath",tr="valuePath",ts="ignoreNullValues",tn="ignoreNullKeys",ta="ignoreDuplicateKeys";class ti extends e_{constructor(){super("ArrayToObjects",[e_.PARAMETER_ARRAY_SOURCE,U.of(tt,I.ofString(tt)),U.of(tr,I.of(tr,c.STRING,c.NULL)),U.of(ts,I.ofBoolean(ts).setDefaultValue(!1)),U.of(tn,I.ofBoolean(tn).setDefaultValue(!0)),U.of(ta,I.ofBoolean(ta).setDefaultValue(!1))],e_.EVENT_RESULT_ANY)}async internalExecute(e){let t=e?.getArguments()?.get(e_.PARAMETER_ARRAY_SOURCE.getParameterName()),r=e?.getArguments()?.get(tt),s=e?.getArguments()?.get(tr)??"",n=e?.getArguments()?.get(ts),a=e?.getArguments()?.get(tn),i=e?.getArguments()?.get(ta),o=new e7({},"Data."),E=t.filter(e=>!l(e)).reduce((e,t)=>{o.setStore(t);let E=o.getValue("Data."+r);if(a&&l(E))return e;let u=s?o.getValue("Data."+s):t;return n&&l(u)||i&&e.hasOwnProperty(E)||(e[E]=u),e},{});return new B([$.outputOf(new Map([[e_.EVENT_RESULT_NAME,E]]))])}}let to="source",tE="delimiter",tu="result";class tA extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e?.getArguments()?.get(to),r=e?.getArguments()?.get(tE);return new B([$.outputOf(new Map([[tu,t.join(r)]]))])}constructor(...e){super(...e),this.signature=new Y("Join").setNamespace(A.SYSTEM_ARRAY).setParameters(new Map([[to,new U(to,I.ofArray(to,I.of("each",c.STRING,c.INTEGER,c.LONG,c.DOUBLE,c.FLOAT,c.NULL)))],[tE,new U(tE,I.ofString(tE).setDefaultValue(""))]])).setEvents(new Map([G.outputEventMapEntry(new Map([[tu,I.ofString(tu)]]))]))}}class tl{async find(e,t){return e!=A.SYSTEM_ARRAY?Promise.resolve(void 0):Promise.resolve(this.repoMap.get(t))}async filter(e){return Promise.resolve(this.filterableNames.filter(t=>-1!==t.toLowerCase().indexOf(e.toLowerCase())))}constructor(){this.repoMap=v.ofArrayEntries(D(new eM),D(new eS),D(new eI),D(new ex),D(new eU),D(new eb),D(new ev),D(new eV),D(new eC),D(new eD),D(new eG),D(new e$),D(new eF),D(new eB),D(new eY),D(new ek),D(new eH),D(new ej),D(new eW),D(new eX),D(new eJ),D(new eq),D(new eK),D(new e4),D(new e6),D(new ed),D(new e3),D(new e8),D(new te),D(new ti),D(new tA)),this.filterableNames=Array.from(this.repoMap.values()).map(e=>e.getSignature().getFullName())}}t({},"ContextElement",()=>tT);class tT{static{this.NULL=new tT(I.NULL,void 0)}constructor(e,t){this.schema=e,this.element=t}getSchema(){return this.schema}setSchema(e){return this.schema=e,this}getElement(){return this.element}setElement(e){return this.element=e,this}}let tc="name",th="schema";class tg extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e?.getArguments()?.get(tc);if(e?.getContext()?.has(t))throw new F(k.format("Context already has an element for '$' ",t));let r=I.from(e?.getArguments()?.get(th));if(!r)throw new F("Schema is not supplied.");return e.getContext().set(t,new tT(r,l(r.getDefaultValue())?void 0:r.getDefaultValue())),new B([$.outputOf(new Map)])}constructor(...e){super(...e),this.signature=new Y("Create").setNamespace(A.SYSTEM_CTX).setParameters(new Map([U.ofEntry(tc,new I().setName(tc).setType(p.of(c.STRING)).setMinLength(1).setFormat(ei.REGEX).setPattern("^[a-zA-Z_$][a-zA-Z_$0-9]*$"),!1,x.CONSTANT),U.ofEntry(th,I.SCHEMA,!1,x.CONSTANT)])).setEvents(new Map([G.outputEventMapEntry(new Map)]))}}let tR="name",tp="value";class tm extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e?.getArguments()?.get(tR);if(!e.getContext()?.has(t))throw new F(k.format("Context don't have an element for '$' ",t));return new B([$.outputOf(new Map([tp,e.getContext()?.get(t)?.getElement()]))])}constructor(...e){super(...e),this.signature=new Y("Get").setNamespace(A.SYSTEM_CTX).setParameters(new Map([U.ofEntry(tR,new I().setName(tR).setType(p.of(c.STRING)).setMinLength(1).setFormat(ei.REGEX).setPattern("^[a-zA-Z_$][a-zA-Z_$0-9]*$"),!1,x.CONSTANT)])).setEvents(new Map([G.outputEventMapEntry(new Map([[tp,I.ofAny(tp)]]))]))}}t({},"ExpressionEvaluator",()=>rS);var tf={},tN={};t(tN,"ArithmeticAdditionOperator",()=>tS);var t_={};t(t_,"BinaryOperator",()=>tM);class tM{nullCheck(e,t,r){if(l(e)||l(t))throw new ew(k.format("$ cannot be applied to a null value",r.getOperatorName()))}}class tS extends tM{apply(e,t){return l(e)?t:l(t)?e:e+t}}var tO={};t(tO,"ArithmeticDivisionOperator",()=>td);class td extends tM{apply(e,t){return this.nullCheck(e,t,e1.DIVISION),e/t}}var tw={};t(tw,"ArithmeticIntegerDivisionOperator",()=>tP);class tP extends tM{apply(e,t){return this.nullCheck(e,t,e1.DIVISION),Math.floor(e/t)}}var tI={};t(tI,"ArithmeticModulusOperator",()=>ty);class ty extends tM{apply(e,t){return this.nullCheck(e,t,e1.MOD),e%t}}var tx={};t(tx,"ArithmeticMultiplicationOperator",()=>tL);class tL extends tM{apply(e,t){this.nullCheck(e,t,e1.MULTIPLICATION);let r="string"==typeof e,s=typeof t;if(r||"string"===s){let s=r?e:t,n=r?t:e,a="",i=n<0,o=Math.floor(n=Math.abs(n));for(;o-- >0;)a+=s;let E=Math.floor(s.length*(n-Math.floor(n)));if(E<0&&(E=-E),0!=E&&(a+=s.substring(0,E)),i){let e="";for(let t=a.length-1;t>=0;t--)e+=a[t];return e}return a}return e*t}}var tU={};t(tU,"ArithmeticSubtractionOperator",()=>tb);class tb extends tM{apply(e,t){return this.nullCheck(e,t,e1.SUBTRACTION),e-t}}var tv={};t(tv,"ArrayOperator",()=>tV);class tV extends tM{apply(e,t){if(!e)throw new ew("Cannot apply array operator on a null value");if(!t)throw new ew("Cannot retrive null index value");if(!Array.isArray(e)&&"string"!=typeof e)throw new ew(k.format("Cannot retrieve value from a primitive value $",e));if(t>=e.length)throw new ew(k.format("Cannot retrieve index $ from the array of length $",t,e.length));return e[t]}}var tC={};t(tC,"BitwiseAndOperator",()=>tD);class tD extends tM{apply(e,t){return this.nullCheck(e,t,e1.BITWISE_AND),e&t}}var tG={};t(tG,"BitwiseLeftShiftOperator",()=>t$);class t$ extends tM{apply(e,t){return this.nullCheck(e,t,e1.BITWISE_LEFT_SHIFT),e<<t}}var tF={};t(tF,"BitwiseOrOperator",()=>tB);class tB extends tM{apply(e,t){return this.nullCheck(e,t,e1.BITWISE_OR),e|t}}var tY={};t(tY,"BitwiseRightShiftOperator",()=>tk);class tk extends tM{apply(e,t){return this.nullCheck(e,t,e1.BITWISE_RIGHT_SHIFT),e>>t}}var tH={};t(tH,"BitwiseUnsignedRightShiftOperator",()=>tj);class tj extends tM{apply(e,t){return this.nullCheck(e,t,e1.BITWISE_UNSIGNED_RIGHT_SHIFT),e>>>t}}var tW={};t(tW,"BitwiseXorOperator",()=>tX);class tX extends tM{apply(e,t){return this.nullCheck(e,t,e1.BITWISE_XOR),e^t}}var tJ={};t(tJ,"LogicalAndOperator",()=>tq);class tq extends tM{apply(e,t){return!!e&&""!==e&&!!t&&""!==t}}var tK={};t(tK,"LogicalEqualOperator",()=>tz);class tz extends tM{apply(e,t){return W(e,t)}}var tQ={};t(tQ,"LogicalGreaterThanEqualOperator",()=>tZ);class tZ extends tM{apply(e,t){let r=eP.findPrimitiveNullAsBoolean(e),s=eP.findPrimitiveNullAsBoolean(t);if(r.getT1()==c.BOOLEAN||s.getT1()==c.BOOLEAN)throw new ew(k.format("Cannot compare >= with the values $ and $",r.getT2(),s.getT2()));return r.getT2()>=s.getT2()}}var t0={};t(t0,"LogicalGreaterThanOperator",()=>t1);class t1 extends tM{apply(e,t){let r=eP.findPrimitiveNullAsBoolean(e),s=eP.findPrimitiveNullAsBoolean(t);if(r.getT1()==c.BOOLEAN||s.getT1()==c.BOOLEAN)throw new ew(k.format("Cannot compare > with the values $ and $",r.getT2(),s.getT2()));return r.getT2()>s.getT2()}}var t2={};t(t2,"LogicalLessThanEqualOperator",()=>t5);class t5 extends tM{apply(e,t){let r=eP.findPrimitiveNullAsBoolean(e),s=eP.findPrimitiveNullAsBoolean(t);if(r.getT1()==c.BOOLEAN||s.getT1()==c.BOOLEAN)throw new ew(k.format("Cannot compare <= with the values $ and $",r.getT2(),s.getT2()));return r.getT2()<=s.getT2()}}var t7={};t(t7,"LogicalNotEqualOperator",()=>t4);class t4 extends tM{apply(e,t){return!W(e,t)}}var t9={};t(t9,"LogicalLessThanOperator",()=>t6);class t6 extends tM{apply(e,t){let r=eP.findPrimitiveNullAsBoolean(e),s=eP.findPrimitiveNullAsBoolean(t);if(r.getT1()==c.BOOLEAN||s.getT1()==c.BOOLEAN)throw new ew(k.format("Cannot compare < with the values $ and $",r.getT2(),s.getT2()));return r.getT2()<s.getT2()}}var t3={};t(t3,"LogicalOrOperator",()=>t8);class t8 extends tM{apply(e,t){return!!e&&""!==e||!!t&&""!==t}}var re={};t(re,"ObjectOperator",()=>rt);class rt extends tM{apply(e,t){if(!e)throw new ew("Cannot apply array operator on a null value");if(!t)throw new ew("Cannot retrive null property value");let r=typeof e;if(!Array.isArray(e)&&"string"!=r&&"object"!=r)throw new ew(k.format("Cannot retrieve value from a primitive value $",e));return e[t]}}var rr={};t(rr,"LogicalNullishCoalescingOperator",()=>rs);class rs extends tM{apply(e,t){return l(e)?t:e}}var rn={};t(rn,"ArrayRangeOperator",()=>ra);class ra extends tM{apply(e,t){return`${e??""}..${t??""}`}}r(tf,tN),r(tf,tO),r(tf,tw),r(tf,tI),r(tf,tx),r(tf,tU),r(tf,tv),r(tf,t_),r(tf,tC),r(tf,tG),r(tf,tF),r(tf,tY),r(tf,tH),r(tf,tW),r(tf,tJ),r(tf,tK),r(tf,tQ),r(tf,t0),r(tf,t2),r(tf,t7),r(tf,t9),r(tf,t3),r(tf,re),r(tf,rr),r(tf,rn);var ri={},ro={};t(ro,"ArithmeticUnaryMinusOperator",()=>rA);var rE={};t(rE,"UnaryOperator",()=>ru);class ru{nullCheck(e,t){if(l(e))throw new ew(k.format("$ cannot be applied to a null value",t.getOperatorName()))}}class rA extends ru{apply(e){return this.nullCheck(e,e1.UNARY_MINUS),eP.findPrimitiveNumberType(e),-e}}var rl={};t(rl,"ArithmeticUnaryPlusOperator",()=>rT);class rT extends ru{apply(e){return this.nullCheck(e,e1.UNARY_PLUS),eP.findPrimitiveNumberType(e),e}}var rc={};t(rc,"BitwiseComplementOperator",()=>rh);class rh extends ru{apply(e){this.nullCheck(e,e1.UNARY_BITWISE_COMPLEMENT);let t=eP.findPrimitiveNumberType(e);if(t.getT1()!=c.INTEGER&&t.getT1()!=c.LONG)throw new ew(k.format("Unable to apply bitwise operator on $",e));return~e}}var rg={};t(rg,"LogicalNotOperator",()=>rR);class rR extends ru{apply(e){return!e&&""!==e}}r(ri,ro),r(ri,rl),r(ri,rc),r(ri,rg),r(ri,rE),t({},"LiteralTokenValueExtractor",()=>rm);let rp=new Map([["true",!0],["false",!1],["null",void 0],["undefined",void 0]]);class rm extends e5{static{this.INSTANCE=new rm}getValueInternal(e){if(!X.isNullOrBlank(e))return(e=e.trim(),rp.has(e))?rp.get(e):e.startsWith('"')?this.processString(e):this.processNumbers(e)}processNumbers(e){try{let t=Number(e);if(isNaN(t))throw Error("Parse number error");return t}catch(t){throw new eQ(e,k.format("Unable to parse the literal or expression $",e),t)}}processString(e){if(!e.endsWith('"'))throw new eQ(e,k.format("String literal $ is not closed properly",e));return e.substring(1,e.length-1)}getPrefix(){return""}getStore(){}getValueFromExtractors(e,t){return t.has(e+".")?t.get(e+".")?.getStore():this.getValue(e)}}var rf={};t(rf,"ConditionalTernaryOperator",()=>r_);class rN{nullCheck(e,t,r,s){if(l(e)||l(t)||l(r))throw new ew(k.format("$ cannot be applied to a null value",s.getOperatorName()))}}class r_ extends rN{apply(e,t,r){return e?t:r}}r({},rf);class rM extends e5{static{this.PREFIX="_internal."}addValue(e,t){this.values.set(e,t)}getValueInternal(e){let t=e5.splitPath(e),r=t[1],s=r.indexOf("["),n=2;return -1!=s&&(r=t[1].substring(0,s),(t=[...t])[1]=t[1].substring(s),n=1),this.retrieveElementFrom(e,t,n,this.values.get(r))}getPrefix(){return rM.PREFIX}getStore(){}constructor(...e){super(...e),this.values=new Map}}class rS{static{this.expressionCache=new Map}static{this.keyCounter=0}static getCachedExpression(e){let t=rS.expressionCache.get(e);return t||(t=new e2(e),rS.expressionCache.set(e,t)),t}static{this.UNARY_OPERATORS_MAP=new Map([[e1.UNARY_BITWISE_COMPLEMENT,new rh],[e1.UNARY_LOGICAL_NOT,new rR],[e1.UNARY_MINUS,new rA],[e1.UNARY_PLUS,new rT]])}static{this.TERNARY_OPERATORS_MAP=new Map([[e1.CONDITIONAL_TERNARY_OPERATOR,new r_]])}static{this.BINARY_OPERATORS_MAP=new Map([[e1.ADDITION,new tS],[e1.DIVISION,new td],[e1.INTEGER_DIVISION,new tP],[e1.MOD,new ty],[e1.MULTIPLICATION,new tL],[e1.SUBTRACTION,new tb],[e1.BITWISE_AND,new tD],[e1.BITWISE_LEFT_SHIFT,new t$],[e1.BITWISE_OR,new tB],[e1.BITWISE_RIGHT_SHIFT,new tk],[e1.BITWISE_UNSIGNED_RIGHT_SHIFT,new tj],[e1.BITWISE_XOR,new tX],[e1.AND,new tq],[e1.EQUAL,new tz],[e1.GREATER_THAN,new t1],[e1.GREATER_THAN_EQUAL,new tZ],[e1.LESS_THAN,new t6],[e1.LESS_THAN_EQUAL,new t5],[e1.OR,new t8],[e1.NOT_EQUAL,new t4],[e1.NULLISH_COALESCING_OPERATOR,new rs],[e1.ARRAY_OPERATOR,new tV],[e1.ARRAY_RANGE_INDEX_OPERATOR,new ra],[e1.OBJECT_OPERATOR,new rt]])}static{this.UNARY_OPERATORS_MAP_KEY_SET=new Set(rS.UNARY_OPERATORS_MAP.keys())}static{this.PATTERN_UNKNOWN=0}static{this.PATTERN_LITERAL=1}static{this.PATTERN_SIMPLE_PATH=2}static{this.PATTERN_SIMPLE_ARRAY_ACCESS=3}static{this.PATTERN_SIMPLE_COMPARISON=4}static{this.PATTERN_SIMPLE_TERNARY=5}static{this.patternCache=new Map}static{this.LITERAL_TRUE="true"}static{this.LITERAL_FALSE="false"}static{this.LITERAL_NULL="null"}static{this.LITERAL_UNDEFINED="undefined"}static{this.NUMBER_REGEX=/^-?\d+(\.\d+)?$/}static{this.SINGLE_QUOTE_STRING_REGEX=/^'([^'\\]|\\.)*'$/}static{this.DOUBLE_QUOTE_STRING_REGEX=/^"([^"\\]|\\.)*"$/}static{this.SIMPLE_PATH_REGEX=/^[A-Za-z_][A-Za-z0-9_]*(\.[A-Za-z_][A-Za-z0-9_]*|\[\d+\])*$/}static detectPattern(e){let t=e.getExpression(),r=rS.patternCache.get(t);if(void 0!==r)return r;let s=rS.PATTERN_UNKNOWN;if(t===rS.LITERAL_TRUE||t===rS.LITERAL_FALSE||t===rS.LITERAL_NULL||t===rS.LITERAL_UNDEFINED||rS.NUMBER_REGEX.test(t)||rS.SINGLE_QUOTE_STRING_REGEX.test(t)||rS.DOUBLE_QUOTE_STRING_REGEX.test(t))s=rS.PATTERN_LITERAL;else if(!t.includes(".")||t.includes("{{")||t.includes("..")){if(t.includes(".."))s=rS.PATTERN_UNKNOWN;else if(!t.includes("{{")){let t=e.getOperationsArray();s=rS.detectTernaryOrComparison(e,t)}}else{let t=e.getOperationsArray(),r=e.getTokensArray(),n=t.length>0;for(let e of t)if(e!==e1.OBJECT_OPERATOR&&e!==e1.ARRAY_OPERATOR){n=!1;break}if(n){for(let e of r)if(e instanceof e2){n=!1;break}}s=n?rS.PATTERN_SIMPLE_PATH:rS.detectTernaryOrComparison(e,t)}return rS.patternCache.set(t,s),s}static detectTernaryOrComparison(e,t){for(let t of e.getTokensArray())if(t instanceof e2)return rS.PATTERN_UNKNOWN;return 1===t.length&&t[0]===e1.CONDITIONAL_TERNARY_OPERATOR?rS.PATTERN_SIMPLE_TERNARY:1===t.length&&(t[0]===e1.EQUAL||t[0]===e1.NOT_EQUAL)?rS.PATTERN_SIMPLE_COMPARISON:rS.PATTERN_UNKNOWN}static evaluateLiteral(e){if(e===rS.LITERAL_TRUE)return!0;if(e===rS.LITERAL_FALSE)return!1;if(e===rS.LITERAL_NULL)return null;if(e!==rS.LITERAL_UNDEFINED){if(rS.NUMBER_REGEX.test(e))return e.includes(".")?Number.parseFloat(e):Number.parseInt(e,10);if(rS.SINGLE_QUOTE_STRING_REGEX.test(e)||rS.DOUBLE_QUOTE_STRING_REGEX.test(e))return e.slice(1,-1)}}evaluateSimplePath(e,t){let r=e.getExpression(),s=r.indexOf(".");if(-1===s)return;let n=r.substring(0,s+1),a=t.get(n);if(a)return a.getValue(r)}evaluateSimpleComparison(e,t){let r=e.getOperationsArray(),s=e.getTokensArray();if(2!==s.length||1!==r.length)return;let n=this.getTokenValue(s[1],t),a=this.getTokenValue(s[0],t);return r[0]===e1.EQUAL?n==a:r[0]===e1.NOT_EQUAL?n!=a:void 0}evaluateSimpleTernary(e,t){let r=e.getTokensArray();if(3!==r.length)return;let s=this.getTokenValue(r[2],t),n=this.getTokenValue(r[1],t),a=this.getTokenValue(r[0],t);return s?n:a}getTokenValue(e,t){if(e instanceof e0)return e.getElement();let r=e.getExpression(),s=rS.evaluateLiteral(r);if(void 0!==s||"undefined"===r||"null"===r)return s;let n=r.indexOf(".");if(-1!==n){let e=r.substring(0,n+1),s=t.get(e);if(s)return s.getValue(r)}return rm.INSTANCE.getValue(r)}constructor(e){this.internalTokenValueExtractor=new rM,e instanceof e2?(this.exp=e,this.expression=this.exp.getExpression()):this.expression=e}evaluate(e){let t=this.processNestingExpression(this.expression,e);this.expression=t.getT1(),this.exp=t.getT2();let r=rS.detectPattern(this.exp);return r===rS.PATTERN_LITERAL?rS.evaluateLiteral(this.expression):r===rS.PATTERN_SIMPLE_PATH?this.evaluateSimplePath(this.exp,e):r===rS.PATTERN_SIMPLE_COMPARISON?this.evaluateSimpleComparison(this.exp,e):r===rS.PATTERN_SIMPLE_TERNARY?this.evaluateSimpleTernary(this.exp,e):((e=new Map(e.entries())).set(this.internalTokenValueExtractor.getPrefix(),this.internalTokenValueExtractor),this.evaluateExpression(this.exp,e))}processNestingExpression(e,t){let r=0,s=0,n=new H;for(;s<e.length-1;){if("{"==e.charAt(s)&&"{"==e.charAt(s+1))0==r&&n.push(new q(s+2,-1)),r++,s++;else if("}"==e.charAt(s)&&"}"==e.charAt(s+1)){if(--r<0)throw new eQ(e,"Expecting {{ nesting path operator to be started before closing");0==r&&n.push(n.pop().setT2(s)),s++}s++}let a=this.replaceNestingExpression(e,t,n);return new q(a,rS.getCachedExpression(a))}replaceNestingExpression(e,t,r){let s=e;for(let n of r.toArray()){if(-1==n.getT2())throw new eQ(e,"Expecting }} nesting path operator to be closed");let r=new rS(s.substring(n.getT1(),n.getT2())).evaluate(t);s=s.substring(0,n.getT1()-2)+r+s.substring(n.getT2()+2)}return s}getExpression(){return this.exp||(this.exp=rS.getCachedExpression(this.expression)),this.exp}getExpressionString(){return this.expression}evaluateExpression(e,t){let r=e.getOperationsArray(),s=e.getTokensArray(),n=[],a={opIdx:0,srcIdx:0},i=()=>n.length>0?n.pop():s[a.srcIdx++],o=()=>{if(!(a.opIdx>=r.length))return r[a.opIdx++]},E=()=>{if(!(a.opIdx>=r.length))return r[a.opIdx]},u=()=>n.length>0||a.srcIdx<s.length;for(;a.opIdx<r.length;){let e=o(),A=i();if(rS.UNARY_OPERATORS_MAP_KEY_SET.has(e))n.push(this.applyUnaryOperation(e,this.getValueFromToken(t,A)));else if(e==e1.OBJECT_OPERATOR||e==e1.ARRAY_OPERATOR)this.processObjectOrArrayOperatorIndexed(t,r,s,n,a,e,A,i,o,E,u);else if(e==e1.CONDITIONAL_TERNARY_OPERATOR){let r=i(),s=i(),a=this.getValueFromToken(t,s),o=this.getValueFromToken(t,r),E=this.getValueFromToken(t,A);n.push(this.applyTernaryOperation(e,a,o,E))}else{let r=i(),s=this.getValueFromToken(t,r),a=this.getValueFromToken(t,A);n.push(this.applyBinaryOperation(e,s,a))}}for(;a.srcIdx<s.length;)n.push(s[a.srcIdx++]);if(0===n.length)throw new ew(k.format("Expression : $ evaluated to null",e));if(1!==n.length)throw new ew(k.format("Expression : $ evaluated multiple values $",e,n));let A=n[0];return A instanceof e0?A.getElement():A instanceof e2?this.evaluateExpression(A,t):this.getValueFromToken(t,A)}processObjectOrArrayOperatorIndexed(e,t,r,s,n,a,i,o,E,u,A){let l=[],T=[];if(!a||!i)return;do T.push(a),i instanceof e2?l.push(new e0(i.toString(),this.evaluateExpression(i,e))):i&&l.push(i),i=A()?o():void 0,a=E();while(a==e1.OBJECT_OPERATOR||a==e1.ARRAY_OPERATOR)i&&(i instanceof e2?l.push(new e0(i.toString(),this.evaluateExpression(i,e))):l.push(i)),void 0!==a&&n.opIdx--;let c=l.length-1,h=T.length-1,g=l[c--];if(g instanceof e0&&"object"==typeof g.getTokenValue()){let e="_k"+rS.keyCounter++;this.internalTokenValueExtractor.addValue(e,g.getTokenValue()),g=new eZ(rM.PREFIX+e)}let R=g instanceof e0?g.getTokenValue():g.toString();for(;c>=0;){g=l[c--],a=T[h--];let e=g instanceof e0?g.getTokenValue():g.toString();R=R+a.getOperator()+e+(a==e1.ARRAY_OPERATOR?"]":"")}let p=R.substring(0,R.indexOf(".")+1);if(p.length>2&&e.has(p))s.push(new e0(R,this.getValue(R,e)));else{let e;try{e=rm.INSTANCE.getValue(R)}catch(t){e=R}s.push(new e0(R,e))}}applyTernaryOperation(e,t,r,s){let n=rS.TERNARY_OPERATORS_MAP.get(e);if(!n)throw new eQ(this.expression,k.format("No operator found to evaluate $",this.getExpression()));return new e0(e.toString(),n.apply(t,r,s))}applyBinaryOperation(e,t,r){let s=typeof t,n=typeof r,a=rS.BINARY_OPERATORS_MAP.get(e);if(("object"===s||"object"===n)&&e!==e1.EQUAL&&e!==e1.NOT_EQUAL&&e!==e1.NULLISH_COALESCING_OPERATOR&&e!==e1.AND&&e!==e1.OR)throw new eQ(this.expression,k.format("Cannot evaluate expression $ $ $",t,e.getOperator(),r));if(!a)throw new eQ(this.expression,k.format("No operator found to evaluate $ $ $",t,e.getOperator(),r));return new e0(e.toString(),a.apply(t,r))}applyUnaryOperation(e,t){let r=typeof t;if(e.getOperator()!=e1.NOT.getOperator()&&e.getOperator()!=e1.UNARY_LOGICAL_NOT.getOperator()&&("object"===r||Array.isArray(t)))throw new eQ(this.expression,k.format("The operator $ cannot be applied to $",e.getOperator(),t));let s=rS.UNARY_OPERATORS_MAP.get(e);if(!s)throw new eQ(this.expression,k.format("No Unary operator $ is found to apply on $",e.getOperator(),t));return new e0(e.toString(),s.apply(t))}getValueFromToken(e,t){return t instanceof e2?this.evaluateExpression(t,e):t instanceof e0?t.getElement():this.getValue(t.getExpression(),e)}getValue(e,t){let r=e.substring(0,e.indexOf(".")+1);return t.has(r)?t.get(r).getValue(e):rm.INSTANCE.getValueFromExtractors(e,t)}}let rO="name",rd="value";class rw extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e?.getArguments()?.get(rO);if(X.isNullOrBlank(t))throw new F("Empty string is not a valid name for the context element");let r=e?.getArguments()?.get(rd),s=new e2(t),n=s.getTokens().peekLast();if(!n.getExpression().startsWith("Context")||n instanceof e2||n instanceof e0&&!n.getElement().toString().startsWith("Context"))throw new ew(k.format("The context path $ is not a valid path in context",t));for(let e of s.getOperations().toArray())if(e!=e1.ARRAY_OPERATOR&&e!=e1.OBJECT_OPERATOR)throw new ew(k.format("Expected a reference to the context location, but found an expression $",t));for(let r=0;r<s.getTokens().size();r++){let n=s.getTokens().get(r);n instanceof e2&&s.getTokens().set(r,new e0(t,new rS(n).evaluate(e.getValuesMap())))}return this.modifyContext(e,t,r,s)}modifyContext(e,t,r,s){let n=s.getTokens();n.removeLast();let a=s.getOperations();a.removeLast();let i=e.getContext()?.get(n.removeLast().getExpression());if(l(i))throw new F(k.format("Context doesn't have any element with name '$' ",t));if(a.isEmpty())return i.setElement(r),new B([$.outputOf(new Map)]);let o=i.getElement(),E=a.removeLast(),u=n.removeLast(),A=u instanceof e0?u.getElement():u.getExpression();for(l(o)&&(o=E==e1.OBJECT_OPERATOR?{}:[],i.setElement(o));!a.isEmpty();)o=E==e1.OBJECT_OPERATOR?this.getDataFromObject(o,A,a.peekLast()):this.getDataFromArray(o,A,a.peekLast()),E=a.removeLast(),A=(u=n.removeLast())instanceof e0?u.getElement():u.getExpression();return E==e1.OBJECT_OPERATOR?this.putDataInObject(o,A,r):this.putDataInArray(o,A,r),new B([$.outputOf(new Map)])}getDataFromArray(e,t,r){if(!Array.isArray(e))throw new F(k.format("Expected an array but found $",e));let s=parseInt(t);if(isNaN(s))throw new F(k.format("Expected an array index but found $",t));if(s<0)throw new F(k.format("Array index is out of bound - $",t));let n=e[s];return l(n)&&(n=r==e1.OBJECT_OPERATOR?{}:[],e[s]=n),n}getDataFromObject(e,t,r){if(Array.isArray(e)||"object"!=typeof e)throw new F(k.format("Expected an object but found $",e));let s=e[t];return l(s)&&(s=r==e1.OBJECT_OPERATOR?{}:[],e[t]=s),s}putDataInArray(e,t,r){if(!Array.isArray(e))throw new F(k.format("Expected an array but found $",e));let s=parseInt(t);if(isNaN(s))throw new F(k.format("Expected an array index but found $",t));if(s<0)throw new F(k.format("Array index is out of bound - $",t));e[s]=r}putDataInObject(e,t,r){if(Array.isArray(e)||"object"!=typeof e)throw new F(k.format("Expected an object but found $",e));e[t]=r}constructor(...e){super(...e),this.signature=new Y("Set").setNamespace(A.SYSTEM_CTX).setParameters(new Map([U.ofEntry(rO,new I().setName(rO).setType(p.of(c.STRING)).setMinLength(1),!1),U.ofEntry(rd,I.ofAny(rd))])).setEvents(new Map([G.outputEventMapEntry(new Map)]))}}let rP="value",rI="eventName",ry="results";class rx extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e.getEvents(),r=e.getArguments(),s=r?.get(rI),n=e?.getArguments()?.get(ry).map(t=>{let r=t[rP];if(l(r))throw new F("Expect a value object");let s=r.value;return r.isExpression&&(s=new rS(s).evaluate(e.getValuesMap())),[t.name,s]}).reduce((e,t)=>(e.set(t[0],t[1]),e),new Map);return t?.has(s)||t?.set(s,[]),t?.get(s)?.push(n),new B([$.outputOf(new Map)])}constructor(...e){super(...e),this.signature=new Y("GenerateEvent").setNamespace(A.SYSTEM).setParameters(new Map([U.ofEntry(rI,I.ofString(rI).setDefaultValue("output")),U.ofEntry(ry,I.ofObject(ry).setProperties(new Map([["name",I.ofString("name")],[rP,U.EXPRESSION]])),!0)])).setEvents(new Map([G.outputEventMapEntry(new Map)]))}}class rL extends eN{static{this.CONDITION="condition"}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(rL.CONDITION);return new B([$.of(t||""===t?G.TRUE:G.FALSE,new Map),$.outputOf(new Map)])}constructor(...e){super(...e),this.signature=new Y("If").setNamespace(A.SYSTEM).setParameters(new Map([U.ofEntry(rL.CONDITION,I.ofAny(rL.CONDITION))])).setEvents(new Map([G.eventMapEntry(G.TRUE,new Map),G.eventMapEntry(G.FALSE,new Map),G.outputEventMapEntry(new Map)]))}}let rU="stepName";class rb extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(rU);return e.getExecutionContext().set(t,!0),new B([$.outputOf(new Map)])}constructor(...e){super(...e),this.signature=new Y("Break").setNamespace(A.SYSTEM_LOOP).setParameters(new Map([U.ofEntry(rU,I.of(rU,c.STRING))])).setEvents(new Map([G.outputEventMapEntry(new Map([]))]))}}let rv="count",rV="value",rC="index";class rD extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(rv),r=0,s=e.getStatementExecution()?.getStatement()?.getStatementName();return new B({next(){if(r>=t||s&&e.getExecutionContext()?.get(s))return s&&e.getExecutionContext()?.delete(s),$.outputOf(new Map([[rV,r]]));let n=$.of(G.ITERATION,new Map([[rC,r]]));return++r,n}})}constructor(...e){super(...e),this.signature=new Y("CountLoop").setNamespace(A.SYSTEM_LOOP).setParameters(new Map([U.ofEntry(rv,I.of(rv,c.INTEGER))])).setEvents(new Map([G.eventMapEntry(G.ITERATION,new Map([[rC,I.of(rC,c.INTEGER)]])),G.outputEventMapEntry(new Map([[rV,I.of(rV,c.INTEGER)]]))]))}}let rG="source",r$="each",rF="index",rB="value";class rY extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(rG),r=0,s=e.getStatementExecution()?.getStatement()?.getStatementName();return new B({next(){if(r>=t.length||s&&e.getExecutionContext()?.get(s))return s&&e.getExecutionContext()?.delete(s),$.outputOf(new Map([[rB,r]]));let n=$.of(G.ITERATION,new Map([[rF,r],[r$,t[r]]]));return++r,n}})}constructor(...e){super(...e),this.signature=new Y("ForEachLoop").setNamespace(A.SYSTEM_LOOP).setParameters(new Map([U.ofEntry(rG,I.ofArray(rG,I.ofAny(rG)))])).setEvents(new Map([G.eventMapEntry(G.ITERATION,new Map([[rF,I.of(rF,c.INTEGER)],[r$,I.ofAny(r$)]])),G.outputEventMapEntry(new Map([[rB,I.of(rB,c.INTEGER)]]))]))}}let rk="from",rH="step",rj="value",rW="index";class rX extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(rk),r=e.getArguments()?.get("to"),s=e.getArguments()?.get(rH),n=s>0,a=t,i=!1,o=e.getStatementExecution()?.getStatement()?.getStatementName();return new B({next(){if(i)return;if(n&&a>=r||!n&&a<=r||o&&e.getExecutionContext()?.get(o))return i=!0,o&&e.getExecutionContext()?.delete(o),$.outputOf(new Map([[rj,a]]));let t=$.of(G.ITERATION,new Map([[rW,a]]));return a+=s,t}})}constructor(...e){super(...e),this.signature=new Y("RangeLoop").setNamespace(A.SYSTEM_LOOP).setParameters(new Map([U.ofEntry(rk,I.of(rk,c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE).setDefaultValue(0)),U.ofEntry("to",I.of("to",c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE).setDefaultValue(1)),U.ofEntry(rH,I.of(rH,c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE).setDefaultValue(1).setNot(new I().setConstant(0)))])).setEvents(new Map([G.eventMapEntry(G.ITERATION,new Map([[rW,I.of(rW,c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE)]])),G.outputEventMapEntry(new Map([[rj,I.of(rj,c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE)]]))]))}}let rJ="value";class rq extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(rJ);return new B([$.outputOf(new Map([[rJ,t.reduce((e,t)=>e+=t,0)]]))])}constructor(...e){super(...e),this.signature=new Y("Add").setNamespace(A.MATH).setParameters(new Map([[rJ,new U(rJ,I.ofNumber(rJ)).setVariableArgument(!0)]])).setEvents(new Map([G.outputEventMapEntry(new Map([[rJ,I.ofNumber(rJ)]]))]))}}let rK="value",rz="value1",rQ="value2";class rZ extends eN{constructor(e,t,r=1,...s){super(),this.paramFunctions=[()=>new Map([[rK,new U(rK,I.ofNumber(rK))]]),()=>new Map([[rz,new U(rz,I.ofNumber(rz))],[rQ,new U(rQ,I.ofNumber(rQ))]])],s&&s.length||(s=[c.DOUBLE]),this.parametersNumber=r,this.mathFunction=t,this.signature=new Y(e).setNamespace(A.MATH).setParameters(this.paramFunctions[r-1]()).setEvents(new Map([G.outputEventMapEntry(new Map([[rK,new I().setType(p.of(...s)).setName(rK)]]))]))}getSignature(){return this.signature}async internalExecute(e){let t,r=eP.findPrimitiveNumberType(e.getArguments()?.get(1==this.parametersNumber?rK:rz)).getT2();return 2==this.parametersNumber&&(t=eP.findPrimitiveNumberType(e.getArguments()?.get(rQ)).getT2()),new B([$.outputOf(new Map([[rK,this.mathFunction.call(this,r,t)]]))])}}let r0="value";class r1 extends eN{constructor(){super(),this.signature=new Y("Hypotenuse").setNamespace(A.MATH).setParameters(new Map([[r0,new U(r0,I.ofNumber(r0)).setVariableArgument(!0)]])).setEvents(new Map([G.outputEventMapEntry(new Map([[r0,new I().setType(p.of(c.DOUBLE)).setName(r0)]]))]))}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(r0);return new B([$.outputOf(new Map([[r0,Math.sqrt(t.reduce((e,t)=>e+=t*t,0))]]))])}}let r2="value";class r5 extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(r2);return new B([$.outputOf(new Map([[r2,t.reduce((e,t)=>!e&&0!==e||t>e?t:e)]]))])}constructor(...e){super(...e),this.signature=new Y("Maximum").setNamespace(A.MATH).setParameters(new Map([[r2,new U(r2,I.ofNumber(r2)).setVariableArgument(!0)]])).setEvents(new Map([G.outputEventMapEntry(new Map([[r2,I.ofNumber(r2)]]))]))}}let r7="value";class r4 extends eN{getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(r7);return new B([$.outputOf(new Map([[r7,t.reduce((e,t)=>!e&&0!==e||t<e?t:e)]]))])}constructor(...e){super(...e),this.signature=new Y("Minimum").setNamespace(A.MATH).setParameters(new Map([[r7,new U(r7,I.ofNumber(r7)).setVariableArgument(!0)]])).setEvents(new Map([G.outputEventMapEntry(new Map([[r7,I.ofNumber(r7)]]))]))}}let r9="value";class r6 extends eN{getSignature(){return this.signature}async internalExecute(e){return new B([$.outputOf(new Map([[r9,Math.random()]]))])}constructor(...e){super(...e),this.signature=new Y("Random").setNamespace(A.MATH).setEvents(new Map([G.outputEventMapEntry(v.of(r9,I.ofDouble(r9)))]))}}class r3 extends eN{static{this.MIN_VALUE="minValue"}static{this.MAX_VALUE="maxValue"}static{this.VALUE="value"}constructor(e,t,r,s,n){super(),this.signature=new Y(e).setParameters(v.of(r3.MIN_VALUE,t,r3.MAX_VALUE,r)).setNamespace(A.MATH).setEvents(new Map([G.outputEventMapEntry(v.of(r3.VALUE,s))])),this.randomFunction=n}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(r3.MIN_VALUE),r=e.getArguments()?.get(r3.MAX_VALUE),s=this.randomFunction(t,r);return new B([$.outputOf(new Map([[r3.VALUE,s]]))])}}class r8{constructor(){this.functionObjectsIndex={Absolute:new rZ("Absolute",e=>Math.abs(e),1,c.INTEGER,c.LONG,c.FLOAT,c.DOUBLE),ArcCosine:new rZ("ArcCosine",e=>Math.acos(e)),ArcSine:new rZ("ArcSine",e=>Math.asin(e)),ArcTangent:new rZ("ArcTangent",e=>Math.atan(e)),Ceiling:new rZ("Ceiling",e=>Math.ceil(e)),Cosine:new rZ("Cosine",e=>Math.cos(e)),HyperbolicCosine:new rZ("HyperbolicCosine",e=>Math.cosh(e)),CubeRoot:new rZ("CubeRoot",e=>Math.cbrt(e)),Exponential:new rZ("Exponential",e=>Math.exp(e)),ExponentialMinus1:new rZ("ExponentialMinus1",e=>Math.expm1(e)),Floor:new rZ("Floor",e=>Math.floor(e)),LogNatural:new rZ("LogNatural",e=>Math.log(e)),Log10:new rZ("Log10",e=>Math.log10(e)),Round:new rZ("Round",e=>Math.round(e),1,c.INTEGER,c.LONG),Sine:new rZ("Sine",e=>Math.sin(e)),HyperbolicSine:new rZ("HyperbolicSine",e=>Math.sinh(e)),Tangent:new rZ("Tangent",e=>Math.tan(e)),HyperbolicTangent:new rZ("HyperbolicTangent",e=>Math.tanh(e)),ToDegrees:new rZ("ToDegrees",e=>Math.PI/180*e),ToRadians:new rZ("ToRadians",e=>180/Math.PI*e),SquareRoot:new rZ("SquareRoot",e=>Math.sqrt(e)),ArcTangent2:new rZ("ArcTangent2",(e,t)=>Math.atan2(e,t),2),Power:new rZ("Power",(e,t)=>Math.pow(e,t),2),Add:new rq,Hypotenuse:new r1,Maximum:new r5,Minimum:new r4,Random:new r6,RandomFloat:new r3("RandomFloat",U.of(r3.MIN_VALUE,I.ofFloat(r3.MIN_VALUE).setDefaultValue(0)),U.of(r3.MAX_VALUE,I.ofFloat(r3.MAX_VALUE).setDefaultValue(0x7fffffff)),I.ofFloat(r3.VALUE),(e,t)=>Math.random()*(t-e)+e),RandomInt:new r3("RandomInt",U.of(r3.MIN_VALUE,I.ofInteger(r3.MIN_VALUE).setDefaultValue(0)),U.of(r3.MAX_VALUE,I.ofInteger(r3.MAX_VALUE).setDefaultValue(0x7fffffff)),I.ofInteger(r3.VALUE),(e,t)=>Math.round(Math.random()*(t-e)+e)),RandomLong:new r3("RandomLong",U.of(r3.MIN_VALUE,I.ofLong(r3.MIN_VALUE).setDefaultValue(0)),U.of(r3.MAX_VALUE,I.ofLong(r3.MAX_VALUE).setDefaultValue(Number.MAX_SAFE_INTEGER)),I.ofLong(r3.VALUE),(e,t)=>Math.round(Math.random()*(t-e)+e)),RandomDouble:new r3("RandomDouble",U.of(r3.MIN_VALUE,I.ofDouble(r3.MIN_VALUE).setDefaultValue(0)),U.of(r3.MAX_VALUE,I.ofDouble(r3.MAX_VALUE).setDefaultValue(Number.MAX_VALUE)),I.ofDouble(r3.VALUE),(e,t)=>Math.random()*(t-e)+e)},this.filterableNames=Object.values(this.functionObjectsIndex).map(e=>e.getSignature().getFullName())}async find(e,t){return e!=A.MATH?Promise.resolve(void 0):Promise.resolve(this.functionObjectsIndex[t])}async filter(e){return Promise.resolve(this.filterableNames.filter(t=>-1!==t.toLowerCase().indexOf(e.toLowerCase())))}}class se extends eN{static{this.SOURCE="source"}static{this.SCHEMA="schema"}static{this.VALUE="value"}static{this.CONVERSION_MODE="conversionMode"}getSignature(){return this.signature}internalExecute(e){let t=e.getArguments()?.get(se.SOURCE),r=I.from(e?.getArguments()?.get(se.SCHEMA));if(!r)throw new F("Schema is not supplied.");let s=eu(e.getArguments()?.get(se.CONVERSION_MODE))||eE.STRICT;return this.convertToSchema(r,e.getSchemaRepository(),t,s)}async convertToSchema(e,t,r,s){try{return new B([$.outputOf(v.of(se.VALUE,ef.validate([],e,t,r,!0,s)))])}catch(e){throw new F(e?.message)}}constructor(...e){super(...e),this.signature=new Y("ObjectConvert").setNamespace(A.SYSTEM_OBJECT).setParameters(new Map([U.ofEntry(se.SOURCE,I.ofAny(se.SCHEMA)),U.ofEntry(se.SCHEMA,I.SCHEMA,!1,x.CONSTANT),U.ofEntry(se.CONVERSION_MODE,I.ofString(se.CONVERSION_MODE).setEnums(eA()))])).setEvents(new Map([G.outputEventMapEntry(v.of(se.VALUE,I.ofAny(se.VALUE)))]))}}let st="value",sr="source";class ss extends eN{constructor(){super(),this.signature=new Y("ObjectDeleteKey").setNamespace(A.SYSTEM_OBJECT).setParameters(new Map([U.ofEntry(sr,I.ofAny(sr)),U.ofEntry("key",I.ofString("key"))])).setEvents(new Map([G.outputEventMapEntry(new Map([[st,I.ofAny(st)]]))]))}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(sr),r=e.getArguments()?.get("key");return l(t)?new B([$.outputOf(new Map([[st,void 0]]))]):(t=eL(t),delete t[r],new B([$.outputOf(new Map([[st,t]]))]))}}let sn="source";class sa extends eN{constructor(e,t){super(),this.signature=new Y(e).setNamespace(A.SYSTEM_OBJECT).setParameters(new Map([U.ofEntry(sn,I.ofAny(sn))])).setEvents(new Map([G.outputEventMapEntry(new Map([["value",t]]))]))}getSignature(){return this.signature}}let si="value";class so extends sa{constructor(){super("ObjectEntries",I.ofArray(si,I.ofArray("tuple",I.ofString("key"),I.ofAny("value"))))}async internalExecute(e){var t=e.getArguments()?.get("source");if(l(t))return new B([$.outputOf(new Map([[si,[]]]))]);let r=Object.entries(eL(t)).sort((e,t)=>e[0].localeCompare(t[0]));return new B([$.outputOf(new Map([[si,r]]))])}}let sE="value";class su extends sa{constructor(){super("ObjectKeys",I.ofArray(sE,I.ofString(sE)))}async internalExecute(e){var t=e.getArguments()?.get("source");if(l(t))return new B([$.outputOf(new Map([[sE,[]]]))]);let r=Object.keys(eL(t)).sort((e,t)=>e.localeCompare(t));return new B([$.outputOf(new Map([[sE,r]]))])}}let sA="value",sl="source",sT="overwrite",sc="deleteKeyOnNull";class sh extends eN{constructor(){super(),this.signature=new Y("ObjectPutValue").setNamespace(A.SYSTEM_OBJECT).setParameters(new Map([U.ofEntry(sl,I.ofObject(sl)),U.ofEntry("key",I.ofString("key")),U.ofEntry(sA,I.ofAny(sA)),U.ofEntry(sT,I.ofBoolean(sT).setDefaultValue(!0)),U.ofEntry(sc,I.ofBoolean(sc).setDefaultValue(!1))])).setEvents(new Map([G.outputEventMapEntry(new Map([[sA,I.ofObject(sA)]]))]))}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(sl),r=e.getArguments()?.get("key"),s=e.getArguments()?.get(sA),n=e.getArguments()?.get(sT),a=e.getArguments()?.get(sc),i=new e7(t,"Data.");return i.setValue(r,s,n,a),new B([$.outputOf(new Map([[sA,i.getStore()]]))])}}let sg="value";class sR extends sa{constructor(){super("ObjectValues",I.ofArray(sg,I.ofAny(sg)))}async internalExecute(e){var t=e.getArguments()?.get("source");if(l(t))return new B([$.outputOf(new Map([[sg,[]]]))]);let r=Object.entries(eL(t)).sort((e,t)=>e[0].localeCompare(t[0])).map(e=>e[1]);return new B([$.outputOf(new Map([[sg,r]]))])}}class sp{constructor(){this.functionObjectsIndex={ObjectValues:new sR,ObjectKeys:new su,ObjectEntries:new so,ObjectDeleteKey:new ss,ObjectPutValue:new sh,ObjectConvert:new se},this.filterableNames=Object.values(this.functionObjectsIndex).map(e=>e.getSignature().getFullName())}async find(e,t){return e!=A.SYSTEM_OBJECT?Promise.resolve(void 0):Promise.resolve(this.functionObjectsIndex[t])}async filter(e){return Promise.resolve(this.filterableNames.filter(t=>-1!==t.toLowerCase().indexOf(e.toLowerCase())))}}class sm extends eN{static{this.VALUES="values"}static{this.STREAM="stream"}static{this.LOG="LOG"}static{this.ERROR="ERROR"}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(sm.VALUES),r=e.getArguments()?.get(sm.STREAM);return(r===sm.LOG?console?.log:console?.error)?.(...t),new B([$.outputOf(new Map)])}constructor(...e){super(...e),this.signature=new Y("Print").setNamespace(A.SYSTEM).setParameters(new Map([U.ofEntry(sm.VALUES,I.ofAny(sm.VALUES),!0),U.ofEntry(sm.STREAM,I.ofString(sm.STREAM).setEnums([sm.LOG,sm.ERROR]).setDefaultValue(sm.LOG))])).setEvents(new Map([G.outputEventMapEntry(new Map)]))}}class sf extends eN{static{this.PARAMETER_STRING_NAME="string"}static{this.PARAMETER_SEARCH_STRING_NAME="searchString"}static{this.PARAMETER_SECOND_STRING_NAME="secondString"}static{this.PARAMETER_THIRD_STRING_NAME="thirdString"}static{this.PARAMETER_INDEX_NAME="index"}static{this.PARAMETER_SECOND_INDEX_NAME="secondIndex"}static{this.EVENT_RESULT_NAME="result"}static{this.PARAMETER_STRING=new U(sf.PARAMETER_STRING_NAME,I.ofString(sf.PARAMETER_STRING_NAME))}static{this.PARAMETER_SECOND_STRING=new U(sf.PARAMETER_SECOND_STRING_NAME,I.ofString(sf.PARAMETER_SECOND_STRING_NAME))}static{this.PARAMETER_THIRD_STRING=new U(sf.PARAMETER_THIRD_STRING_NAME,I.ofString(sf.PARAMETER_THIRD_STRING_NAME))}static{this.PARAMETER_INDEX=new U(sf.PARAMETER_INDEX_NAME,I.ofInteger(sf.PARAMETER_INDEX_NAME))}static{this.PARAMETER_SECOND_INDEX=new U(sf.PARAMETER_SECOND_INDEX_NAME,I.ofInteger(sf.PARAMETER_SECOND_INDEX_NAME))}static{this.PARAMETER_SEARCH_STRING=new U(sf.PARAMETER_SEARCH_STRING_NAME,I.ofString(sf.PARAMETER_STRING_NAME))}static{this.EVENT_STRING=new G(G.OUTPUT,v.of(sf.EVENT_RESULT_NAME,I.ofString(sf.EVENT_RESULT_NAME)))}static{this.EVENT_BOOLEAN=new G(G.OUTPUT,v.of(sf.EVENT_RESULT_NAME,I.ofBoolean(sf.EVENT_RESULT_NAME)))}static{this.EVENT_INT=new G(G.OUTPUT,v.of(sf.EVENT_RESULT_NAME,I.ofInteger(sf.EVENT_RESULT_NAME)))}static{this.EVENT_ARRAY=new G(G.OUTPUT,v.of(sf.EVENT_RESULT_NAME,I.ofArray(sf.EVENT_RESULT_NAME)))}constructor(e,t,r,...s){super();let n=new Map;s.forEach(e=>n.set(e.getParameterName(),e)),this.signature=new Y(t).setNamespace(e).setParameters(n).setEvents(v.of(r.getName(),r))}getSignature(){return this.signature}static ofEntryStringStringAndBooleanOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME),s=e?.getArguments()?.get(sf.PARAMETER_SEARCH_STRING_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r,s)))])}}(A.STRING,e,sf.EVENT_BOOLEAN,sf.PARAMETER_STRING,sf.PARAMETER_SEARCH_STRING)]}static ofEntryStringIntegerAndStringOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME),s=e?.getArguments()?.get(sf.PARAMETER_INDEX_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r,s)))])}}(A.STRING,e,sf.EVENT_STRING,sf.PARAMETER_STRING,sf.PARAMETER_INDEX)]}static ofEntryStringStringAndIntegerOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME),s=e?.getArguments()?.get(sf.PARAMETER_SEARCH_STRING_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r,s)))])}}(A.STRING,e,sf.EVENT_INT,sf.PARAMETER_STRING,sf.PARAMETER_SEARCH_STRING)]}static ofEntryStringAndStringOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r)))])}}(A.STRING,e,sf.EVENT_STRING,sf.PARAMETER_STRING)]}static ofEntryStringAndBooleanOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r)))])}}(A.STRING,e,sf.EVENT_BOOLEAN,sf.PARAMETER_STRING)]}static ofEntryStringStringIntegerAndIntegerOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME),s=e?.getArguments()?.get(sf.PARAMETER_SEARCH_STRING_NAME),n=e?.getArguments()?.get(sf.PARAMETER_INDEX_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r,s,n)))])}}(A.STRING,e,sf.EVENT_INT,sf.PARAMETER_STRING,sf.PARAMETER_SEARCH_STRING,sf.PARAMETER_INDEX)]}static ofEntryStringIntegerIntegerAndStringOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME),s=e?.getArguments()?.get(sf.PARAMETER_INDEX_NAME),n=e?.getArguments()?.get(sf.PARAMETER_SECOND_INDEX_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r,s,n)))])}}(A.STRING,e,sf.EVENT_STRING,sf.PARAMETER_STRING,sf.PARAMETER_INDEX,sf.PARAMETER_SECOND_INDEX)]}static ofEntryStringStringStringAndStringOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME),s=e?.getArguments()?.get(sf.PARAMETER_SECOND_STRING_NAME),n=e?.getArguments()?.get(sf.PARAMETER_THIRD_STRING_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r,s,n)))])}}(A.STRING,e,sf.EVENT_STRING,sf.PARAMETER_STRING,sf.PARAMETER_SECOND_STRING,sf.PARAMETER_THIRD_STRING)]}static ofEntryStringAndIntegerOutput(e,t){return[e,new class extends sf{async internalExecute(e){let r=e?.getArguments()?.get(sf.PARAMETER_STRING_NAME);return new B([$.outputOf(v.of(sf.EVENT_RESULT_NAME,t(r)))])}}(A.STRING,e,sf.EVENT_INT,sf.PARAMETER_STRING)]}}class sN extends eN{static{this.VALUE="value"}constructor(){super(),this.signature=new Y("Concatenate").setNamespace(A.STRING).setParameters(new Map([[sN.VALUE,new U(sN.VALUE,new I().setName(sN.VALUE).setType(new R(c.STRING))).setVariableArgument(!0)]])).setEvents(new Map([G.outputEventMapEntry(new Map([[sN.VALUE,I.ofString(sN.VALUE)]]))]))}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(sN.VALUE),r="";return t.reduce((e,t)=>r=e+t,r),new B([$.outputOf(new Map([[sN.VALUE,r]]))])}}class s_ extends eN{static{this.PARAMETER_STRING_NAME="string"}static{this.PARAMETER_AT_START_NAME="startPosition"}static{this.PARAMETER_AT_END_NAME="endPosition"}static{this.EVENT_RESULT_NAME="result"}constructor(){super(),this.PARAMETER_STRING=new U(s_.PARAMETER_STRING_NAME,I.ofString(s_.PARAMETER_STRING_NAME)),this.PARAMETER_AT_START=new U(s_.PARAMETER_AT_START_NAME,I.ofInteger(s_.PARAMETER_AT_START_NAME)),this.PARAMETER_AT_END=new U(s_.PARAMETER_AT_END_NAME,I.ofInteger(s_.PARAMETER_AT_END_NAME)),this.EVENT_STRING=new G(G.OUTPUT,new Map([[s_.EVENT_RESULT_NAME,I.ofString(s_.EVENT_RESULT_NAME)]])),this.signature=new Y("DeleteForGivenLength").setNamespace(A.STRING).setParameters(new Map([[this.PARAMETER_STRING.getParameterName(),this.PARAMETER_STRING],[this.PARAMETER_AT_START.getParameterName(),this.PARAMETER_AT_START],[this.PARAMETER_AT_END.getParameterName(),this.PARAMETER_AT_END]])).setEvents(new Map([[this.EVENT_STRING.getName(),this.EVENT_STRING]]))}getSignature(){return this.signature}async internalExecute(e){let t=e?.getArguments()?.get(s_.PARAMETER_STRING_NAME),r=e?.getArguments()?.get(s_.PARAMETER_AT_START_NAME),s=e?.getArguments()?.get(s_.PARAMETER_AT_END_NAME);if(s>=r){let e="";return e+=t.substring(0,r),e+=t.substring(s),new B([$.outputOf(new Map([[s_.EVENT_RESULT_NAME,e.toString()]]))])}return new B([$.outputOf(new Map([[s_.EVENT_RESULT_NAME,t]]))])}}class sM extends eN{static{this.PARAMETER_STRING_NAME="string"}static{this.PARAMETER_AT_POSITION_NAME="position"}static{this.PARAMETER_INSERT_STRING_NAME="insertString"}getSignature(){return this.signature}async internalExecute(e){let t=e?.getArguments()?.get(sM.PARAMETER_STRING_NAME),r=e?.getArguments()?.get(sM.PARAMETER_AT_POSITION_NAME),s=e?.getArguments()?.get(sM.PARAMETER_INSERT_STRING_NAME),n="";return n+=t.substring(0,r),n+=s,n+=t.substring(r),new B([$.outputOf(new Map([[this.EVENT_RESULT_NAME,n]]))])}constructor(...e){super(...e),this.EVENT_RESULT_NAME="result",this.PARAMETER_STRING=new U(sM.PARAMETER_STRING_NAME,I.ofString(sM.PARAMETER_STRING_NAME)),this.PARAMETER_AT_POSITION=new U(sM.PARAMETER_AT_POSITION_NAME,I.ofInteger(sM.PARAMETER_AT_POSITION_NAME)),this.PARAMETER_INSERT_STRING=new U(sM.PARAMETER_INSERT_STRING_NAME,I.ofString(sM.PARAMETER_INSERT_STRING_NAME)),this.EVENT_STRING=new G(G.OUTPUT,new Map([[this.EVENT_RESULT_NAME,I.ofString(this.EVENT_RESULT_NAME)]])),this.signature=new Y("InsertAtGivenPosition").setNamespace(A.STRING).setParameters(new Map([[this.PARAMETER_STRING.getParameterName(),this.PARAMETER_STRING],[this.PARAMETER_AT_POSITION.getParameterName(),this.PARAMETER_AT_POSITION],[this.PARAMETER_INSERT_STRING.getParameterName(),this.PARAMETER_INSERT_STRING]])).setEvents(new Map([G.outputEventMapEntry(new Map([[this.EVENT_RESULT_NAME,I.ofString(this.EVENT_RESULT_NAME)]]))]))}}class sS extends eN{static{this.PARAMETER_REGEX_NAME="regex"}static{this.PARAMETER_STRING_NAME="string"}static{this.EVENT_RESULT_NAME="result"}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(sS.PARAMETER_REGEX_NAME),r=e.getArguments()?.get(sS.PARAMETER_STRING_NAME);return new B([$.outputOf(new Map([[sS.EVENT_RESULT_NAME,!!r.match(t)?.length]]))])}constructor(...e){super(...e),this.signature=new Y("Matches").setNamespace(A.STRING).setParameters(v.ofEntries(v.entry(...U.ofEntry(sS.PARAMETER_REGEX_NAME,I.ofString(sS.PARAMETER_REGEX_NAME))),v.entry(...U.ofEntry(sS.PARAMETER_STRING_NAME,I.ofString(sS.PARAMETER_STRING_NAME))))).setEvents(v.ofEntries(v.entry(...G.outputEventMapEntry(new Map([[sS.EVENT_RESULT_NAME,I.ofBoolean(sS.EVENT_RESULT_NAME)]])))))}}class sO extends eN{static{this.PARAMETER_STRING_NAME="string"}static{this.PARAMETER_POSTPAD_STRING_NAME="postpadString"}static{this.PARAMETER_LENGTH_NAME="length"}static{this.EVENT_RESULT_NAME="result"}static{this.PARAMETER_STRING=new U(sO.PARAMETER_STRING_NAME,I.ofString(sO.PARAMETER_STRING_NAME))}static{this.PARAMETER_POSTPAD_STRING=new U(sO.PARAMETER_POSTPAD_STRING_NAME,I.ofString(sO.PARAMETER_POSTPAD_STRING_NAME))}static{this.PARAMETER_LENGTH=new U(sO.PARAMETER_LENGTH_NAME,I.ofInteger(sO.PARAMETER_LENGTH_NAME))}static{this.EVENT_STRING=new G(G.OUTPUT,new Map([[sO.EVENT_RESULT_NAME,I.ofString(sO.EVENT_RESULT_NAME)]]))}constructor(){super(),this.signature=new Y("PostPad").setNamespace(A.STRING).setParameters(new Map([[sO.PARAMETER_STRING.getParameterName(),sO.PARAMETER_STRING],[sO.PARAMETER_POSTPAD_STRING.getParameterName(),sO.PARAMETER_POSTPAD_STRING],[sO.PARAMETER_LENGTH.getParameterName(),sO.PARAMETER_LENGTH]])).setEvents(new Map([[sO.EVENT_STRING.getName(),sO.EVENT_STRING]]))}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(sO.PARAMETER_STRING_NAME),r=e?.getArguments()?.get(sO.PARAMETER_POSTPAD_STRING_NAME),s=e.getArguments()?.get(sO.PARAMETER_LENGTH_NAME),n="",a=r.length;for(n+=t;a<=s;)n+=r,a+=r.length;return n.length-t.length<s&&(n+=r.substring(0,s-(n.length-t.length))),new B([$.outputOf(new Map([[sO.EVENT_RESULT_NAME,n.toString()]]))])}}class sd extends eN{static{this.PARAMETER_STRING_NAME="string"}static{this.PARAMETER_PREPAD_STRING_NAME="prepadString"}static{this.PARAMETER_LENGTH_NAME="length"}static{this.EVENT_RESULT_NAME="result"}static{this.PARAMETER_STRING=new U(sd.PARAMETER_STRING_NAME,I.ofString(sd.PARAMETER_STRING_NAME))}static{this.PARAMETER_PREPAD_STRING=new U(sd.PARAMETER_PREPAD_STRING_NAME,I.ofString(sd.PARAMETER_PREPAD_STRING_NAME))}static{this.PARAMETER_LENGTH=new U(sd.PARAMETER_LENGTH_NAME,I.ofInteger(sd.PARAMETER_LENGTH_NAME))}static{this.EVENT_STRING=new G(G.OUTPUT,new Map([[sd.EVENT_RESULT_NAME,I.ofString(sd.EVENT_RESULT_NAME)]]))}getSignature(){return this.signature}constructor(){super(),this.signature=new Y("PrePad").setNamespace(A.STRING).setParameters(new Map([[sd.PARAMETER_STRING.getParameterName(),sd.PARAMETER_STRING],[sd.PARAMETER_PREPAD_STRING.getParameterName(),sd.PARAMETER_PREPAD_STRING],[sd.PARAMETER_LENGTH.getParameterName(),sd.PARAMETER_LENGTH]])).setEvents(new Map([[sd.EVENT_STRING.getName(),sd.EVENT_STRING]]))}async internalExecute(e){let t=e.getArguments()?.get(sd.PARAMETER_STRING_NAME),r=e.getArguments()?.get(sd.PARAMETER_PREPAD_STRING_NAME),s=e.getArguments()?.get(sd.PARAMETER_LENGTH_NAME),n="",a=r.length;for(;a<=s;)n+=r,a+=r.length;return n.length<s&&(n+=r.substring(0,s-n.length)),n+=t,new B([$.outputOf(new Map([[sd.EVENT_RESULT_NAME,n]]))])}}class sw extends eN{static{this.PARAMETER_STRING_NAME="string"}static{this.PARAMETER_BOOLEAN_NAME="boolean"}static{this.PARAMETER_FIRST_OFFSET_NAME="firstOffset"}static{this.PARAMETER_OTHER_STRING_NAME="otherString"}static{this.PARAMETER_SECOND_OFFSET_NAME="secondOffset"}static{this.PARAMETER_INTEGER_NAME="length"}static{this.EVENT_RESULT_NAME="result"}static{this.PARAMETER_STRING=new U(sw.PARAMETER_STRING_NAME,I.ofString(sw.PARAMETER_STRING_NAME))}static{this.PARAMETER_OTHER_STRING=new U(sw.PARAMETER_OTHER_STRING_NAME,I.ofString(sw.PARAMETER_OTHER_STRING_NAME))}static{this.PARAMETER_FIRST_OFFSET=new U(sw.PARAMETER_FIRST_OFFSET_NAME,I.ofInteger(sw.PARAMETER_FIRST_OFFSET_NAME))}static{this.PARAMETER_SECOND_OFFSET=new U(sw.PARAMETER_SECOND_OFFSET_NAME,I.ofInteger(sw.PARAMETER_SECOND_OFFSET_NAME))}static{this.PARAMETER_INTEGER=new U(sw.PARAMETER_INTEGER_NAME,I.ofInteger(sw.PARAMETER_INTEGER_NAME))}static{this.PARAMETER_BOOLEAN=new U(sw.PARAMETER_BOOLEAN_NAME,I.ofBoolean(sw.PARAMETER_BOOLEAN_NAME))}static{this.EVENT_BOOLEAN=new G(G.OUTPUT,new Map([[sw.EVENT_RESULT_NAME,I.ofBoolean(sw.EVENT_RESULT_NAME)]]))}getSignature(){return this.signature}constructor(){super(),this.signature=new Y("RegionMatches").setNamespace(A.STRING).setParameters(new Map([[sw.PARAMETER_STRING.getParameterName(),sw.PARAMETER_STRING],[sw.PARAMETER_BOOLEAN.getParameterName(),sw.PARAMETER_BOOLEAN],[sw.PARAMETER_FIRST_OFFSET.getParameterName(),sw.PARAMETER_FIRST_OFFSET],[sw.PARAMETER_OTHER_STRING.getParameterName(),sw.PARAMETER_OTHER_STRING],[sw.PARAMETER_SECOND_OFFSET.getParameterName(),sw.PARAMETER_SECOND_OFFSET],[sw.PARAMETER_INTEGER.getParameterName(),sw.PARAMETER_INTEGER]])).setEvents(new Map([[sw.EVENT_BOOLEAN.getName(),sw.EVENT_BOOLEAN]]))}async internalExecute(e){let t=e.getArguments()?.get(sw.PARAMETER_STRING_NAME),r=e.getArguments()?.get(sw.PARAMETER_BOOLEAN_NAME),s=e.getArguments()?.get(sw.PARAMETER_FIRST_OFFSET_NAME),n=e?.getArguments()?.get(sw.PARAMETER_OTHER_STRING_NAME),a=e?.getArguments()?.get(sw.PARAMETER_SECOND_OFFSET_NAME),i=e.getArguments()?.get(sw.PARAMETER_INTEGER_NAME),o=!1;return o=!(s<0)&&!(a<0)&&!(s+i>t.length)&&!(a+i>n.length)&&(r?(t=t.substring(s,s+i).toUpperCase())==n.substring(a,a+i).toUpperCase():(t=t.substring(s,s+i))==n.substring(a,i)),new B([$.outputOf(new Map([[sw.EVENT_RESULT_NAME,o]]))])}}class sP extends eN{static{this.PARAMETER_STRING_NAME="string"}static{this.PARAMETER_AT_START_NAME="startPosition"}static{this.PARAMETER_AT_LENGTH_NAME="lengthPosition"}static{this.PARAMETER_REPLACE_STRING_NAME="replaceString"}static{this.EVENT_RESULT_NAME="result"}static{this.PARAMETER_STRING=new U(sP.PARAMETER_STRING_NAME,I.ofString(sP.PARAMETER_STRING_NAME))}static{this.PARAMETER_AT_START=new U(sP.PARAMETER_AT_START_NAME,I.ofInteger(sP.PARAMETER_AT_START_NAME))}static{this.PARAMETER_AT_LENGTH=new U(sP.PARAMETER_AT_LENGTH_NAME,I.ofInteger(sP.PARAMETER_AT_LENGTH_NAME))}static{this.PARAMETER_REPLACE_STRING=new U(sP.PARAMETER_REPLACE_STRING_NAME,I.ofString(sP.PARAMETER_REPLACE_STRING_NAME))}static{this.EVENT_STRING=new G(G.OUTPUT,new Map([[sP.EVENT_RESULT_NAME,I.ofString(sP.EVENT_RESULT_NAME)]]))}constructor(){super(),this.signature=new Y("ReplaceAtGivenPosition").setNamespace(A.STRING).setParameters(new Map([[sP.PARAMETER_STRING.getParameterName(),sP.PARAMETER_STRING],[sP.PARAMETER_AT_START.getParameterName(),sP.PARAMETER_AT_START],[sP.PARAMETER_AT_LENGTH.getParameterName(),sP.PARAMETER_AT_LENGTH],[sP.PARAMETER_REPLACE_STRING.getParameterName(),sP.PARAMETER_REPLACE_STRING]])).setEvents(new Map([[sP.EVENT_STRING.getName(),sP.EVENT_STRING]]))}getSignature(){return this.signature}async internalExecute(e){let t=e?.getArguments()?.get(sP.PARAMETER_STRING_NAME),r=e?.getArguments()?.get(sP.PARAMETER_AT_START_NAME),s=e?.getArguments()?.get(sP.PARAMETER_AT_LENGTH_NAME),n=e?.getArguments()?.get(sP.PARAMETER_REPLACE_STRING_NAME);if(t.length,r<s){let e="";e+=t.substring(0,r),e+=n,e+=t.substring(r+s)}return new B([$.outputOf(new Map([[sP.EVENT_RESULT_NAME,t]]))])}}class sI extends eN{constructor(){super(),this.VALUE="value",this.signature=new Y("Reverse").setNamespace(A.STRING).setParameters(new Map([[this.VALUE,new U(this.VALUE,I.ofString(this.VALUE)).setVariableArgument(!1)]])).setEvents(new Map([G.outputEventMapEntry(new Map([[this.VALUE,new I().setType(p.of(c.STRING)).setName(this.VALUE)]]))]))}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(this.VALUE),r=t.length-1,s="";for(;r>=0;)s+=t.charAt(r--);return new B([$.outputOf(v.of(this.VALUE,s))])}}class sy extends eN{getSignature(){return this.signature}constructor(){super(),this.PARAMETER_STRING_NAME="string",this.PARAMETER_SPLIT_STRING_NAME="searchString",this.EVENT_RESULT_NAME="result",this.PARAMETER_STRING=new U(this.PARAMETER_STRING_NAME,I.ofString(this.PARAMETER_STRING_NAME)),this.PARAMETER_SPLIT_STRING=new U(this.PARAMETER_SPLIT_STRING_NAME,I.ofString(this.PARAMETER_SPLIT_STRING_NAME)),this.EVENT_ARRAY=new G(G.OUTPUT,v.of(this.EVENT_RESULT_NAME,I.ofArray(this.EVENT_RESULT_NAME))),this.signature=new Y("Split").setNamespace(A.STRING).setParameters(new Map([[this.PARAMETER_STRING_NAME,this.PARAMETER_STRING],[this.PARAMETER_SPLIT_STRING_NAME,this.PARAMETER_SPLIT_STRING]])).setEvents(new Map([G.outputEventMapEntry(new Map([[this.EVENT_RESULT_NAME,I.ofArray(this.EVENT_RESULT_NAME)]]))]))}async internalExecute(e){let t=e.getArguments()?.get(this.PARAMETER_STRING_NAME),r=e.getArguments()?.get(this.PARAMETER_SPLIT_STRING_NAME);return new B([$.outputOf(v.of(this.EVENT_RESULT_NAME,t.split(r)))])}}class sx extends eN{getSignature(){return this.signature}constructor(){super(),this.PARAMETER_INPUT_ANYTYPE_NAME="anytype",this.EVENT_RESULT_NAME="result",this.PARAMETER_INPUT_ANYTYPE=new U(this.PARAMETER_INPUT_ANYTYPE_NAME,I.ofAny(this.PARAMETER_INPUT_ANYTYPE_NAME)),this.EVENT_STRING=new G(G.OUTPUT,new Map([[this.EVENT_RESULT_NAME,I.ofString(this.EVENT_RESULT_NAME)]])),this.signature=new Y("ToString").setNamespace(A.STRING).setParameters(new Map([[this.PARAMETER_INPUT_ANYTYPE.getParameterName(),this.PARAMETER_INPUT_ANYTYPE]])).setEvents(new Map([[this.EVENT_STRING.getName(),this.EVENT_STRING]]))}async internalExecute(e){let t=e.getArguments()?.get(this.PARAMETER_INPUT_ANYTYPE_NAME),r="";return r="object"==typeof t?JSON.stringify(t,void 0,2):""+t,new B([$.outputOf(new Map([[this.EVENT_RESULT_NAME,r]]))])}}class sL extends eN{static{this.PARAMETER_STRING_NAME="string"}static{this.PARAMETER_LENGTH_NAME="length"}static{this.EVENT_RESULT_NAME="result"}static{this.PARAMETER_STRING=new U(sL.PARAMETER_STRING_NAME,I.ofString(sL.PARAMETER_STRING_NAME))}static{this.PARAMETER_LENGTH=new U(sL.PARAMETER_LENGTH_NAME,I.ofInteger(sL.PARAMETER_LENGTH_NAME))}static{this.EVENT_STRING=new G(G.OUTPUT,new Map([[sL.EVENT_RESULT_NAME,I.ofString(sL.EVENT_RESULT_NAME)]]))}getSignature(){return this.signature}constructor(){super(),this.signature=new Y("TrimTo").setNamespace(A.STRING).setParameters(new Map([[sL.PARAMETER_STRING.getParameterName(),sL.PARAMETER_STRING],[sL.PARAMETER_LENGTH.getParameterName(),sL.PARAMETER_LENGTH]])).setEvents(new Map([[sL.EVENT_STRING.getName(),sL.EVENT_STRING]]))}async internalExecute(e){let t=e.getArguments()?.get(sL.PARAMETER_STRING_NAME),r=e.getArguments()?.get(sL.PARAMETER_LENGTH_NAME);return new B([$.outputOf(new Map([[sL.EVENT_RESULT_NAME,t.substring(0,r)]]))])}}class sU{async find(e,t){return e!=A.STRING?Promise.resolve(void 0):Promise.resolve(this.repoMap.get(t))}async filter(e){return Promise.resolve(this.filterableNames.filter(t=>-1!==t.toLowerCase().indexOf(e.toLowerCase())))}constructor(){this.repoMap=v.ofArrayEntries(sf.ofEntryStringAndStringOutput("Trim",e=>e.trim()),sf.ofEntryStringAndStringOutput("TrimStart",e=>e.trimStart()),sf.ofEntryStringAndStringOutput("TrimEnd",e=>e.trimEnd()),sf.ofEntryStringAndIntegerOutput("Length",e=>e.length),sf.ofEntryStringStringAndIntegerOutput("Frequency",(e,t)=>{let r=0,s=e.indexOf(t);for(;-1!=s;)r++,s=e.indexOf(t,s+1);return r}),sf.ofEntryStringAndStringOutput("LowerCase",e=>e.toLocaleLowerCase()),sf.ofEntryStringAndStringOutput("UpperCase",e=>e.toUpperCase()),sf.ofEntryStringAndBooleanOutput("IsBlank",e=>""===e.trim()),sf.ofEntryStringAndBooleanOutput("IsEmpty",e=>""===e),sf.ofEntryStringStringAndBooleanOutput("Contains",(e,t)=>-1!=e.indexOf(t)),sf.ofEntryStringStringAndBooleanOutput("EndsWith",(e,t)=>e.endsWith(t)),sf.ofEntryStringStringAndBooleanOutput("StartsWith",(e,t)=>e.startsWith(t)),sf.ofEntryStringStringAndBooleanOutput("EqualsIgnoreCase",(e,t)=>e.toUpperCase()==t.toUpperCase()),sf.ofEntryStringStringAndBooleanOutput("Matches",(e,t)=>new RegExp(t).test(e)),sf.ofEntryStringStringAndIntegerOutput("IndexOf",(e,t)=>e.indexOf(t)),sf.ofEntryStringStringAndIntegerOutput("LastIndexOf",(e,t)=>e.lastIndexOf(t)),sf.ofEntryStringIntegerAndStringOutput("Repeat",(e,t)=>e.repeat(t)),sf.ofEntryStringStringIntegerAndIntegerOutput("IndexOfWithStartPoint",(e,t,r)=>e.indexOf(t,r)),sf.ofEntryStringStringIntegerAndIntegerOutput("LastIndexOfWithStartPoint",(e,t,r)=>e.lastIndexOf(t,r)),sf.ofEntryStringStringStringAndStringOutput("Replace",(e,t,r)=>e.replaceAll(t,r)),sf.ofEntryStringStringStringAndStringOutput("ReplaceFirst",(e,t,r)=>e.replace(t,r)),sf.ofEntryStringIntegerIntegerAndStringOutput("SubString",(e,t,r)=>e.substring(t,r)),D(new sN),D(new s_),D(new sM),D(new sO),D(new sd),D(new sw),D(new sP),D(new sI),D(new sy),D(new sx),D(new sL),D(new sS)),this.filterableNames=Array.from(this.repoMap.values()).map(e=>e.getSignature().getFullName())}}class sb extends eN{static{this.PARAMETER_TIMESTAMP_NAME="isoTimeStamp"}static{this.PARAMETER_TIMESTAMP_NAME_ONE="isoTimeStamp1"}static{this.PARAMETER_TIMESTAMP_NAME_TWO="isoTimeStamp2"}static{this.PARAMETER_UNIT_NAME="unit"}static{this.PARAMETER_NUMBER_NAME="number"}static{this.PARAMETER_TIMESTAMP=new U(sb.PARAMETER_TIMESTAMP_NAME,I.ofRef(A.DATE+".Timestamp"))}static{this.PARAMETER_TIMESTAMP_ONE=new U(sb.PARAMETER_TIMESTAMP_NAME_ONE,I.ofRef(A.DATE+".Timestamp"))}static{this.PARAMETER_TIMESTAMP_TWO=new U(sb.PARAMETER_TIMESTAMP_NAME_TWO,I.ofRef(A.DATE+".Timestamp"))}static{this.PARAMETER_VARIABLE_UNIT=new U(sb.PARAMETER_UNIT_NAME,I.ofRef(A.DATE+".Timeunit")).setVariableArgument(!0)}static{this.PARAMETER_UNIT=new U(sb.PARAMETER_UNIT_NAME,I.ofRef(A.DATE+".Timeunit"))}static{this.PARAMETER_NUMBER=new U(sb.PARAMETER_NUMBER_NAME,I.ofInteger(sb.PARAMETER_NUMBER_NAME))}static{this.EVENT_RESULT_NAME="result"}static{this.EVENT_TIMESTAMP_NAME="isoTimeStamp"}static{this.EVENT_INT=new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofInteger(sb.EVENT_RESULT_NAME)))}static{this.EVENT_STRING=new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofString(sb.EVENT_RESULT_NAME)))}static{this.EVENT_LONG=new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofLong(sb.EVENT_RESULT_NAME)))}static{this.EVENT_BOOLEAN=new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofBoolean(sb.EVENT_RESULT_NAME)))}static{this.EVENT_TIMESTAMP=new G(G.OUTPUT,v.of(sb.EVENT_TIMESTAMP_NAME,I.ofRef(A.DATE+".Timestamp")))}getSignature(){return this.signature}constructor(e,t,...r){if(super(),this.signature=new Y(e).setNamespace(A.DATE).setEvents(v.of(t.getName(),t)),!r?.length)return;let s=new Map;r.forEach(e=>s.set(e.getParameterName(),e)),this.signature.setParameters(s)}static ofEntryTimestampAndIntegerOutput(e,t){return[e,new class extends sb{async internalExecute(e){return new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,t(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME))))])}}(e,sb.EVENT_INT,sb.PARAMETER_TIMESTAMP)]}static ofEntryTimestampAndBooleanOutput(e,t){return[e,new class extends sb{async internalExecute(e){return new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,t(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME))))])}}(e,sb.EVENT_BOOLEAN,sb.PARAMETER_TIMESTAMP)]}static ofEntryTimestampAndStringOutput(e,t){return[e,new class extends sb{async internalExecute(e){return new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,t(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME))))])}}(e,sb.EVENT_STRING,sb.PARAMETER_TIMESTAMP)]}static ofEntryTimestampIntegerAndTimestampOutput(e,t){return[e,new class extends sb{async internalExecute(e){return new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,t(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME),e.getArguments()?.get(sb.PARAMETER_NUMBER_NAME))))])}}(e,sb.EVENT_TIMESTAMP,sb.PARAMETER_TIMESTAMP,sb.PARAMETER_NUMBER)]}static ofEntryTimestampTimestampAndTOutput(e,t,r,...s){return[e,new class extends sb{async internalExecute(e){let t=[];return s?.length&&t.push(...s.map(t=>e.getArguments()?.get(t.getParameterName()))),new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,r(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME_ONE),e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME_TWO),t)))])}}(e,t,sb.PARAMETER_TIMESTAMP_ONE,sb.PARAMETER_TIMESTAMP_TWO,...s)]}}function sv(t){let r=e.fromISO(t,{setZone:!0});if(!r?.isValid)throw Error("Invalid ISO timestamp");return r}class sV extends sb{static{this.PARAMETER_YEARS_NAME="years"}static{this.PARAMETER_MONTHS_NAME="months"}static{this.PARAMETER_DAYS_NAME="days"}static{this.PARAMETER_HOURS_NAME="hours"}static{this.PARAMETER_MINUTES_NAME="minutes"}static{this.PARAMETER_SECONDS_NAME="seconds"}static{this.PARAMETER_MILLISECONDS_NAME="milliseconds"}constructor(e){super(e?"AddTime":"SubtractTime",sb.EVENT_TIMESTAMP,sb.PARAMETER_TIMESTAMP,U.of(sV.PARAMETER_YEARS_NAME,I.ofNumber(sV.PARAMETER_YEARS_NAME).setDefaultValue(0)),U.of(sV.PARAMETER_MONTHS_NAME,I.ofNumber(sV.PARAMETER_MONTHS_NAME).setDefaultValue(0)),U.of(sV.PARAMETER_DAYS_NAME,I.ofNumber(sV.PARAMETER_DAYS_NAME).setDefaultValue(0)),U.of(sV.PARAMETER_HOURS_NAME,I.ofNumber(sV.PARAMETER_HOURS_NAME).setDefaultValue(0)),U.of(sV.PARAMETER_MINUTES_NAME,I.ofNumber(sV.PARAMETER_MINUTES_NAME).setDefaultValue(0)),U.of(sV.PARAMETER_SECONDS_NAME,I.ofNumber(sV.PARAMETER_SECONDS_NAME).setDefaultValue(0)),U.of(sV.PARAMETER_MILLISECONDS_NAME,I.ofNumber(sV.PARAMETER_MILLISECONDS_NAME).setDefaultValue(0))),this.isAdd=e}async internalExecute(e){let t,r=sv(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME)),s=e.getArguments()?.get(sV.PARAMETER_YEARS_NAME),n=e.getArguments()?.get(sV.PARAMETER_MONTHS_NAME),a=e.getArguments()?.get(sV.PARAMETER_DAYS_NAME),i=e.getArguments()?.get(sV.PARAMETER_HOURS_NAME),o=e.getArguments()?.get(sV.PARAMETER_MINUTES_NAME),E={years:s,months:n,days:a,hours:i,minutes:o,seconds:e.getArguments()?.get(sV.PARAMETER_SECONDS_NAME),milliseconds:e.getArguments()?.get(sV.PARAMETER_MILLISECONDS_NAME)};return t=this.isAdd?r.plus(E):r.minus(E),new B([$.outputOf(v.of(sb.EVENT_TIMESTAMP_NAME,t.toISO()))])}}class sC extends eN{constructor(e,t){super(),this.paramName=`epoch${t?"Seconds":"Milliseconds"}`,this.isSeconds=t,this.signature=new Y(e).setNamespace(A.DATE).setParameters(new Map([[this.paramName,U.of(this.paramName,new I().setName(this.paramName).setType(p.of(c.LONG,c.INTEGER,c.STRING)))]])).setEvents(new Map([[sb.EVENT_TIMESTAMP.getName(),sb.EVENT_TIMESTAMP]]))}getSignature(){return this.signature}internalExecute(e){let t=parseInt(e.getArguments()?.get(this.paramName)),r=this.isSeconds?1e3*t:t;if(isNaN(r))throw Error(`Please provide a valid value for ${this.paramName}.`);return Promise.resolve(new B([$.outputOf(v.of(sb.EVENT_TIMESTAMP_NAME,new Date(r).toISOString()))]))}}class sD extends eN{constructor(e,t){super(),this.isSeconds=t,this.signature=new Y(e).setNamespace(A.DATE).setParameters(new Map([[sb.PARAMETER_TIMESTAMP_NAME,sb.PARAMETER_TIMESTAMP]])).setEvents(new Map([[sb.EVENT_TIMESTAMP.getName(),sb.EVENT_LONG]]))}getSignature(){return this.signature}internalExecute(t){let r=t.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME),s=this.isSeconds?e.fromISO(r).toSeconds():e.fromISO(r).toMillis();return Promise.resolve(new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,s))]))}}class sG extends sb{static{this.PARAMETER_FORMAT_NAME="format"}static{this.PARAMETER_LOCALE_NAME="locale"}constructor(){super("ToDateString",sb.EVENT_STRING,sb.PARAMETER_TIMESTAMP,U.of(sG.PARAMETER_FORMAT_NAME,I.ofString(sG.PARAMETER_FORMAT_NAME)),U.of(sG.PARAMETER_LOCALE_NAME,I.ofString(sG.PARAMETER_LOCALE_NAME).setDefaultValue("")))}async internalExecute(e){let t=sv(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME)),r=e.getArguments()?.get(sG.PARAMETER_FORMAT_NAME),s=e.getArguments()?.get(sG.PARAMETER_LOCALE_NAME);return""===s&&(s="system"),new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,t.toFormat(r,{locale:s})))])}}class s$ extends sb{static{this.PARAMETER_TIMEZONE_NAME="timezone"}constructor(){super("SetTimeZone",sb.EVENT_TIMESTAMP,sb.PARAMETER_TIMESTAMP,U.of(s$.PARAMETER_TIMEZONE_NAME,I.ofString(s$.PARAMETER_TIMEZONE_NAME)))}async internalExecute(e){let t=sv(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME)),r=e.getArguments()?.get(s$.PARAMETER_TIMEZONE_NAME);return new B([$.outputOf(v.of(sb.EVENT_TIMESTAMP_NAME,t.setZone(r).toISO()))])}}class sF extends sb{static{this.PARAMETER_START_TIMESTAMP_NAME="startTimestamp"}static{this.PARAMETER_END_TIMESTAMP_NAME="endTimestamp"}static{this.PARAMETER_CHECK_TIMESTAMP_NAME="checkTimestamp"}constructor(){super("IsBetween",sF.EVENT_BOOLEAN,U.of(sF.PARAMETER_START_TIMESTAMP_NAME,I.ofRef(A.DATE+".Timestamp")),U.of(sF.PARAMETER_END_TIMESTAMP_NAME,I.ofRef(A.DATE+".Timestamp")),U.of(sF.PARAMETER_CHECK_TIMESTAMP_NAME,I.ofRef(A.DATE+".Timestamp")))}async internalExecute(e){let t=e.getArguments()?.get(sF.PARAMETER_START_TIMESTAMP_NAME),r=e.getArguments()?.get(sF.PARAMETER_END_TIMESTAMP_NAME),s=e.getArguments()?.get(sF.PARAMETER_CHECK_TIMESTAMP_NAME),n=sv(t),a=sv(r),i=sv(s);return n>a&&([n,a]=[a,n]),new B([$.outputOf(v.of(sF.EVENT_RESULT_NAME,n<=i&&i<=a))])}}class sB extends eN{constructor(e){super(),this.isLast=e,this.signature=new Y(e?"LastOf":"FirstOf").setNamespace(A.DATE).setParameters(new Map([[sb.PARAMETER_TIMESTAMP_NAME,new U(sb.PARAMETER_TIMESTAMP_NAME,I.ofRef(A.DATE+".Timestamp")).setVariableArgument(!0)]])).setEvents(new Map([[sb.EVENT_TIMESTAMP.getName(),sb.EVENT_TIMESTAMP]]))}getSignature(){return this.signature}internalExecute(e){let t=e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME);if(!t?.length)throw Error("No timestamps provided");let r=t.map(e=>sv(e));return r.sort((e,t)=>e.toMillis()-t.toMillis()),Promise.resolve(new B([$.outputOf(v.of(sb.EVENT_TIMESTAMP_NAME,r[this.isLast?r.length-1:0].toISO()))]))}}class sY extends sb{static{this.EVENT_TIME_OBJECT_NAME="object"}static{this.EVENT_TIME_ARRAY_NAME="array"}constructor(e){super(e?"TimeAsArray":"TimeAsObject",new G(G.OUTPUT,v.of(e?sY.EVENT_TIME_ARRAY_NAME:sY.EVENT_TIME_OBJECT_NAME,e?I.ofArray(sY.EVENT_TIME_ARRAY_NAME,I.ofInteger("timeParts")):I.ofRef(A.DATE+".TimeObject"))),sb.PARAMETER_TIMESTAMP),this.isArray=e}async internalExecute(e){let t=sv(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME)).toObject();return new B([$.outputOf(v.of(this.isArray?sY.EVENT_TIME_ARRAY_NAME:sY.EVENT_TIME_OBJECT_NAME,this.isArray?[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond]:t))])}}class sk extends sb{constructor(e){super(e?"StartOf":"EndOf",sb.EVENT_TIMESTAMP,sb.PARAMETER_TIMESTAMP,sb.PARAMETER_UNIT),this.isStart=e}async internalExecute(e){let t=sv(e.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME)),r=e.getArguments()?.get(sb.PARAMETER_UNIT_NAME)?.toLowerCase();r=r.substring(0,r.length-1);let s=this.isStart?t.startOf(r):t.endOf(r);return new B([$.outputOf(v.of(sb.EVENT_TIMESTAMP_NAME,s.toISO({includeOffset:!0})))])}}class sH extends sb{static{this.EVENT_NAMES_NAME="names"}static{this.PARAMETER_UNIT_NAME="unit"}static{this.PARAMETER_LOCALE_NAME="locale"}constructor(){super("GetNames",new G(sH.EVENT_NAMES_NAME,v.of(sH.EVENT_NAMES_NAME,I.ofArray(sH.EVENT_NAMES_NAME,I.ofString(sH.EVENT_NAMES_NAME)))),new U(sH.PARAMETER_UNIT_NAME,I.ofString(sH.PARAMETER_UNIT_NAME).setEnums(["TIMEZONES","MONTHS","WEEKDAYS"])),new U(sH.PARAMETER_LOCALE_NAME,I.ofString(sH.PARAMETER_LOCALE_NAME).setDefaultValue("system")))}async internalExecute(e){let t=e.getArguments()?.get(sH.PARAMETER_UNIT_NAME),r=e.getArguments()?.get(sH.PARAMETER_LOCALE_NAME);return new B([$.outputOf(v.of(sH.EVENT_NAMES_NAME,this.getNames(t,r)))])}getNames(t,r){return"TIMEZONES"===t?Intl.supportedValuesOf("timeZone"):"MONTHS"===t?[1,2,3,4,5,6,7,8,9,10,11,12].map(t=>e.now().setLocale(r).set({month:t}).toFormat("MMMM")):"WEEKDAYS"===t?[1,2,3,4,5,6,7].map(t=>e.now().setLocale(r).set({month:7,year:2024,day:t}).toFormat("EEEE")):[]}}class sj extends eN{internalExecute(t){let r=t.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME),s=e.fromISO(r);return Promise.resolve(new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,s.isValid))]))}getSignature(){return this.signature}constructor(...e){super(...e),this.signature=new Y("IsValidISODate").setNamespace(A.DATE).setParameters(new Map([U.ofEntry(sb.PARAMETER_TIMESTAMP_NAME,I.ofString(sb.PARAMETER_TIMESTAMP_NAME))])).setEvents(new Map([G.outputEventMapEntry(v.of(sb.EVENT_RESULT_NAME,I.ofBoolean(sb.EVENT_RESULT_NAME)))]))}}class sW extends sb{static{this.PARAMETER_BASE_NAME="base"}static{this.PARAMETER_BASE=new U(sW.PARAMETER_BASE_NAME,I.ofRef(A.DATE+".Timestamp").setDefaultValue(""))}static{this.PARAMETER_LOCALE_NAME="locale"}static{this.PARAMETER_LOCALE=new U(sW.PARAMETER_LOCALE_NAME,I.ofString(sW.PARAMETER_LOCALE_NAME).setDefaultValue("system"))}static{this.PARAMETER_FORMAT_NAME="format"}static{this.PARAMETER_FORMAT=new U(sW.PARAMETER_FORMAT_NAME,I.ofString(sW.PARAMETER_FORMAT_NAME).setEnums(["LONG","SHORT","NARROW"]).setDefaultValue("LONG"))}static{this.PARAMETER_ROUND_NAME="round"}static{this.PARAMETER_ROUND=new U(sW.PARAMETER_ROUND_NAME,I.ofBoolean(sW.PARAMETER_ROUND_NAME).setDefaultValue(!0))}constructor(){super("FromNow",sb.EVENT_STRING,sb.PARAMETER_TIMESTAMP,sW.PARAMETER_FORMAT,sW.PARAMETER_BASE,sb.PARAMETER_VARIABLE_UNIT,sW.PARAMETER_ROUND,sW.PARAMETER_LOCALE)}internalExecute(t){let r=t.getArguments()?.get(sW.PARAMETER_BASE_NAME),s=""===r?e.now():e.fromISO(r),n=t.getArguments()?.get(sb.PARAMETER_TIMESTAMP_NAME),a=e.fromISO(n),i=t.getArguments()?.get(sW.PARAMETER_UNIT_NAME),o=t.getArguments()?.get(sW.PARAMETER_FORMAT_NAME),E=t.getArguments()?.get(sW.PARAMETER_ROUND_NAME),u=t.getArguments()?.get(sW.PARAMETER_LOCALE_NAME),A={base:s,style:o?.toLowerCase(),round:E,locale:u};return i?.length>0&&(A.unit=i.map(e=>e.toLowerCase())),Promise.resolve(new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,a.toRelative(A)??"Unknown"))]))}}class sX extends sb{static{this.PARAMETER_FORMAT_NAME="format"}static{this.PARAMETER_TIMESTAMP_STRING_NAME="timestampString"}constructor(){super("FromDateString",sb.EVENT_TIMESTAMP,U.of(sX.PARAMETER_TIMESTAMP_STRING_NAME,I.ofString(sX.PARAMETER_TIMESTAMP_STRING_NAME)),U.of(sX.PARAMETER_FORMAT_NAME,I.ofString(sX.PARAMETER_FORMAT_NAME)))}async internalExecute(t){let r=t.getArguments()?.get(sX.PARAMETER_TIMESTAMP_STRING_NAME),s=t.getArguments()?.get(sX.PARAMETER_FORMAT_NAME),n=e.fromFormat(r,s);return new B([$.outputOf(v.of(sb.EVENT_RESULT_NAME,n.toISO()))])}}class sJ extends sb{constructor(){super("GetCurrentTimestamp",sb.EVENT_TIMESTAMP)}async internalExecute(t){return new B([$.outputOf(v.of(sb.EVENT_TIMESTAMP_NAME,e.now().toISO()))])}}class sq{find(e,t){return e!=A.DATE?Promise.resolve(void 0):Promise.resolve(this.repoMap.get(t))}filter(e){return Promise.resolve(this.filterableNames.filter(t=>-1!==t.toLowerCase().indexOf(e.toLowerCase())))}constructor(){this.repoMap=v.ofArrayEntries(["EpochSecondsToTimestamp",new sC("EpochSecondsToTimestamp",!0)],["EpochMillisecondsToTimestamp",new sC("EpochMillisecondsToTimestamp",!1)],sb.ofEntryTimestampAndIntegerOutput("GetDay",e=>sv(e).day),sb.ofEntryTimestampAndIntegerOutput("GetDayOfWeek",e=>sv(e).weekday),sb.ofEntryTimestampAndIntegerOutput("GetMonth",e=>sv(e).month),sb.ofEntryTimestampAndIntegerOutput("GetYear",e=>sv(e).year),sb.ofEntryTimestampAndIntegerOutput("GetHours",e=>sv(e).hour),sb.ofEntryTimestampAndIntegerOutput("GetMinutes",e=>sv(e).minute),sb.ofEntryTimestampAndIntegerOutput("GetSeconds",e=>sv(e).second),sb.ofEntryTimestampAndIntegerOutput("GetMilliseconds",e=>sv(e).millisecond),sb.ofEntryTimestampAndIntegerOutput("GetDaysInMonth",e=>sv(e).daysInMonth),sb.ofEntryTimestampAndIntegerOutput("GetDaysInYear",e=>sv(e).daysInYear),["TimestampToEpochSeconds",new sD("TimestampToEpochSeconds",!0)],["TimestampToEpochMilliseconds",new sD("TimestampToEpochMilliseconds",!1)],sb.ofEntryTimestampAndStringOutput("GetTimeZoneName",e=>sv(e).zoneName),sb.ofEntryTimestampAndStringOutput("GetTimeZoneOffsetLong",e=>sv(e).offsetNameLong),sb.ofEntryTimestampAndStringOutput("GetTimeZoneOffsetShort",e=>sv(e).offsetNameShort),sb.ofEntryTimestampAndIntegerOutput("GetTimeZoneOffset",e=>sv(e).offset),["ToDateString",new sG],["AddTime",new sV(!0)],["SubtractTime",new sV(!1)],["GetCurrentTimestamp",new sJ],sb.ofEntryTimestampTimestampAndTOutput("Difference",new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofRef(`${A.DATE}.Duration`))),(e,t,r)=>{let s,n=sv(e),a=sv(t);r?.[0]?.length&&(s=r[0]?.filter(e=>!!e).map(e=>e.toLowerCase()));let i=n.diff(a);return s?.length?i.shiftTo(...s).toObject():i.toObject()},sb.PARAMETER_VARIABLE_UNIT),sb.ofEntryTimestampIntegerAndTimestampOutput("SetDay",(e,t)=>sv(e).set({day:t}).toISO()),sb.ofEntryTimestampIntegerAndTimestampOutput("SetMonth",(e,t)=>sv(e).set({month:t}).toISO()),sb.ofEntryTimestampIntegerAndTimestampOutput("SetYear",(e,t)=>sv(e).set({year:t}).toISO()),sb.ofEntryTimestampIntegerAndTimestampOutput("SetHours",(e,t)=>sv(e).set({hour:t}).toISO()),sb.ofEntryTimestampIntegerAndTimestampOutput("SetMinutes",(e,t)=>sv(e).set({minute:t}).toISO()),sb.ofEntryTimestampIntegerAndTimestampOutput("SetSeconds",(e,t)=>sv(e).set({second:t}).toISO()),sb.ofEntryTimestampIntegerAndTimestampOutput("SetMilliseconds",(e,t)=>sv(e).set({millisecond:t}).toISO()),["SetTimeZone",new s$],sb.ofEntryTimestampTimestampAndTOutput("IsBefore",new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofBoolean(sb.EVENT_RESULT_NAME))),(e,t)=>sv(e)<sv(t)),sb.ofEntryTimestampTimestampAndTOutput("IsAfter",new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofBoolean(sb.EVENT_RESULT_NAME))),(e,t)=>sv(e)>sv(t)),sb.ofEntryTimestampTimestampAndTOutput("IsSame",new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofBoolean(sb.EVENT_RESULT_NAME))),(e,t)=>sv(e)===sv(t)),sb.ofEntryTimestampTimestampAndTOutput("IsSameOrBefore",new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofBoolean(sb.EVENT_RESULT_NAME))),(e,t)=>sv(e)<=sv(t)),sb.ofEntryTimestampTimestampAndTOutput("IsSameOrAfter",new G(G.OUTPUT,v.of(sb.EVENT_RESULT_NAME,I.ofBoolean(sb.EVENT_RESULT_NAME))),(e,t)=>sv(e)>=sv(t)),sb.ofEntryTimestampAndBooleanOutput("IsInLeapYear",e=>sv(e).isInLeapYear),sb.ofEntryTimestampAndBooleanOutput("IsInDST",e=>sv(e).isInDST),["IsBetween",new sF],["LastOf",new sB(!0)],["FirstOf",new sB(!1)],["StartOf",new sk(!0)],["EndOf",new sk(!1)],["TimeAsObject",new sY(!1)],["TimeAsArray",new sY(!0)],["GetNames",new sH],["IsValidISODate",new sj],["FromNow",new sW],["FromDateString",new sX]),this.filterableNames=Array.from(this.repoMap.values()).map(e=>e.getSignature().getFullName())}}class sK extends eN{static{this.MILLIS="millis"}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get(sK.MILLIS);return await new Promise(e=>setTimeout(e,t)),new B([$.outputOf(new Map)])}constructor(...e){super(...e),this.signature=new Y("Wait").setNamespace(A.SYSTEM).setParameters(new Map([U.ofEntry(sK.MILLIS,I.ofNumber(sK.MILLIS).setMinimum(0).setDefaultValue(0))])).setEvents(new Map([G.outputEventMapEntry(new Map)]))}}t({},"HybridRepository",()=>sz);class sz{constructor(...e){this.repos=e}async find(e,t){for(let r of this.repos){let s=await r.find(e,t);if(s)return s}}async filter(e){let t=new Set;for(let r of this.repos)(await r.filter(e)).forEach(e=>t.add(e));return Array.from(t)}}class sQ extends eN{static{this.SOURCE="source"}static{this.SCHEMA="schema"}static{this.IS_VALID="isValid"}getSignature(){return this.signature}internalExecute(e){let t=e.getArguments()?.get(sQ.SOURCE),r=I.from(e?.getArguments()?.get(sQ.SCHEMA));if(!r)throw new F("Schema is not supplied.");return this.validateSchema(r,e.getSchemaRepository(),t)}async validateSchema(e,t,r){try{return await ef.validate([],e,t,r,!0),new B([$.outputOf(v.of(sQ.IS_VALID,!0))])}catch(e){return new B([$.outputOf(v.of(sQ.IS_VALID,!1))])}}constructor(...e){super(...e),this.signature=new Y("ValidateSchema").setNamespace(A.SYSTEM_OBJECT).setParameters(new Map([U.ofEntry(sQ.SOURCE,I.ofAny(sQ.SCHEMA)),U.ofEntry(sQ.SCHEMA,I.SCHEMA,!1,x.CONSTANT)])).setEvents(new Map([G.outputEventMapEntry(v.of(sQ.IS_VALID,I.ofBoolean(sQ.IS_VALID)))]))}}let sZ="value",s0="error",s1="errorMessage",s2="source";class s5 extends eN{constructor(){super(),this.signature=new Y("JSONParse").setNamespace(A.SYSTEM_JSON).setParameters(new Map([U.ofEntry(s2,I.ofString(s2))])).setEvents(new Map([G.eventMapEntry(s0,new Map([[s1,I.ofString(s1)]])),G.outputEventMapEntry(new Map([[sZ,I.ofAny(sZ)]]))]))}getSignature(){return this.signature}async internalExecute(e){let t,r=e.getArguments()?.get("source");try{t=r?JSON.parse(r):null}catch(e){return new B([$.of(s0,new Map([[s1,e?.message??"Unknown Error parsing JSON"]])),$.outputOf(new Map([[sZ,null]]))])}return new B([$.outputOf(new Map([[sZ,t]]))])}}let s7="value",s4="source";class s9 extends eN{constructor(){super(),this.signature=new Y("JSONStringify").setNamespace(A.SYSTEM_JSON).setParameters(new Map([U.ofEntry(s4,I.ofAny(s4))])).setEvents(new Map([G.outputEventMapEntry(new Map([[s7,I.ofString(s7)]]))]))}getSignature(){return this.signature}async internalExecute(e){let t=e.getArguments()?.get("source");return new B([$.outputOf(new Map([[s7,JSON.stringify(t??null)]]))])}}class s6{constructor(){this.map=new Map([[A.SYSTEM_JSON,new Map([D(new s5),D(new s9)])],[A.SYSTEM_CTX,new Map([D(new tg),D(new tm),D(new rw)])],[A.SYSTEM_LOOP,new Map([D(new rX),D(new rD),D(new rb),D(new rY)])],[A.SYSTEM,new Map([D(new rL),D(new rx),D(new sm),D(new sK),D(new tA),D(new sQ)])]]),this.filterableNames=Array.from(this.map.values()).flatMap(e=>Array.from(e.values())).map(e=>e.getSignature().getFullName())}async find(e,t){return this.map.get(e)?.get(t)}async filter(e){return Array.from(this.filterableNames).filter(t=>-1!==t.toLowerCase().indexOf(e.toLowerCase()))}}class s3 extends sz{constructor(){super(new s6,new r8,new sU,new tl,new sp,new sq)}}t({},"StatementExecution",()=>ne),t({},"StatementMessage",()=>s8);class s8{constructor(e,t){this.message=t,this.messageType=e}getMessageType(){return this.messageType}setMessageType(e){return this.messageType=e,this}getMessage(){return this.message}setMessage(e){return this.message=e,this}toString(){return`${this.messageType} : ${this.message}`}}class ne{constructor(e){this.messages=[],this.dependencies=new Set,this.statement=e}getStatement(){return this.statement}setStatement(e){return this.statement=e,this}getMessages(){return this.messages}setMessages(e){return this.messages=e,this}getDependencies(){return this.dependencies}setDependencies(e){return this.dependencies=e,this}getUniqueKey(){return this.statement.getStatementName()}addMessage(e,t){this.messages.push(new s8(e,t))}addDependency(e){this.dependencies.add(e)}getDepenedencies(){return this.dependencies}equals(e){return e instanceof ne&&e.statement.equals(this.statement)}}t({},"ContextTokenValueExtractor",()=>nt);class nt extends e5{static{this.PREFIX="Context."}constructor(e){super(),this.context=e}getValueInternal(e){let t=e5.splitPath(e),r=t[1],s=r.indexOf("["),n=2;return -1!=s&&(r=t[1].substring(0,s),(t=[...t])[1]=t[1].substring(s),n=1),this.retrieveElementFrom(e,t,n,this.context.get(r)?.getElement())}getPrefix(){return nt.PREFIX}getStore(){return l(this.context)?this.context:Array.from(this.context.entries()).reduce((e,[t,r])=>(l(r)||(e[t]=r.getElement()),e),{})}}t({},"OutputMapTokenValueExtractor",()=>nr);class nr extends e5{static{this.PREFIX="Steps."}constructor(e){super(),this.output=e}getValueInternal(e){let t=e5.splitPath(e),r=1,s=this.output.get(t[r++]);if(!s||r>=t.length)return;let n=s.get(t[r++]);if(!n||r>t.length)return;if(r===t.length)return n;let a=t[r].indexOf("[");if(-1===a){let s=n.get(t[r++]);return this.retrieveElementFrom(e,t,r,s)}let i=t[r].substring(0,a),o=n.get(i);return this.retrieveElementFrom(e,t,r,{[i]:o})}getPrefix(){return nr.PREFIX}getStore(){return this.convertMapToObj(this.output)}convertMapToObj(e){return 0===e.size?{}:Array.from(e.entries()).reduce((e,[t,r])=>(e[t]=r instanceof Map?this.convertMapToObj(r):r,e),{})}}t({},"ArgumentsTokenValueExtractor",()=>ns);class ns extends e5{static{this.PREFIX="Arguments."}constructor(e){super(),this.args=e}getValueInternal(e){let t=e5.splitPath(e),r=t[1],s=r.indexOf("["),n=2;return -1!=s&&(r=t[1].substring(0,s),(t=[...t])[1]=t[1].substring(s),n=1),this.retrieveElementFrom(e,t,n,this.args.get(r))}getPrefix(){return ns.PREFIX}getStore(){return l(this.args)?this.args:Array.from(this.args.entries()).reduce((e,[t,r])=>(e[t]=r,e),{})}}t({},"GraphVertex",()=>na),t({},"ExecutionGraph",()=>nn);class nn{constructor(e=!1){this.nodeMap=new Map,this.edgesBuilt=!1,this.isSubGrph=e}areEdgesBuilt(){return this.edgesBuilt}setEdgesBuilt(e){this.edgesBuilt=e}getVerticesData(){return Array.from(this.nodeMap.values()).map(e=>e.getData())}addVertex(e){if(!this.nodeMap.has(e.getUniqueKey())){let t=new na(this,e);this.nodeMap.set(e.getUniqueKey(),t)}return this.nodeMap.get(e.getUniqueKey())}getVertex(e){return this.nodeMap.get(e)}getVertexData(e){if(this.nodeMap.has(e))return this.nodeMap.get(e).getData()}getVerticesWithNoIncomingEdges(){return Array.from(this.nodeMap.values()).filter(e=>!e.hasIncomingEdges())}isCyclic(){let e,t=new H(this.getVerticesWithNoIncomingEdges()),r=new Set;for(;!t.isEmpty();){if(r.has(t.getFirst().getKey()))return!0;e=t.removeFirst(),r.add(e.getKey()),e.hasOutgoingEdges()&&t.addAll(Array.from(e.getOutVertices().values()).flatMap(e=>Array.from(e)))}return!1}addVertices(e){for(let t of e)this.addVertex(t)}getNodeMap(){return this.nodeMap}isSubGraph(){return this.isSubGrph}toString(){return"Execution Graph : \n"+Array.from(this.nodeMap.values()).map(e=>e.toString()).join("\n")}}class na{constructor(e,t){this.outVertices=new Map,this.inVertices=new Set,this.subGraphCache=new Map,this.data=t,this.graph=e}getData(){return this.data}setData(e){return this.data=e,this}getOutVertices(){return this.outVertices}setOutVertices(e){return this.outVertices=e,this}getInVertices(){return this.inVertices}setInVertices(e){return this.inVertices=e,this}getGraph(){return this.graph}setGraph(e){return this.graph=e,this}getKey(){return this.data.getUniqueKey()}addOutEdgeTo(e,t){return this.outVertices.has(e)||this.outVertices.set(e,new Set),this.outVertices.get(e).add(t),t.inVertices.add(new q(this,e)),t}addInEdgeTo(e,t){return this.inVertices.add(new q(e,t)),e.outVertices.has(t)||e.outVertices.set(t,new Set),e.outVertices.get(t).add(this),e}hasIncomingEdges(){return!!this.inVertices.size}hasOutgoingEdges(){return!!this.outVertices.size}getSubGraphOfType(e){let t=this.subGraphCache.get(e);if(t)return t;let r=new nn(!0);var s=new H(Array.from(this.outVertices.get(e)??[]));for(s.map(e=>e.getData()).forEach(e=>r.addVertex(e));!s.isEmpty();)Array.from(s.pop().outVertices.values()).flatMap(e=>Array.from(e)).forEach(e=>{r.addVertex(e.getData()),s.add(e)});return this.subGraphCache.set(e,r),r}toString(){var e=Array.from(this.getInVertices()).map(e=>e.getT1().getKey()+"("+e.getT2()+")").join(", "),t=Array.from(this.outVertices.entries()).map(([e,t])=>e+": "+Array.from(t).map(e=>e.getKey()).join(",")).join("\n		");return this.getKey()+":\n	In: "+e+"\n	Out: \n		"+t}}t({},"KIRuntime",()=>nl),t({},"JsonExpression",()=>ni);class ni{constructor(e){this.expression=e}getExpression(){return this.expression}}t({},"ParameterReferenceType",()=>no);var no=((o={}).VALUE="VALUE",o.EXPRESSION="EXPRESSION",o);function nE(){var e=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)})}t({},"FunctionExecutionParameters",()=>nu);class nu{constructor(e,t,r){this.count=0,this.executionContext=new Map,this.valueExtractors=new Map,this.functionRepository=e,this.schemaRepository=t,this.executionId=r??nE()}getExecutionId(){return this.executionId}getContext(){return this.context}setContext(e){this.context=e;let t=new nt(e);return this.valueExtractors.set(t.getPrefix(),t),this}getArguments(){return this.args}setArguments(e){return this.args=e,this}getEvents(){return this.events}setEvents(e){return this.events=e,this}getStatementExecution(){return this.statementExecution}setStatementExecution(e){return this.statementExecution=e,this}getSteps(){return this.steps}setSteps(e){this.steps=e;let t=new nr(e);return this.valueExtractors.set(t.getPrefix(),t),this}getCount(){return this.count}setCount(e){return this.count=e,this}getValuesMap(){return this.valueExtractors}getFunctionRepository(){return this.functionRepository}setFunctionRepository(e){return this.functionRepository=e,this}getSchemaRepository(){return this.schemaRepository}setSchemaRepository(e){return this.schemaRepository=e,this}addTokenValueExtractor(...e){for(let t of e)this.valueExtractors.set(t.getPrefix(),t);return this}setValuesMap(e){for(let[t,r]of e.entries())this.valueExtractors.set(t,r);return this}setExecutionContext(e){return this.executionContext=e,this}getExecutionContext(){return this.executionContext}}t({},"StatementMessageType",()=>nA);var nA=((E={}).ERROR="ERROR",E.WARNING="WARNING",E.MESSAGE="MESSAGE",E);class nl extends eN{static{this.PARAMETER_NEEDS_A_VALUE='Parameter "$" needs a value'}static{this.STEP_REGEX_PATTERN=RegExp("Steps\\.([a-zA-Z0-9\\\\-]{1,})\\.([a-zA-Z0-9\\\\-]{1,})","g")}static{this.VERSION=1}static{this.MAX_EXECUTION_ITERATIONS=1e7}constructor(e,t=!1){if(super(),this.debugMode=!1,this.functionCache=new Map,this.debugMode=t,this.fd=e,this.fd.getVersion()>nl.VERSION)throw new F("Runtime is at a lower version "+nl.VERSION+" and trying to run code from version "+this.fd.getVersion()+".")}getSignature(){return this.fd}async getCachedFunction(e,t,r){let s=`${t}.${r}`;if(this.functionCache.has(s))return this.functionCache.get(s);let n=await e.find(t,r);return n&&this.functionCache.set(s,n),n}async getExecutionPlan(e,t){let r=new nn,s=Array.from(this.fd.getSteps().values());for(let n of(await Promise.all(s.map(r=>this.prepareStatementExecution(r,e,t)))))r.addVertex(n);return Array.from(this.makeEdges(r).getT2().entries()).forEach(e=>{let t=r.getNodeMap().get(e[0])?.getData();t&&t.addMessage(nA.ERROR,e[1])}),r}async internalExecute(e){e.getContext()||e.setContext(new Map),e.getEvents()||e.setEvents(new Map),e.getSteps()||e.setSteps(new Map),e.getArguments()&&e.addTokenValueExtractor(new ns(e.getArguments())),this.debugMode&&(console.log(`EID: ${e.getExecutionId()} Executing: ${this.fd.getNamespace()}.${this.fd.getName()}`),console.log(`EID: ${e.getExecutionId()} Parameters: `,e));let t=await this.getExecutionPlan(e.getFunctionRepository(),e.getSchemaRepository());this.debugMode&&console.log(`EID: ${e.getExecutionId()} ${t?.toString()}`);let r=t.getVerticesData().filter(e=>e.getMessages().length).map(e=>e.getStatement().getStatementName()+": \n"+e.getMessages().join(","));if(r?.length)throw new F("Please fix the errors in the function definition before execution : \n"+r.join(",\n"));return await this.executeGraph(t,e)}async executeGraph(e,t){let r=new H;r.addAll(e.getVerticesWithNoIncomingEdges());let s=new H;for(;(!r.isEmpty()||!s.isEmpty())&&!t.getEvents()?.has(G.OUTPUT);){let e=r.length,n=s.length;if(await this.processBranchQue(t,r,s),await this.processExecutionQue(t,r,s),(e!==r.length||n!==s.length)&&(t.setCount(t.getCount()+1),t.getCount()==nl.MAX_EXECUTION_ITERATIONS))throw new F("Execution locked in an infinite loop")}if(!e.isSubGraph()&&!t.getEvents()?.size){let e=this.getSignature().getEvents();if(e.size&&e.get(G.OUTPUT)?.getParameters()?.size)throw new F("No events raised")}let n=Array.from(t.getEvents()?.entries()??[]).flatMap(e=>e[1].map(t=>$.of(e[0],t)));return new B(n.length||e.isSubGraph()?n:[$.of(G.OUTPUT,new Map)])}async processExecutionQue(e,t,r){if(t.isEmpty())return;let s=[];for(;!t.isEmpty();)s.push(t.pop());let n=[],a=[];for(let t of s)this.allDependenciesResolvedVertex(t,e.getSteps())?n.push(t):a.push(t);for(let e of a)t.add(e);n.length>0&&await Promise.all(n.map(s=>this.executeVertex(s,e,r,t,e.getFunctionRepository())))}async processBranchQue(e,t,r){if(!r.length)return;let s=[];for(;r.length;)s.push(r.pop());let n=[],a=[];for(let t of s)this.allDependenciesResolvedTuples(t.getT2(),e.getSteps())?n.push(t):a.push(t);for(let e of a)r.add(e);for(let r of n)await this.executeBranch(e,t,r)}async executeBranch(e,t,r){let s,n=r.getT4(),a=r.getT1().getVerticesData().map(e=>e.getStatement().getStatementName());do{let t=e.getSteps();if(t)for(let e of a)t.delete(e);if(await this.executeGraph(r.getT1(),e),(s=r.getT3().next())&&(e.getSteps()?.has(n.getData().getStatement().getStatementName())||e.getSteps()?.set(n.getData().getStatement().getStatementName(),new Map),e.getSteps()?.get(n.getData().getStatement().getStatementName())?.set(s.getName(),this.resolveInternalExpressions(s.getResult(),e)),this.debugMode)){let t=n.getData().getStatement();console.log(`EID: ${e.getExecutionId()} Step : ${t.getStatementName()} => ${t.getNamespace()}.${t.getName()}`),console.log(`EID: ${e.getExecutionId()} Event : ${s.getName()} : `,e.getSteps().get(t.getStatementName()).get(s.getName()))}}while(s&&s.getName()!=G.OUTPUT)if(s?.getName()==G.OUTPUT&&n.getOutVertices().has(G.OUTPUT))for(let r of Array.from(n?.getOutVertices()?.get(G.OUTPUT)??[]))this.allDependenciesResolvedVertex(r,e.getSteps())&&t.add(r)}async executeVertex(e,t,r,s,n){let a,i=e.getData().getStatement();if(i.getExecuteIftrue().size&&!(Array.from(i.getExecuteIftrue().entries())??[]).filter(e=>e[1]).map(([e])=>new rS(e).evaluate(t.getValuesMap())).every(e=>!l(e)&&!1!==e))return;let o=await this.getCachedFunction(n,i.getNamespace(),i.getName());if(!o)throw new F(k.format("$.$ function is not found.",i.getNamespace(),i.getName()));let E=o?.getSignature().getParameters(),u=this.getArgumentsFromParametersMap(t,i,E??new Map);this.debugMode&&(console.log(`EID: ${t.getExecutionId()} Step : ${i.getStatementName()} => ${i.getNamespace()}.${i.getName()}`),console.log(`EID: ${t.getExecutionId()} Arguments : `,u));let A=t.getContext();a=o instanceof nl?new nu(t.getFunctionRepository(),t.getSchemaRepository(),`${t.getExecutionId()}_${i.getStatementName()}`).setArguments(u).setValuesMap(new Map(Array.from(t.getValuesMap().values()).filter(e=>e.getPrefix()!==ns.PREFIX&&e.getPrefix()!==nr.PREFIX&&e.getPrefix()!==nt.PREFIX).map(e=>[e.getPrefix(),e]))):new nu(t.getFunctionRepository(),t.getSchemaRepository(),t.getExecutionId()).setValuesMap(t.getValuesMap()).setContext(A).setArguments(u).setEvents(t.getEvents()).setSteps(t.getSteps()).setStatementExecution(e.getData()).setCount(t.getCount()).setExecutionContext(t.getExecutionContext());let T=await o.execute(a),c=T.next();if(!c)throw new F(k.format("Executing $ returned no events",i.getStatementName()));let h=c.getName()==G.OUTPUT;if(t.getSteps()?.has(i.getStatementName())||t.getSteps().set(i.getStatementName(),new Map),t.getSteps().get(i.getStatementName()).set(c.getName(),this.resolveInternalExpressions(c.getResult(),t)),this.debugMode&&(console.log(`EID: ${t.getExecutionId()} Step : ${i.getStatementName()} => ${i.getNamespace()}.${i.getName()}`),console.log(`EID: ${t.getExecutionId()} Event : ${c.getName()} : `,t.getSteps().get(i.getStatementName()).get(c.getName()))),h){let r=e.getOutVertices().get(G.OUTPUT);if(r)for(let e of Array.from(r))this.allDependenciesResolvedVertex(e,t.getSteps())&&s.add(e)}else{let t=e.getSubGraphOfType(c.getName()),s=[];t.areEdgesBuilt()||(s=this.makeEdges(t).getT1(),t.setEdgesBuilt(!0)),r.push(new z(t,s,T,e))}}resolveInternalExpressions(e,t){if(!e)return e;let r=new Map;for(let[s,n]of e.entries())r.set(s,this.resolveInternalExpression(n,t));return r}resolveInternalExpression(e,t){if(l(e)||"object"!=typeof e)return e;if(e instanceof ni)return new rS(e.getExpression()).evaluate(t.getValuesMap());if(Array.isArray(e)){let r=[];for(let s of e)r.push(this.resolveInternalExpression(s,t));return r}if("object"==typeof e){let r={};for(let s of Object.entries(e))r[s[0]]=this.resolveInternalExpression(s[1],t);return r}}allDependenciesResolvedTuples(e,t){for(let r of e)if(!t.has(r.getT1())||!t.get(r.getT1())?.get(r.getT2()))return!1;return!0}allDependenciesResolvedVertex(e,t){let r=e.getInVertices();if(!r.size)return!0;for(let e of r){let r=e.getT1().getData().getStatement().getStatementName(),s=e.getT2();if(!(t.has(r)&&t.get(r)?.has(s)))return!1}return!0}getArgumentsFromParametersMap(e,t,r){let s=new Map;for(let[n,a]of t.getParameterMap().entries()){let t,i=Array.from(a?.values()??[]);if(!i?.length)continue;let o=r.get(n);o&&(t=o.isVariableArgument()?i.sort((e,t)=>(e.getOrder()??0)-(t.getOrder()??0)).filter(e=>!l(e)).map(t=>this.parameterReferenceEvaluation(e,t)).flatMap(e=>Array.isArray(e)?e:[e]):this.parameterReferenceEvaluation(e,i[0]),l(t)||s.set(n,t))}return s}parameterReferenceEvaluation(e,t){let r;return t.getType()==no.VALUE?r=this.resolveInternalExpression(t.getValue(),e):t.getType()!=no.EXPRESSION||X.isNullOrBlank(t.getExpression())||(r=new rS(t.getExpression()??"").evaluate(e.getValuesMap())),r}async prepareStatementExecution(e,t,r){let s=new ne(e),n=await this.getCachedFunction(t,e.getNamespace(),e.getName());if(!n)return s.addMessage(nA.ERROR,k.format("$.$ is not available",e.getNamespace(),e.getName())),Promise.resolve(s);let a=new Map(n.getSignature().getParameters());if(!e.getParameterMap())return Promise.resolve(s);for(let t of Array.from(e.getParameterMap().entries())){let e=a.get(t[0]);if(!e)continue;let n=Array.from(t[1]?.values()??[]);if(!n.length&&!e.isVariableArgument()){await Z.hasDefaultValueOrNullSchemaType(e.getSchema(),r)||s.addMessage(nA.ERROR,k.format(nl.PARAMETER_NEEDS_A_VALUE,e.getParameterName())),a.delete(e.getParameterName());continue}if(e.isVariableArgument())for(let t of(n.sort((e,t)=>(e.getOrder()??0)-(t.getOrder()??0)),n))this.parameterReferenceValidation(s,e,t,r);else if(n.length){let t=n[0];this.parameterReferenceValidation(s,e,t,r)}a.delete(e.getParameterName())}if(!l(s.getStatement().getDependentStatements()))for(let e of Array.from(s.getStatement().getDependentStatements().entries()))e[1]&&s.addDependency(e[0]);if(!l(s.getStatement().getExecuteIftrue()))for(let e of Array.from(s.getStatement().getExecuteIftrue().entries()))e[1]&&this.addDependencies(s,e[0]);if(a.size)for(let e of Array.from(a.values()))!e.isVariableArgument()&&(await Z.hasDefaultValueOrNullSchemaType(e.getSchema(),r)||s.addMessage(nA.ERROR,k.format(nl.PARAMETER_NEEDS_A_VALUE,e.getParameterName())));return Promise.resolve(s)}async parameterReferenceValidation(e,t,r,s){if(r){if(r.getType()==no.VALUE){if(l(r.getValue())&&!await Z.hasDefaultValueOrNullSchemaType(t.getSchema(),s)&&e.addMessage(nA.ERROR,k.format(nl.PARAMETER_NEEDS_A_VALUE,t.getParameterName())),l(r.getValue()))return;let n=new H;for(n.push(new q(t.getSchema(),r.getValue()));!n.isEmpty();){let t=n.pop();if(t.getT2()instanceof ni)this.addDependencies(e,t.getT2().getExpression());else{if(l(t.getT1())||l(t.getT1().getType()))continue;if(t.getT1().getType()?.contains(c.ARRAY)&&Array.isArray(t.getT2())){let e=t.getT1().getItems();if(!e)continue;if(e.isSingleType())for(let r of t.getT2())n.push(new q(e.getSingleSchema(),r));else{let r=t.getT2();for(let t=0;t<r.length;t++)n.push(new q(e.getTupleSchema()[t],r[t]))}}else if(t.getT1().getType()?.contains(c.OBJECT)&&"object"==typeof t.getT2()){let r=t.getT1();if(r.getName()===U.EXPRESSION.getName()&&r.getNamespace()===U.EXPRESSION.getNamespace()){let r=t.getT2();r.isExpression&&this.addDependencies(e,r.value)}else if(r.getProperties())for(let e of Object.entries(t.getT2()))r.getProperties().has(e[0])&&n.push(new q(r.getProperties().get(e[0]),e[1]))}}}}else if(r.getType()==no.EXPRESSION)if(X.isNullOrBlank(r.getExpression()))l(Z.getDefaultValue(t.getSchema(),s))&&e.addMessage(nA.ERROR,k.format(nl.PARAMETER_NEEDS_A_VALUE,t.getParameterName()));else try{this.addDependencies(e,r.getExpression())}catch(t){e.addMessage(nA.ERROR,k.format("Error evaluating $ : $",r.getExpression(),t))}}else l(await Z.getDefaultValue(t.getSchema(),s))&&e.addMessage(nA.ERROR,k.format(nl.PARAMETER_NEEDS_A_VALUE,t.getParameterName()))}addDependencies(e,t){t&&Array.from(t.match(nl.STEP_REGEX_PATTERN)??[]).forEach(t=>e.addDependency(t))}makeEdges(e){let t=e.getNodeMap().values(),r=[],s=new Map;for(let n of Array.from(t))for(let t of Array.from(n.getData().getDependencies())){let a=t.indexOf(".",6),i=t.substring(6,a),o=t.indexOf(".",a+1),E=-1==o?t.substring(a+1):t.substring(a+1,o);e.getNodeMap().has(i)?n.addInEdgeTo(e.getNodeMap().get(i),E):(r.push(new q(i,E)),s.set(n.getData().getStatement().getStatementName(),k.format("Unable to find the step with name $",i)))}return new q(r,s)}}t({},"KIRunConstants",()=>nT);class nT{static{this.NAMESPACE="namespace"}static{this.NAME="name"}static{this.ID="id"}constructor(){}}t({},"Position",()=>nc);class nc{static{this.SCHEMA_NAME="Position"}static{this.SCHEMA=new I().setNamespace(A.SYSTEM).setName(nc.SCHEMA_NAME).setType(p.of(c.OBJECT)).setProperties(new Map([["left",I.ofFloat("left")],["top",I.ofFloat("top")]]))}constructor(e,t){this.left=e,this.top=t}getLeft(){return this.left}setLeft(e){return this.left=e,this}getTop(){return this.top}setTop(e){return this.top=e,this}static from(e){if(e)return new nc(e.left,e.top)}}t({},"FunctionDefinition",()=>nf),t({},"Statement",()=>nR),t({},"AbstractStatement",()=>nh);class nh{constructor(e){if(this.override=!1,!e)return;this.comment=e.comment,this.description=e.description,this.position=e.position?new nc(e.position.getLeft(),e.position.getTop()):void 0,this.override=e.override}getComment(){return this.comment}setComment(e){return this.comment=e,this}isOverride(){return this.override}setOverride(e){return this.override=e,this}getDescription(){return this.description}setDescription(e){return this.description=e,this}getPosition(){return this.position}setPosition(e){return this.position=e,this}}t({},"ParameterReference",()=>ng);class ng{static{this.SCHEMA_NAME="ParameterReference"}static{this.SCHEMA=new I().setNamespace(A.SYSTEM).setName(ng.SCHEMA_NAME).setType(p.of(c.OBJECT)).setProperties(new Map([["key",I.ofString("key")],["value",I.ofAny("value")],["expression",I.ofString("expression")],["type",I.ofString("type").setEnums(["EXPRESSION","VALUE"])],["order",I.ofInteger("order")]]))}constructor(e){e instanceof ng?(this.key=e.key,this.type=e.type,this.value=l(e.value)?void 0:JSON.parse(JSON.stringify(e.value)),this.expression=e.expression,this.order=e.order):(this.type=e,this.key=nE())}getType(){return this.type}setType(e){return this.type=e,this}getKey(){return this.key}setKey(e){return this.key=e,this}getValue(){return this.value}setValue(e){return this.value=e,this}getExpression(){return this.expression}setExpression(e){return this.expression=e,this}setOrder(e){return this.order=e,this}getOrder(){return this.order}static ofExpression(e){let t=new ng(no.EXPRESSION).setExpression(e);return[t.getKey(),t]}static ofValue(e){let t=new ng(no.VALUE).setValue(e);return[t.getKey(),t]}static from(e){return new ng(e.type).setValue(e.value).setExpression(e.expression).setKey(e.key).setOrder(e.order)}}class nR extends nh{static{this.SCHEMA_NAME="Statement"}static{this.SCHEMA=new I().setNamespace(A.SYSTEM).setName(nR.SCHEMA_NAME).setType(p.of(c.OBJECT)).setProperties(new Map([["statementName",I.ofString("statementName")],["comment",I.ofString("comment")],["description",I.ofString("description")],["namespace",I.ofString("namespace")],["name",I.ofString("name")],["dependentStatements",I.ofObject("dependentstatement").setAdditionalProperties(new w().setSchemaValue(I.ofBoolean("exists"))).setDefaultValue({})],["executeIftrue",I.ofObject("executeIftrue").setAdditionalProperties(new w().setSchemaValue(I.ofBoolean("exists"))).setDefaultValue({})],["parameterMap",new I().setName("parameterMap").setAdditionalProperties(new w().setSchemaValue(I.ofObject("parameterReference").setAdditionalProperties(new w().setSchemaValue(ng.SCHEMA))))],["position",nc.SCHEMA]]))}constructor(e,t,r){if(super(e instanceof nR?e:void 0),e instanceof nR)this.statementName=e.statementName,this.name=e.name,this.namespace=e.namespace,e.parameterMap&&(this.parameterMap=new Map(Array.from(e.parameterMap.entries()).map(e=>[e[0],new Map(Array.from(e[1].entries()).map(e=>[e[0],new ng(e[1])]))]))),e.dependentStatements&&(this.dependentStatements=new Map(Array.from(e.dependentStatements.entries())));else{if(this.statementName=e,!r||!t)throw Error("Unknown constructor");this.namespace=t,this.name=r}}getStatementName(){return this.statementName}setStatementName(e){return this.statementName=e,this}getNamespace(){return this.namespace}setNamespace(e){return this.namespace=e,this}getName(){return this.name}setName(e){return this.name=e,this}getParameterMap(){return this.parameterMap||(this.parameterMap=new Map),this.parameterMap}setParameterMap(e){return this.parameterMap=e,this}getDependentStatements(){return this.dependentStatements??new Map}setDependentStatements(e){return this.dependentStatements=e,this}getExecuteIftrue(){return this.executeIftrue??new Map}setExecuteIftrue(e){return this.executeIftrue=e,this}equals(e){return e instanceof nR&&e.statementName==this.statementName}static ofEntry(e){return[e.statementName,e]}static from(e){return new nR(e.statementName,e.namespace,e.name).setParameterMap(new Map(Object.entries(e.parameterMap??{}).map(([e,t])=>[e,new Map(Object.entries(t??{}).map(([e,t])=>ng.from(t)).map(e=>[e.getKey(),e]))]))).setDependentStatements(new Map(Object.entries(e.dependentStatements??{}))).setExecuteIftrue(new Map(Object.entries(e.executeIftrue??{}))).setPosition(nc.from(e.position)).setComment(e.comment).setDescription(e.description)}}t({},"StatementGroup",()=>np);class np extends nh{static{this.SCHEMA_NAME="StatementGroup"}static{this.SCHEMA=new I().setNamespace(A.SYSTEM).setName(np.SCHEMA_NAME).setType(p.of(c.OBJECT)).setProperties(new Map([["statementGroupName",I.ofString("statementGroupName")],["comment",I.ofString("comment")],["description",I.ofString("description")],["position",nc.SCHEMA]]))}constructor(e,t=new Map){super(),this.statementGroupName=e,this.statements=t}getStatementGroupName(){return this.statementGroupName}setStatementGroupName(e){return this.statementGroupName=e,this}getStatements(){return this.statements}setStatements(e){return this.statements=e,this}static from(e){return new np(e.statementGroupName,new Map(Object.entries(e.statements||{}).map(([e,t])=>[e,(""+t)?.toLowerCase()=="true"]))).setPosition(nc.from(e.position)).setComment(e.comment).setDescription(e.description)}}let nm=new I().setNamespace(A.SYSTEM).setName("FunctionDefinition").setProperties(new Map([["name",I.ofString("name")],["namespace",I.ofString("namespace")],["parameters",I.ofArray("parameters",U.SCHEMA)],["events",I.ofObject("events").setAdditionalProperties(new w().setSchemaValue(G.SCHEMA))],["steps",I.ofObject("steps").setAdditionalProperties(new w().setSchemaValue(nR.SCHEMA))]]));nm.getProperties()?.set("parts",I.ofArray("parts",nm));class nf extends Y{static{this.SCHEMA=nm}constructor(e){super(e),this.version=1}getVersion(){return this.version}setVersion(e){return this.version=e,this}getSteps(){return this.steps??new Map}setSteps(e){return this.steps=e,this}getStepGroups(){return this.stepGroups}setStepGroups(e){return this.stepGroups=e,this}getParts(){return this.parts}setParts(e){return this.parts=e,this}static from(e){return e?new nf(e.name).setSteps(new Map(Object.values(e.steps??{}).filter(e=>!!e).map(e=>[e.statementName,nR.from(e)]))).setStepGroups(new Map(Object.values(e.stepGroups??{}).filter(e=>!!e).map(e=>[e.statementGroupName,np.from(e)]))).setParts(Array.from(e.parts??[]).filter(e=>!!e).map(e=>nf.from(e))).setVersion(e.version??1).setEvents(new Map(Object.values(e.events??{}).filter(e=>!!e).map(e=>[e.name,G.from(e)]))).setParameters(new Map(Object.values(e.parameters??{}).filter(e=>!!e).map(e=>[e.parameterName,U.from(e)]))).setNamespace(e.namespace):new nf("unknown")}}t({},"Argument",()=>nN);class nN{constructor(e,t,r){this.argumentIndex=0,this.argumentIndex=e,this.name=t,this.value=r}getArgumentIndex(){return this.argumentIndex}setArgumentIndex(e){return this.argumentIndex=e,this}getName(){return this.name}setName(e){return this.name=e,this}getValue(){return this.value}setValue(e){return this.value=e,this}static of(e,t){return new nN(0,e,t)}}export{C as KIRunSchemaRepository,s3 as KIRunFunctionRepository,eP as PrimitiveUtil,v as MapUtil,V as MapEntry,l as isNullValue,H as LinkedList,ez as StringBuilder,k as StringFormatter,X as StringUtil,q as Tuple2,K as Tuple3,z as Tuple4,ey as ArrayUtil,W as deepEqual,eL as duplicate,ne as StatementExecution,s8 as StatementMessage,tT as ContextElement,nt as ContextTokenValueExtractor,nr as OutputMapTokenValueExtractor,ns as ArgumentsTokenValueExtractor,na as GraphVertex,nn as ExecutionGraph,nl as KIRuntime,nA as StatementMessageType,nu as FunctionExecutionParameters,e2 as Expression,e5 as TokenValueExtractor,rm as LiteralTokenValueExtractor,e7 as ObjectValueSetterExtractor,rS as ExpressionEvaluator,e1 as Operation,eZ as ExpressionToken,eQ as ExpressionEvaluationException,e0 as ExpressionTokenValue,eN as AbstractFunction,A as Namespaces,ni as JsonExpression,w as AdditionalType,I as Schema,P as SchemaDetails,en as NumberValidator,er as BooleanValidator,es as NullValidator,et as ArrayValidator,ee as AnyOfAllOfOneOfValidator,eo as StringValidator,ea as ObjectValidator,ef as SchemaValidator,Q as SchemaValidationException,y as SchemaReferenceException,em as TypeValidator,T as ArraySchemaType,R as SingleType,p as TypeUtil,g as MultipleType,h as Type,c as SchemaType,Z as SchemaUtil,ei as StringFormat,sz as HybridRepository,nT as KIRunConstants,U as Parameter,B as FunctionOutput,nc as Position,nf as FunctionDefinition,no as ParameterReferenceType,$ as EventResult,nh as AbstractStatement,nR as Statement,np as StatementGroup,Y as FunctionSignature,G as Event,x as ParameterType,nN as Argument,ng as ParameterReference,ew as ExecutionException,F as KIRuntimeException,rA as ArithmeticUnaryMinusOperator,rT as ArithmeticUnaryPlusOperator,rh as BitwiseComplementOperator,rR as LogicalNotOperator,ru as UnaryOperator,tS as ArithmeticAdditionOperator,td as ArithmeticDivisionOperator,tP as ArithmeticIntegerDivisionOperator,ty as ArithmeticModulusOperator,tL as ArithmeticMultiplicationOperator,tb as ArithmeticSubtractionOperator,tV as ArrayOperator,tM as BinaryOperator,tD as BitwiseAndOperator,t$ as BitwiseLeftShiftOperator,tB as BitwiseOrOperator,tk as BitwiseRightShiftOperator,tj as BitwiseUnsignedRightShiftOperator,tX as BitwiseXorOperator,tq as LogicalAndOperator,tz as LogicalEqualOperator,tZ as LogicalGreaterThanEqualOperator,t1 as LogicalGreaterThanOperator,t5 as LogicalLessThanEqualOperator,t4 as LogicalNotEqualOperator,t6 as LogicalLessThanOperator,t8 as LogicalOrOperator,rt as ObjectOperator,rs as LogicalNullishCoalescingOperator,ra as ArrayRangeOperator,r_ as ConditionalTernaryOperator};
//# sourceMappingURL=module.js.map
